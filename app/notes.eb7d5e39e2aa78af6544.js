!function(e){function t(t){for(var a,s,o=t[0],c=t[1],l=t[2],d=0,f=[];d<o.length;d++)s=o[d],r[s]&&f.push(r[s][0]),r[s]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);for(u&&u(t);f.length;)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={2:0},i=[];function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise(function(t,a){n=r[e]=[t,a]});t.push(n[2]=a);var i,o=document.createElement("script");o.charset="utf-8",o.timeout=120,s.nc&&o.setAttribute("nonce",s.nc),o.src=function(e){return s.p+""+({1:"@atlaskit-internal_media-viewer-pdf-viewer"}[e]||e)+"/notes."+{1:"a1cd0033cb516495d012"}[e]+".js"}(e);var c=new Error;i=function(t){o.onerror=o.onload=null,clearTimeout(l);var n=r[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,n[1](c)}r[e]=void 0}};var l=setTimeout(function(){i({type:"timeout",target:o})},12e4);o.onerror=o.onload=i,document.head.appendChild(o)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([1,0]),n()}({"/KVF":function(e,t,n){var a={"./en":"7dT6","./en.json":"7dT6","./fr":"9pOX","./fr.json":"9pOX"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="/KVF"},"/RjM":function(e,t,n){"use strict";n.d(t,"b",function(){return m}),n.d(t,"c",function(){return v}),n.d(t,"a",function(){return b});var a=n("o0o1"),r=n.n(a),i=n("yXPU"),s=n.n(i),o=n("q1tI"),c=n("kdbL"),l=n.n(c),u=n("D1y2"),d=n.n(u),f=n("mwIZ"),p=n.n(f),h=n("O1Kf");function m(e,t){var n=Object(c.useFlag)("debug.".concat(e));Object(o.useEffect)(function(){n&&b(e,t)},[n,e,t])}function v(){return Object(c.useFlag)("switcher"),c.FlagSwitcher}function b(e,t){d()(window,"cozy.debug.".concat(e),t)}d()(window,"cozy.debug.showSwitcher",function(){return l()("switcher",!0)}),d()(window,"cozy.debug.notes.debugCollab",function(){var e=s()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l()("debug.client",!0),l()("debug.notes.service",!0),l()("debug.notes.collabProvider",!0),l()("debug.notes.channel",!0),l()("debug.notes.noteId",!0),l()("debug.notes.doc",!0),l()("debug.notes.file",!0),l()("debug.notes.returnUrl",!0),l()("debug.notes.dirtyRef",!0),l()("debug.notes.lastPatchError",!0),e.next=12,new Promise(function(e){window.setTimeout(s()(r.a.mark(function t(){var n,a,i,o,c,l,u,d,f,m,v,b,g,y,_,w,x,j,k,E,O,C,S,N,z,M;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=p()(window,"cozy.debug.notes.collabProvider"),a=p()(window,"cozy.debug.notes.channel"),(i={date:(new Date).toISOString()}).noteId=p()(window,"cozy.debug.notes.noteId"),i.initialVersion=p()(window,"cozy.debug.notes.initialVersion"),i.returnUrl=p()(window,"cozy.debug.notes.returnUrl"),o=n&&n.getState(),c=n&&o&&Object(h.getVersion)(o),l=o&&Object(h.sendableSteps)(o)||{steps:[]},u=l.steps,i.state={version:c,steps:u,length:u&&u.length},d=a&&a.backoff,f=a&&a.failures,m=a&&a.isDirty(),v=a&&a.isSending,b=a&&a.hasQueuedSteps(),g=a&&a.queuedStep,y=g&&g.state,_=y&&Object(h.getVersion)(y),w=g&&g.localSteps&&g.localSteps.steps,i.queue={backoff:d,failures:f,isDirty:m,isSending:v,hasQueue:b,version:_,steps:w,length:w&&w.length},x=n.isDirty(),j=n.getLastRemoteSync(),k=n.getLastLocalSave(),i.collabState={dirtySince:x,lastRemoteSync:j,lastLocalSave:k},E=n&&n.serviceClient,O=E&&E.realtime,C=O&&O.websocket,S=O&&O.retryManager,i.realtime={hasRealtime:!!O,started:O&&O.isStarted,hasWebsocket:O&&O.hasWebSocket(),isOpen:O&&O.isWebSocketOpen(),readyState:C&&C.readyState,bufferedAmount:C&&C.bufferedAmount,url:C&&C.url,retries:S&&S.retries,wait:S&&S.wait},N=p()(window,"cozy.debug.client"),i.client={token:N.stackClient.token,credentials:N.stackClient.getCredentials(),authorization:N.stackClient.getAuthorizationHeader(),uri:N.uri},(z=p()(window,"cozy.debug.notes.lastPatchError"))||!m){t.next=43;break}case 33:if(!a.isSending){t.next=38;break}return t.next=36,new Promise(function(e){return window.setTimeout(e,50)});case 36:t.next=33;break;case 38:return a.resetBackoff(),a.processQueue(),t.next=42,Promise.race([new Promise(function(e){return window.setTimeout(e,2e3)}),new Promise(function(e){(function(){var t=s()(r.a.mark(function t(){var n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=p()(window,"cozy.debug.notes.lastPatchError");case 1:if(n){t.next=7;break}return t.next=4,new Promise(function(e){return window.setTimeout(e,50)});case 4:n=p()(window,"cozy.debug.notes.lastPatchError"),t.next=1;break;case 7:z=n,e();case 9:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}})()()})]);case 42:a.isDirty()&&(a.backoff=d,a.failures=f);case 43:M=z&&z.message;try{M=JSON.parse(z.message)}catch(D){}i.lastPatchError={name:z&&z.name,status:z&&z.status,message:M},e(i);case 47:case"end":return t.stop()}},t,this)})),250)});case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}())},0:function(e,t){},1:function(e,t,n){n("201c"),n("7NIr"),e.exports=n("LiWt")},2:function(e,t){},3:function(e,t){},"7dT6":function(e){e.exports=JSON.parse('{"Notes":{"Add":{"add_note":"Add a note"},"Delete":{"delete_note":"Delete","deleted":"The note has been moved to the trash of your Drive","failed":"The note could not be deleted, please try again"},"EditorView":{"main_placeholder":"Write anythingâ€¦"},"Editor":{"title_placeholder":"Here is your title","exit_confirmation_message":"Automatic saving has not taken into account the latest changes in your doc. Please stay on your current note if you want to keep them.","exit_confirmation_title":"Abandon your changes?","exit_confirmation_leave":"Leave without saving","exit_confirmation_cancel":"Cancel","read_only":"This note is in read-only mode."},"List":{"latest_notes":"Latest Notes","name":"Name","updated_at":"Updated at","location":"Location","sharings":"Sharings","at":"%{date} at %{time}"},"Empty":{"welcome":"Welcome on Cozy Notes","after_created":"Once your Note is created, you can find it in your "},"SavingIndicator":{"saved":{"default":"Up to date","just_now":"Up to date","secs_ago":"Up to date (saved %{time} sec. ago)","min_ago":"Up to date (saved %{time} min. ago)","mins_ago":"Up to date (saved %{time} min. ago)","hour_ago":"Up to date (saved %{time} hour ago)","hours_ago":"Up to date (saved %{time} hours ago)","day_ago":"Up to date (saved %{time} day ago)","days_ago":"Up to date (saved %{time} days ago)","month_ago":"Up to date (saved %{time} month ago)","monthes_ago":"Up to date (saved %{time} monthes ago)","year_ago":"Up to date (saved %{time} year ago)","years_ago":"Up to date (saved %{time} years ago)"},"saving":"Saving...","still_saving":"Saving......","out_of_sync":{"default":"Saved (off-line)","just_now":"Saved (off-line)","secs_ago":"Saved (off-line for %{time} sec)","min_ago":"Saved (off-line for %{time} min)","mins_ago":"Saved (off-line for %{time} min)","hour_ago":"Saved (off-line for %{time} hour)","hours_ago":"Saved (off-line for %{time} hours)","day_ago":"Saved (off-line for %{time} day)","days_ago":"Saved (off-line for %{time} days)","month_ago":"Saved (off-line for %{time} month)","monthes_ago":"Saved (off-line for %{time} monthes)","year_ago":"Saved (off-line for %{time} year)","years_ago":"Saved (off-line for %{time} years)"},"saving_impossible":{"default":"Changes unsaved (off-line)","just_now":"Changes unsaved (off-line)","secs_ago":"Changes unsaved (off-line for %{time} sec)","min_ago":"Changes unsaved (off-line for %{time} min)","mins_ago":"Changes unsaved (off-line for %{time} min)","hour_ago":"Changes unsaved (off-line for %{time} hour)","hours_ago":"Changes unsaved (off-line for %{time} hours)","day_ago":"Changes unsaved (off-line for %{time} day)","days_ago":"Changes unsaved (off-line for %{time} days)","month_ago":"Changes unsaved (off-line for %{time} month)","monthes_ago":"Changes unsaved (off-line for %{time} monthes)","year_ago":"Changes unsaved (off-line for %{time} year)","years_ago":"Changes unsaved (off-line for %{time} years)"}},"OfflineIndicator":{"message":"You\'re not connected to internet anymore. Your changes will be saved once you will be connected again."}},"Error":{"unshared_title":"This share is no longer active","unshared_text":"The owner may have revoked this sharing. You can no longer edit a note at this address.","loading_error_title":"The note couldn\'t be loaded","loading_error_text_noReturnUrl":"The note may not exists anymore, or our servers may have a temporary glitch. Please try again later.","loading_error_text_returnUrl":"The note may not exists anymore, or our servers may have a temporary glitch. Please go <a href=\'%{url}\'>back</a> and try again later."},"manifest":{"short_description":"Cozy Notes is your personal and collaborative note-taking application.","long_description":"Notes is an online text editor that can already offer you to:\\n\\n* Create your own notes with the essential features (bold, underlined, links, tables...)\\n* Fill and find your notes with you other documents in files of your personal Drive\\n* Edit easily your notes from all your devices\\n* Access your notes offline\\n* For the fans, use shortcuts and input in markdown format ... and even write with contacts together on the same note (coming soon)!","screenshots":["screenshots/en/screenshot01.png","screenshots/en/screenshot02.png"]}}')},"84gJ":function(e,t,n){e.exports={"saving-indicator":"saving-indicator--rzoXB"}},"9pOX":function(e){e.exports=JSON.parse('{"Notes":{"Add":{"add_note":"Ajouter une note"},"Delete":{"delete_note":"Supprimer","deleted":"La note a Ã©tÃ© placÃ©e dans la corbeille de votre Drive","failed":"La note n\'a pas pu Ãªtre supprimÃ©e, merci de re-essayer plus tard"},"EditorView":{"main_placeholder":"Ã‰crivez ce que vous souhaitezâ€¦"},"Editor":{"title_placeholder":"Ici votre titre","exit_confirmation_message":"La sauvegarde automatique n\'a pas encore pris en compte vos derniÃ¨res modifications. Merci de retourner sur votre note pour ne pas les perdre.","exit_confirmation_title":"Abandonner les modificationsÂ ?","exit_confirmation_leave":"Quitter sans sauvegarder","exit_confirmation_cancel":"Retour","read_only":"Cette note est en mode lecture-seule."},"List":{"latest_notes":"Notes rÃ©centes","name":"Nom","updated_at":"Mise Ã  jour","location":"Emplacement","sharings":"Partage","at":"%{date} Ã  %{time}"},"Empty":{"welcome":"Bienvenue sur Cozy Notes","after_created":"Une fois votre note crÃ©Ã©e, il vous est possible de la retrouver dans "},"SavingIndicator":{"saved":{"default":"Ã€ jour","just_now":"Ã€ jour","secs_ago":"Ã€ jour (enregistrÃ© il y a %{time} sec.)","min_ago":"Ã€ jour (enregistrÃ© il y a %{time} min.)","mins_ago":"Ã€ jour (enregistrÃ© il y a %{time} min.)","hour_ago":"Ã€ jour (enregistrÃ© il y a %{time} heure)","hours_ago":"Ã€ jour (enregistrÃ© il y a %{time} heures)","day_ago":"Ã€ jour (enregistrÃ© il y a %{time} jour)","days_ago":"Ã€ jour (enregistrÃ© il y a %{time} jours)","month_ago":"Ã€ jour (enregistrÃ© il y a %{time} mois)","monthes_ago":"Ã€ jour (enregistrÃ© il y a %{time} mois)","year_ago":"Ã€ jour (enregistrÃ© il y a %{time} an)","years_ago":"Ã€ jour (enregistrÃ© il y a %{time} ans)"},"saving":"Enregistrement en cours...","still_saving":"Enregistrement en cours......","out_of_sync":{"default":"EnregistrÃ© (hors ligne)","just_now":"EnregistrÃ© (hors ligne)","secs_ago":"EnregistrÃ© (hors ligne depuis %{time} sec)","min_ago":"EnregistrÃ© (hors ligne depuis %{time} min)","mins_ago":"EnregistrÃ© (hors ligne depuis %{time} min)","hour_ago":"EnregistrÃ© (hors ligne depuis %{time}Â h)","hours_ago":"EnregistrÃ© (hors ligne depuis %{time}Â h)","day_ago":"EnregistrÃ© (hors ligne depuis %{time} jour)","days_ago":"EnregistrÃ© (hors ligne depuis %{time} jours)","month_ago":"EnregistrÃ© (hors ligne depuis %{time} mois)","monthes_ago":"EnregistrÃ© (hors ligne depuis %{time} mois)","year_ago":"EnregistrÃ© (hors ligne depuis %{time} an)","years_ago":"EnregistrÃ© (hors ligne depuis %{time} ans)"},"saving_impossible":{"default":"Non enregistrÃ© (hors ligne)","just_now":"Non enregistrÃ© (hors ligne)","secs_ago":"Non enregistrÃ© (hors ligne depuis %{time} sec)","min_ago":"Non enregistrÃ© (hors ligne depuis %{time} min)","mins_ago":"Non enregistrÃ© (hors ligne depuis %{time} min)","hour_ago":"Non enregistrÃ© (hors ligne depuis %{time}Â h)","hours_ago":"Non enregistrÃ© (hors ligne depuis %{time}Â h)","day_ago":"Non enregistrÃ© (hors ligne depuis %{time} jour)","days_ago":"Non enregistrÃ© (hors ligne depuis %{time} jours)","month_ago":"Non enregistrÃ© (hors ligne depuis %{time} mois)","monthes_ago":"Non enregistrÃ© (hors ligne depuis %{time} mois)","year_ago":"Non enregistrÃ© (hors ligne depuis %{time} an)","years_ago":"Non enregistrÃ© (hors ligne depuis %{time} ans)"}},"OfflineIndicator":{"message":"Vous nâ€™Ãªtes plus connectÃ© Ã  internet. Vos modifications seront enregistrÃ©es quand vous serez connectÃ© Ã  nouveau."}},"Error":{"unshared_title":"Le partage n\'est plus actif","unshared_text":"Le propriÃ©taire a peut-Ãªtre rÃ©voquÃ© ce partage. Vous ne pouvez plus Ã©diter de note Ã  cette adresse.","loading_error_title":"La note n\'a pas pu Ãªtre chargÃ©e","loading_error_text_noReturnUrl":"Cette note n\'existe peut-Ãªtre plus, ou nos serveurs ont peut-Ãªtre un moment d\'Ã©garrement. Merci de retenter plus tard.","loading_error_text_returnUrl":"Cette note n\'existe peut-Ãªtre plus, ou nos serveurs ont peut-Ãªtre un moment d\'Ã©garrement. Merci revenir <a href=\'%{url}\'>en arriÃ¨re</a> et de retenter plus tard."},"manifest":{"short_description":"Cozy Notes est votre application de prise de notes personnelles et collaboratives.","long_description":"Notes est un Ã©diteur de texte en ligne destinÃ© Ã  :\\n\\n* CrÃ©er vos propres notes avec les fonctionnalitÃ©s essentielles (gras, soulignÃ©, liens, tableaux...)\\n* Classer et retrouver vos notes avec vos autres documents, dans les rÃ©pertoires de votre Drive personnel\\n* Ã‰diter facilement vos notes depuis tous vos appareils\\n* AccÃ©der Ã  vos notes, mÃªme sans internet, stockÃ©es sur votre PC\\n* Pour les aficionados, utiliser les raccourcis et la saisie au format markdown\\n*  ... et mÃªme Ã©crire Ã  plusieurs simultanÃ©ment sur la mÃªme note (Ã  venir) ! ","screenshots":["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png"]}}')},G2JP:function(e,t,n){"use strict";var a=n("q1tI"),r=n.n(a).a.createContext(!1);t.a=r},LiWt:function(e,t,n){"use strict";n.r(t),n.d(t,"initApp",function(){return y});var a=n("xIbs"),r=(n("llna"),n("/8/d"),n("3FT0"),n("VxdY"),n("q1tI")),i=n.n(r),s=n("i8i4"),o=n.n(s),c=n("JRPe"),l=n("SH7X"),u=n.n(l),d=n("oBqo"),f=n("buk/"),p=n("Le8U"),h=n("UmWK"),m=n("G2JP"),v=n("X3v2"),b=n("pZg0"),g={en:{react:n("PTt1"),atlaskit:n("eFxx").default},fr:{react:n("Z6Ro"),atlaskit:n("XCed").default}},y=function(){var e=Object(v.b)(),t=Object(v.a)(e.cozyIconPath,n("ZAKO")),r=Object(v.a)(e.cozyAppNamePrefix||b.name_prefix,""),y=Object(v.a)(e.cozyAppName,b.name),_=Object(v.a)(e.cozyAppSlug,b.slug),w=Object(v.a)(e.cozyAppVersion,b.version);Object(c.d)(g.en.react),Object(c.d)(g.fr.react);var x=Object(v.a)(e.cozyLocale,"en"),j=["en","fr"].includes(x)?x:"en",k=window.location?window.location.protocol:"https:",E=Object(v.c)(),O=E||e.cozyToken,C=E||!O||""==O,S=new u.a({uri:"".concat(k,"//").concat(e.cozyDomain),token:O,appMetadata:{slug:_,version:w}});p.Document.cozyClient||p.Document.registerClient(S),S.registerPlugin(d.RealtimePlugin),C||(window.React=i.a,window.ReactDOM=o.a,cozy.bar.init({appName:y,appNamePrefix:r,iconPath:t,lang:j,replaceTitleOnMobile:!0,cozyClient:S,isPublic:C})),function(e,t,r){var o=n("pL5B").default;Object(s.render)(i.a.createElement(f.b,{lang:e,dictRequire:function(e){return n("/KVF")("./".concat(e))}},i.a.createElement(c.c,{locale:e,messages:g[e].atlaskit},i.a.createElement(l.CozyProvider,{client:t},i.a.createElement(a.a,null,i.a.createElement(m.a.Provider,{value:r},!r&&i.a.createElement(h.d,{doctype:"io.cozy.files",documentType:"Notes"},i.a.createElement(o,{isPublic:r})),r&&i.a.createElement(o,{isPublic:r})))))),document.querySelector("[role=application]"))}(j,S,C)};document.addEventListener("DOMContentLoaded",y)},Q2Eh:function(e,t,n){e.exports={"note-article":"note-article--2yQdC",banner:"banner--1nSEd",title:"title--2DQ8I",titleInput:"titleInput--2ERlh"}},"R3/7":function(e,t,n){e.exports={"sharing-button":"sharing-button--nzFli"}},RMII:function(e,t,n){e.exports={empty:"empty--FqnXy",appHeader:"appHeader--2ilS0",tableSpecialRow:"tableSpecialRow--4oekp",tableCellEmpty:"tableCellEmpty--21fZ1",tableCellName:"tableCellName--2Jak9",tableCell:"tableCell--3-jDP",tableRow:"tableRow--3SicR"}},VxdY:function(e,t,n){},X3v2:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i});n("dasq");var a=function(){return document.querySelector("[role=application]").dataset},r=function(e,t){return/^\{\{\.[a-zA-Z]*\}\}$/.test(e)?t:e},i=function(){return new URLSearchParams(window.location.search).get("sharecode")}},ZAKO:function(e,t){e.exports="/img/icon.f72378381a11b6129372a35089fea845.svg"},Zlyp:function(e,t,n){"use strict";var a=n("pVnL"),r=n.n(a),i=n("q1tI"),s=n.n(i),o=n("X+Uv"),c=n("buk/"),l=n("yDJO"),u=n("ufaa"),d=n("SH7X"),f=n("kyGY"),p=Object(u.a)()(Object(c.d)()(function(e){var t=e.t;return!e.breakpoints.isMobile&&s.a.createElement(f.c,null,t("Notes.List.latest_notes"))})),h=n("7YkG"),m=n("V2U0"),v=n("1I/2"),b=n("GoJ1"),g=n("o0o1"),y=n.n(g),_=n("yXPU"),w=n.n(_),x=n("J4zp"),j=n.n(x),k=n("KXWi"),E=n("780l"),O=n("snnE");function C(e){var t=e.className,n=Object(c.e)().t,a=Object(d.useClient)(),r=Object(i.useState)(!1),o=j()(r,2),l=o[0],u=o[1],f=Object(i.useCallback)(w()(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),e.next=3,Object(O.a)(a);case 3:return t=e.sent,n=t.data,e.next=7,Object(O.c)(a,n);case 7:window.location.href=e.sent;case 8:case"end":return e.stop()}},e,this)})),[a]);return s.a.createElement(k.c,{onClick:f,type:"submit",busy:l,icon:"plus",label:n("Notes.Add.add_note"),extension:"narrow",className:t})}function S(e){var t=Object(d.useClient)()||e.client;return s.a.createElement(E.a,{onClick:w()(y.a.mark(function e(){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.a)(t);case 2:return n=e.sent,a=n.data,e.next=6,Object(O.c)(t,a);case 6:window.location.href=e.sent;case 7:case"end":return e.stop()}},e,this)})),icon:"plus",className:"u-c-pointer"})}var N=n("4BeY"),z=n.n(N),M=n("IaFt"),D=n.n(M),I=new z.a({id:"icon_note_empty_77efa79dd615f19897a8ed6ec9097298",use:"icon_note_empty_77efa79dd615f19897a8ed6ec9097298-usage",viewBox:"0 0 171 168",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 171 168" id="icon_note_empty_77efa79dd615f19897a8ed6ec9097298">\n    <defs>\n        <path id="icon_note_empty_77efa79dd615f19897a8ed6ec9097298_a" d="M.02.12h36.532v20.674H.02z" />\n    </defs>\n    <g fill="none" fill-rule="evenodd">\n        <path fill="#0DCBCF" d="M48.367 47.28c3.795-4.135 9.702 2.27 5.938 6.374-8.105 8.832-11.21 22.848-5.617 33.864 6.83 13.453 25.138 8.377 36.387 4.37 5.26-1.871 7.054 6.655 1.834 8.515-15.343 5.464-37.282 8.714-45.942-8.858-7.276-14.767-3.455-32.433 7.4-44.265" />\n        <path fill="#D6FAFB" d="M59.57 16.922c.739-4.162 1.797-8.167 3.764-11.417C66.807-.21 73.009-.675 79.69.561c3.047.47 76.99 11.012 78.873 11.76 6.957 2.843 7.343 8.129 5.837 14.148-.141.971-20.067 84.443-21.43 88.854-1.852 5.978-4.906 11.375-10.609 11.973-5.714.623-75.27-18.403-78.5-19.534-3.954-1.39-5.72-3.632-6.159-6.323-.603-1.443-.376-3.088-.067-5.144.8-5.412 8.228-69.79 11.935-79.373" />\n        <path fill="#FFF" d="M65.047 19.073S64.561 3.301 79.004 5.122c14.443 1.819 89.593 13.951 89.593 13.951v9.972l-15.17 7.281-88.38-17.253z" />\n        <path fill="#ACF5F7" d="M53.622 31.458c.246-4.25.829-8.372 2.413-11.844 2.795-6.122 8.927-7.314 15.747-6.87 3.103.105 6.245.706 8.959 1.155 13.33 2.21 60.933 9.536 62.437 9.936.853.239 3.242 1.012 3.93 1.337 5.173 2.422 4.26 6.643 3.56 12.102-.023.988-10.066 86.694-10.903 91.263-1.155 6.187-3.561 11.933-9.185 13.21-5.636 1.297-77.342-9.496-80.695-10.235-4.111-.928-6.143-2.958-6.897-5.597-.781-1.368-.738-3.034-.675-5.12.157-5.506 8.735-79.333 11.309-89.337" />\n        <path fill="#79ECEE" d="M134.818 99.416c4.069-24.17 8.504-48.43 11.948-72.677.037-.293.209-1.305.35-1.515-.04-.744 2.317.264 4.506.067.068 0 .925-.114.992-.114.716-.138 1.42-.29 2.149-.552 3.554-1.285 4.98-4.27 4.938-7.584-.046-2.971-2.376-4.28-2.285-5.071.047-.427 2.619.902 2.915 1 .405.133 3.131 1.892 4.372 4.065 1.249 2.19.856 5.296.785 8.049-.244 9.277-8.008 66.518-9.51 78.49.026.153-.358 3.1-.546 4.417-.38 2.901-.772 5.807-1.182 8.707-.319 2.271-1.653 15.153-1.929 15.747-3.391 7.361-12.892 9.872-20.513 9.34-.434.025-.851-.016-1.524-.102-.844-.108-2.024.034-3.35-.235.145-2.458 5.937-30.472 7.884-42.032" />\n        <path fill="#FFF" d="M98.24 56.354c3.65-6.425 11.472-9.96 18.354-7.212a10.488 10.488 0 0 1 4.359 2.129c.117.074.22.173.33.253.099.086.2.171.29.253a10.141 10.141 0 0 1 3.012 3.703c.14.243.285.483.408.733.028.087.095.136.12.22.089.233.126.462.208.7.4 1.024.667 2.088.785 3.213.399 2.397.348 4.8-.468 7.371-1.431 4.512-6.871 6.769-11.066 7.466-3.062.503-6.549-.22-9.546-1.52-4.286-1.86-5.61-4.269-6.733-7.469-1.146-3.274-1.878-6.632-.054-9.84M57.875 49.863c1.7-3.323 4.417-5.416 7.697-6.62.072-.048.117-.104.197-.162 2.037-1.45 4.806-2 7.4-1.642 6.076.399 11.603 5.645 13.426 11.64.926 3.055.816 6.827-.747 9.66-2.345 4.249-6.24 6.338-10.86 7.305-7.715 1.625-16.183-3.686-18.103-11.22-.745-2.904-.38-6.293.99-8.961" />\n        <path fill="#FFF" d="M97.573 60.005c.542 1.111 2.285 1.832 3.325 1.161 1.116-.715 1.315-2.42.479-3.462-.451-.557-1.063-.82-1.666-.79a.296.296 0 0 0-.235-.062c-1.392.108-2.635 1.68-1.903 3.153M82.511 58.042c.543 1.11 2.287 1.83 3.325 1.159 1.12-.72 1.318-2.42.479-3.46-.453-.558-1.059-.82-1.668-.791a.295.295 0 0 0-.227-.065c-1.4.11-2.637 1.679-1.909 3.157" />\n        <path fill="#FFF" d="M83.12 55.648c.916-3.33 5.387-5.305 8.553-5.085 3.765.266 8.59 3.494 9.277 7.454.373 2.132-3.201 2.492-3.554.466-.782-4.47-8.893-6.614-10.702-2.003-.036.357-.226.713-.675 1.002-.022.023-.05.037-.07.05-1.412.921-3.292-.203-2.83-1.884" />\n        <path fill="#79ECEE" d="M130.887 48.194c1.972 3.09 7.333 4.648 10.183 2.337 3.064-2.497 3.1-7.587.281-10.373-1.511-1.495-3.399-2.072-5.16-1.798a1.058 1.058 0 0 0-.718-.108c-4.064.775-7.221 5.81-4.586 9.942M127.85 77.94c1.733 2.724 6.45 4.093 8.956 2.058 2.697-2.199 2.723-6.673.244-9.122-1.327-1.316-2.985-1.825-4.536-1.582a.938.938 0 0 0-.63-.094c-3.578.679-6.353 5.109-4.034 8.74M123.467 106.767c1.607 2.793 6.26 4.374 8.854 2.454 2.796-2.074 3.021-6.54.654-9.102-1.267-1.375-2.901-1.949-4.46-1.781a.948.948 0 0 0-.627-.127c-3.603.52-6.573 4.823-4.42 8.556" />\n        <path fill="#D6FAFB" d="M134.92 71.16l.384-.004c3.34-.056 4.832 2.564 4.435 4.87.819 3.035 6.732 4.083 9.188 4.55 3.327.638 6.204.138 7.935-1.695a5.354 5.354 0 0 0 .518-.67c.964-1.44 1.663-2.972 2.485-4.46.207-1.606.413-3.208.626-4.844 1.045.01 7.44.93 7.404 5.085-.061 7.397-4.113 11.963-9.873 13.901.007-.076.018-.156.03-.233a.106.106 0 0 0-.042.013l.012.22c-2.516.844-5.377 1.193-8.431 1.044-7.434-.364-19.518-4.398-19.253-13.56.07-2.467 2.191-4.176 4.582-4.217M155.979 103.575c.026.15-.358 3.097-.548 4.415-.379 2.903-.77 5.807-1.182 8.708-.04.298-.1.792-.173 1.41-.423.111-.846.232-1.267.325-9.933 2.216-23.748-2.264-26.83-12.978-1.387-4.823 5.737-6.845 8.28-3.535 3.25 3.006 6.375 4.279 10.726 4.987 2.315.378 9.589 1.174 10.133-1.001l.86-2.331z" />\n        <path fill="#D6FAFB" d="M155.43 107.99c.19-1.318.575-4.264.549-4.415.141-1.139.343-2.691.587-4.57 1.43-.943 3.35-1.181 4.91-.156 4.028 2.644 5.269 6.247 3.534 10.833-1.791 4.722-6.312 7.18-10.936 8.425.075-.617.134-1.11.175-1.409.412-2.901.803-5.805 1.182-8.708" />\n        <path fill="#0DCBCF" d="M97.295 86.818c.143-.42-.082-.821-.543-.907l-15.969-2.926c-.445-.086-.826.224-.826.667 0 0-.792 8.124 7.2 9.59 7.994 1.46 10.138-6.424 10.138-6.424M106.717 66.413a2.628 2.628 0 0 0 2.9-2.325c.148-1.137.803-3.051 3.438-2.757 2.873.313 2.836 2.714 2.758 3.44a2.632 2.632 0 0 0 2.32 2.906 2.635 2.635 0 0 0 2.902-2.328c.367-3.341-1.301-8.563-7.404-9.24-6.1-.67-8.868 4.061-9.233 7.399a2.623 2.623 0 0 0 2.319 2.905M65.97 60.55a2.618 2.618 0 0 0 2.898-2.323c.154-1.135.809-3.045 3.444-2.756 2.873.32 2.836 2.715 2.758 3.446a2.628 2.628 0 0 0 2.324 2.898 2.633 2.633 0 0 0 2.896-2.326c.369-3.336-1.295-8.561-7.399-9.232-6.107-.682-8.87 4.055-9.24 7.395a2.62 2.62 0 0 0 2.319 2.898M7.328 107.186s-4.037-2.086 6.805-8.374c10.108-5.864 7.278 10.253 7.278 10.253l-14.083-1.88z" />\n        <path fill="#DFFCFC" d="M77.122 128.065c-3.962-7.31-6.318-14.535-8.397-21.528-3.496-11.78-4.837-23.725-10.418-35.926-.384-.842-1.51-1.893-2.359-2.092a1247.17 1247.17 0 0 1-45.203-11.481C5.086 55.485.713 55.304.083 59.109c-.007.039-.016.076-.022.12-.14.995-.046 2.243.353 3.81.19.754.696 1.372 1.281 1.841C4.793 75.29 6.898 85.406 10.32 95.907c3.831 11.75 8.712 23.72 12.591 35.483.415 1.26 1.806 2.668 3.07 2.721.323.013.648.028.971.04 3.006 1.149 30.837 7.319 41.229 8.583 4.412.538 18.182 5.133 17.55-.856-.335-3.168-7.048-10.931-8.61-13.813" />\n        <path fill="#0DCBCF" d="M24.169 106.068c-4.748.862-9.072.078-13.23-2.376-3.782-2.232-6.633 3.978-2.878 6.194a24.375 24.375 0 0 0 16.752 2.983c4.29-.779 3.694-7.587-.644-6.801" />\n        <path fill="#0DCBCF" d="M26.43 113.925c-4.822.208-9-1.152-12.787-4.147-3.445-2.725-7.11 3.043-3.69 5.747a24.362 24.362 0 0 0 16.193 5.225c4.356-.19 4.689-7.017.284-6.825" />\n        <path fill="#0DCBCF" d="M27.7 121.497c-4.773-.725-8.608-2.867-11.746-6.535-2.856-3.338-7.566 1.615-4.73 4.929a24.372 24.372 0 0 0 14.88 8.249c4.313.653 5.952-5.982 1.595-6.643" />\n        <path fill="#D6FAFB" d="M56.82 163.387c2.634 1.707 9.394 3.19 14.841 3.785 14.866 1.625 35.651.773 44.451-2.186 8.875-2.98 9.27-7.505-13.293-9.77-19.21-1.926-41.628.772-46.423 4.818-1.286 1.083-1.211 2.293.423 3.353" />\n        <path fill="#FFF" d="M85.93 121.501l-8.872-2.495 5.144-7.99 53.966-19.197a4.453 4.453 0 0 1 5.686 2.7l.746 2.099a4.45 4.45 0 0 1-2.702 5.686L85.93 121.5z" />\n        <path fill="#0DCBCF" d="M154.388 66.712c-4.389-3.498-9.232 3.746-4.877 7.216 9.374 7.469 14.612 20.835 10.794 32.583-4.663 14.35-23.538 12.171-35.273 9.956-5.483-1.035-5.935 7.667-.492 8.695 16.003 3.021 38.184 2.835 44.015-15.867 4.9-15.715-1.61-32.577-14.167-42.583" />\n        <path fill="#0DCBCF" d="M117.57 120.966c-.858-.505-1.8-.82-2.724-.954.007-.692-.294-1.44-.896-2.045a5.36 5.36 0 0 0-1.042-.795c.604-.217 1.24-.4 1.767-.57 4.603-1.484-.888-7.006-5.49-5.523-4.248 1.372-8.193 3.504-7.248 7.418.244 1.01 1.247 2.234 2.773 2.788.09.031.177.056.268.09.235 1.784 2.018 3.698 4.6 4.72.32.126.656.225.99.326.556 1.45 2.692 2.89 4.895 2.99 5.026.234 8.746-1.607 9.6-4.766.4-1.491-1.568-3.332-3.883-3.906-1.418-.35-2.69-.218-3.61.227" />\n        <path fill="#0DCBCF" d="M116.74 108.083c-2.338-.522-12.208 2.855-5.111 5.063 1.627.505 1.248.814 2.754 1.558-.564.2-1.05.473-1.4.824-2.277.728-2.681 3.583-1.654 5.93 1.48 3.38 2.415 7.939 7.426 7.805 5.597-.148 12.373-6.007 12.023-9.417-.211-2.065-1.65-5.025-4.013-6.767-1.204-.887-7.684-4.475-10.024-4.996" />\n        <path fill="#0DCBCF" d="M118.038 108.505s-11.852-4.477-13.846-1.858c-1.799 2.363-5.817 10.49-3.131 10.95 2.683.463 10.129-2.62 10.129-2.62l6.848-6.472z" />\n        <g transform="translate(134.244 38.595)">\n            <mask id="icon_note_empty_77efa79dd615f19897a8ed6ec9097298_b" fill="#fff">\n                <use xlink:href="#icon_note_empty_77efa79dd615f19897a8ed6ec9097298_a" />\n            </mask>\n            <path fill="#D6FAFB" d="M9.325 7.036c.397 5.93 8.7 6.329 13.777 4.795.42-.158.845-.317 1.23-.505a9.225 9.225 0 0 0 1.389-.872c.082-.06.995-.824 1.133-.954 1.086-1.008 2.065-2.238 2.415-3.433.248-2.072.485-4.087.695-5.947a8.54 8.54 0 0 1 2.63 1.137C34 2.191 34.869 3.2 35.499 4.768c.088.213.125.438.17.665.332.608.553 1.271.557 1.963 1.55 5.622-2.602 9.814-8.58 11.908.032-.244.058-.477.09-.717-.01.004-.02.011-.029.015-.018.233-.03.458-.061.702C17.12 22.994.906 20.164.03 7.036c-.365-5.393 8.932-5.393 9.294 0" mask="url(#icon_note_empty_77efa79dd615f19897a8ed6ec9097298_b)" />\n        </g>\n        <path fill="#ACF5F7" d="M67.018 83.907a4.967 4.967 0 1 1-9.935 0 4.966 4.966 0 0 1 4.967-4.967 4.967 4.967 0 0 1 4.968 4.967M73.57 105.824a4.967 4.967 0 1 1-9.935 0 4.966 4.966 0 0 1 4.966-4.966 4.967 4.967 0 0 1 4.969 4.966M80.564 124.544a4.967 4.967 0 0 1-4.968 4.966 4.966 4.966 0 0 1-4.967-4.966 4.967 4.967 0 1 1 9.935 0" />\n    </g>\n</symbol>'}),R=(D.a.add(I),I),P=n("Le8U"),T={_type:"io.cozy.apps",_id:"io.cozy.apps/notes"},L=function(e){var t=Object(i.useState)(Object(O.e)(e)),n=j()(t,2),a=n[0],r=n[1];return Object(i.useEffect)(function(){var t;(t=w()(y.a.mark(function t(){var n,a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,P.CozyFolder.getReferencedFolders(T);case 3:n=t.sent,a=Object(O.e)(e,n[0]._id),r(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),r(Object(O.e)(e));case 11:case"end":return t.stop()}},t,this,[[0,8]])})),function(){return t.apply(this,arguments)})()},[e]),{notesFolder:a}},U=n("sCMN"),F=Object(c.d)()(Object(d.withClient)(function(e){var t=e.t,n=e.client,a=L(n).notesFolder;return s.a.createElement("div",{className:"empty"},s.a.createElement(b.a,{id:"empty",icon:R,title:t("Notes.Empty.welcome"),text:s.a.createElement(U.a,{href:a,slug:"drive"},function(e){var n=e.href,a=e.onClick;return s.a.createElement("span",{className:"u-mb-half"},t("Notes.Empty.after_created")," ",s.a.createElement("a",{href:n,onClick:a},"Cozy Drive"),".")})},s.a.createElement(C,{className:"u-mt-1"})))})),q=n("UmWK"),A=n("y6ex"),B=n("lEaz"),Q=n("67rm"),V=n("UxX4"),J=n("RMII"),H=n.n(J),W=new z.a({id:"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d",use:"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d-usage",viewBox:"0 0 32 32",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" id="icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d">\n<style type="text/css">\n\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#ACF5F7;}\n\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st1{fill-rule:evenodd;clip-rule:evenodd;fill:#0DCBCF;}\n</style>\n<g transform="translate(2)">\n\t<path class="st0" d="M0,2c0-1.1,0.9-2,2-2h22c1.1,0,2,0.9,2,2v28c0,1.1-0.9,2-2,2H2c-1.1,0-2-0.9-2-2V2z" />\n\t<path class="st1" d="M6,8h14v2H6V8z M6,12h8v2H6V12z M6,16h14v2H6V16z M6,20h10v2H6V20z" />\n</g>\n<g transform="translate(0 4)">\n\t<path class="st1" d="M1.5,0h2C4.3,0,5,0.7,5,1.5l0,0C5,2.3,4.3,3,3.5,3h-2C0.7,3,0,2.3,0,1.5l0,0C0,0.7,0.7,0,1.5,0z" />\n\t<path class="st1" d="M1.5,7h2C4.3,7,5,7.7,5,8.5l0,0C5,9.3,4.3,10,3.5,10h-2C0.7,10,0,9.3,0,8.5l0,0C0,7.7,0.7,7,1.5,7z" />\n\t<path class="st1" d="M1.5,14h2C4.3,14,5,14.7,5,15.5l0,0C5,16.3,4.3,17,3.5,17h-2C0.7,17,0,16.3,0,15.5l0,0C0,14.7,0.7,14,1.5,14z" />\n\t<path class="st1" d="M1.5,21h2C4.3,21,5,21.7,5,22.5l0,0C5,23.3,4.3,24,3.5,24h-2C0.7,24,0,23.3,0,22.5l0,0C0,21.7,0.7,21,1.5,21z" />\n</g>\n<g>\n\t<path class="st1" d="M31.4,18.4l-2.8-2.8c0.8-0.8,2-0.8,2.8,0S32.2,17.6,31.4,18.4z" />\n\t<path class="st1" d="M30.7,19.1L20.8,29l-2.5,0.9c-0.5,0.2-1.1-0.1-1.3-0.6c-0.1-0.2-0.1-0.5,0-0.7l0.9-2.5l9.9-9.9L30.7,19.1z" />\n</g>\n</symbol>'}),X=(D.a.add(W),W),Z=Object(c.d)()(Object(d.withClient)(function(e){var t=e.note,n=e.f,a=e.t,r=e.client,o=P.CozyFile.splitFilename(t),c=o.filename,l=o.extension,u=Object(v.b)().isMobile,d=Object(i.useState)(!1),f=j()(d,2),p=f[0],m=f[1],b=Object(i.useCallback)(function(e){m(!0),e.stopPropagation()},[m]),g=Object(i.useCallback)(function(){return m(!1)},[m]),_=Object(i.useCallback)(w()(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.destroy(t);case 3:m(!1),Q.a.info(a("Notes.Delete.deleted")),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Q.a.error(a("Notes.Delete.failed"));case 10:case"end":return e.stop()}},e,this,[[0,7]])})),[r,t,a,m]),x=s.a.createRef();return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.f,{className:"u-c-pointer ".concat(H.a.tableRow),onClick:w()(y.a.mark(function e(){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.c)(r,t);case 2:n=e.sent,window.location.href=n;case 4:case"end":return e.stop()}},e,this)}))},s.a.createElement(h.c,{className:"".concat(H.a.tableCellName," u-flex u-flex-items-center u-fz-medium")},s.a.createElement(A.a,{icon:X,size:32,className:"u-mr-1 u-flex-shrink-0"}),s.a.createElement("span",{className:"u-charcoalGrey u-ellipsis"},c),!u&&s.a.createElement("span",{className:"u-ellipsis"},l)),!u&&s.a.createElement(s.a.Fragment,null,s.a.createElement(h.c,{className:H.a.tableCell},a("Notes.List.at",{date:n(t.updated_at,"DD MMMM"),time:n(t.updated_at,"HH:mm")})),s.a.createElement(h.c,{className:H.a.tableCell},"â€”"),s.a.createElement(h.c,{className:H.a.tableCell},s.a.createElement(q.c,{docId:t._id,size:"small"}))),s.a.createElement(h.c,{className:H.a.tableCell},s.a.createElement("span",{ref:x},s.a.createElement(B.a,{onClick:b},s.a.createElement(A.a,{icon:"dots"}))))),p&&s.a.createElement(V.b,{onClose:g,anchorElRef:x,placement:"bottom-end"},s.a.createElement(V.a,{onClick:_,left:s.a.createElement(A.a,{icon:"trash"})},a("Notes.Delete.delete_note"))))})),K=function(){return s.a.createElement(h.f,{className:H.a.tableSpecialRow},s.a.createElement(h.c,{className:H.a.tableCellEmpty},s.a.createElement(F,null)))},G=function(){return s.a.createElement(h.f,{className:H.a.tableSpecialRow},s.a.createElement(h.c,{className:"".concat(H.a.tableCellEmpty," u-ta-center")},s.a.createElement(m.a,{size:"xxlarge"})))},Y=Object(c.d)()(function(e){var t=e.t,n=e.notes,a=e.fetchStatus,r=Object(v.b)().isMobile;return s.a.createElement(h.a,null,s.a.createElement(h.d,null,s.a.createElement(h.f,null,s.a.createElement(h.e,{className:H.a.tableCellName},t("Notes.List.name")),!r&&s.a.createElement(s.a.Fragment,null,s.a.createElement(h.e,{className:H.a.tableCell},t("Notes.List.updated_at")),s.a.createElement(h.e,{className:H.a.tableCell},t("Notes.List.location")),s.a.createElement(h.e,{className:H.a.tableCell},t("Notes.List.sharings"))),s.a.createElement(h.e,{className:H.a.tableCell}))),s.a.createElement(h.b,null,"loading"===a?s.a.createElement(G,null):0===n.length?s.a.createElement(K,null):n.map(function(e){return s.a.createElement(Z,{note:e,key:e._id})})))}),$=function(e,t){return"loaded"===e&&t.length>0},ee=Object(u.a)()(function(e){var t=e.breakpoints.isMobile,n=cozy.bar.BarRight,a=Object(c.e)(),i=Object(d.useClient)();return s.a.createElement(d.Query,{query:function(){return Object(d.Q)("io.cozy.notes")}},function(e){var c=e.data,u=e.fetchStatus;return s.a.createElement(s.a.Fragment,null,s.a.createElement(o.a,{className:"u-mt-1 u-mt-0-m"},s.a.createElement("div",{className:"".concat(H.a.appHeader," u-flex u-flex-justify-between u-flex-items-center")},s.a.createElement(p,null),!t&&$(u,c)&&s.a.createElement(C,null)),s.a.createElement(Y,{notes:c,fetchStatus:u})),t&&$(u,c)&&s.a.createElement(n,null,s.a.createElement(l.a,r()({store:i.store,client:i},a),s.a.createElement(S,null))))})}),te=n("MVZn"),ne=n.n(te),ae=n("17x9"),re=n.n(ae),ie=n("k4o+"),se=n("9jEr"),oe=n("jWvl"),ce=n("KXVJ"),le={allowTables:!0,allowRule:!0,allowLists:!0,allowTextColor:!0,allowPanel:!0,allowCodeBlocks:!1,allowHelpDialog:!1,allowBlockTypes:{exclude:["codeBlocks"]}},ue=function(e){return s.a.createElement("header",{className:"page-header-menu "+(e.className||"")},s.a.createElement("div",{className:"page-header-menu--left"},e.left),e.children,s.a.createElement("div",{className:"page-header-menu--right"},e.right))},de=n("Q2Eh"),fe=n.n(de);var pe=function(){};var he=function(e){var t=e.defaultValue,n=e.onTitleChange,a=e.onTitleBlur,o=e.defaultTitle,l=e.title,u=e.collabProvider,d=e.leftComponent,p=e.rightComponent,h=e.onContentChange,m=e.readOnly,v=e.bannerRef,b=Object(c.e)().t,g=Object(i.useRef)(null),y=Object(i.useCallback)(function(e){n&&n(e)},[n]);Object(i.useMemo)(function(){return u&&u.setReadOnly(!!m)},[m,u]);var _=Object(i.useMemo)(function(){return u&&{useNativePlugin:!0,provider:Promise.resolve(u),inviteToEditHandler:function(){},isInviteToEditButtonSelected:!1,userId:u.serviceClient.getSessionId()}},[u]);return Object(i.useEffect)(function(){var e;(e=g.current)&&(e.style.height="".concat(e.scrollHeight,"px"))},[l]),Object(ce.a)(g.current,"blur",a),s.a.createElement("article",{className:fe.a["note-article"]},s.a.createElement("style",null,"#coz-bar ","{ display: none }"),s.a.createElement(ue,{left:d,className:"note-header-menu--editing",right:p}),s.a.createElement("section",{className:"note-editor-container"},s.a.createElement(ie.a,r()({disabled:!u&&m,collabEdit:_,onChange:h||pe,defaultValue:t},le,{appearance:"full-page",placeholder:b("Notes.EditorView.main_placeholder"),shouldFocus:!m,contentComponents:s.a.createElement(se.a,{render:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("aside",{ref:v,className:fe.a.banner}),s.a.createElement(f.c,{tag:"h1",className:fe.a.title},s.a.createElement(oe.a,{ref:g,rows:"1",readOnly:!!m,fullwidth:!0,value:l,onChange:m?pe:y,placeholder:o,className:fe.a.titleInput})))}})}))))},me=n("SOfb");var ve=function(e){var t=e.cozyClient,n=e.file,a=Object(i.useState)(void 0),r=j()(a,2),s=r[0],o=r[1];return Object(i.useEffect)(function(){function e(){return(e=w()(y.a.mark(function e(n){var a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.models.file.normalize(n),e.prev=1,e.next=4,t.query(t.get("io.cozy.files",a.attributes.dir_id));case 4:r=e.sent,o(d.models.file.ensureFilePath(a,r.data)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.warn("Request failed when try to fetch the parent ".concat(a.attributes.dir_id," of io.cozy.files ").concat(a.id)),o(null);case 12:case"end":return e.stop()}},e,this,[[1,8]])}))).apply(this,arguments)}!function(t){e.apply(this,arguments)}(n)},[t,n,n.attributes.dir_id]),s&&s.id==n.id?s:void 0},be=n("R3/7"),ge=n.n(be);function ye(e){var t=Object(d.useClient)(),n=ve({cozyClient:t,file:e.file}),a=n&&n.id,r=Object(i.useState)(!1),o=j()(r,2),c=o[0],l=o[1],u=Object(i.useCallback)(function(){return l(!c)},[c]),f=Object(i.useCallback)(function(){return l(!1)},[]);return n&&s.a.createElement(s.a.Fragment,null,s.a.createElement(q.a,{theme:"primary",docId:a,onClick:u,extension:"narrow",className:ge.a["sharing-button"]}),c&&s.a.createElement(q.b,{document:n,onClose:f}))||null}var _e=function(e){var t=e.doc,n=e.isPublic,a=e.isReadOnly;if(n){if(a){var r=Object(c.e)().t;return s.a.createElement(me.a,{title:r("Notes.Editor.read_only")},s.a.createElement(A.a,{icon:"lock",color:"var(--primaryTextColor)"}))}return null}return s.a.createElement(ye,{file:t.file})};_e.propTypes={doc:re.a.object.isRequired,isPublic:re.a.bool.isRequired,isReadOnly:re.a.bool.isRequired};var we=_e;var xe=function(){return s.a.createElement("div",{className:"u-mv-3"},s.a.createElement(m.a,{size:"xxlarge",middle:!0}))};var je=Object(c.d)()(function(e){var t=e.t,n=e.returnUrl;return s.a.createElement(b.a,{icon:"cross-small",title:t("Error.loading_error_title"),text:s.a.createElement("p",{className:"u-mb-half",dangerouslySetInnerHTML:{__html:n?t("Error.loading_error_text_returnUrl",{url:n}):t("Error.loading_error_text_noReturnUrl")}})})}),ke=n("h+bj"),Ee=n("Jl/m"),Oe=n("84gJ"),Ce=n.n(Oe),Se=n("i8i4"),Ne=n.n(Se),ze=n("DvoB"),Me=n("tNlo"),De=n("SUMQ"),Ie=n("yWSb"),Re=n.n(Ie),Pe=Object(De.withStyles)({tooltipPlacementBottom:{margin:"12px 24px"},tooltipPlacementTop:{margin:"12px 24px"}},{name:"MuiTooltip"})(me.a);function Te(e){return s.a.createElement(Pe,{title:e.content,open:e.open||void 0,key:e.open?"open":"auto"},e.children)}function Le(e){var t=e.bannerRef&&e.bannerRef.current;return t?Ne.a.createPortal(s.a.createElement("div",{className:Re.a.banner},e.content),t):null}function Ue(e){var t=Object(c.e)().t,n=Object(v.b)().isMobile,a=s.a.createElement(ze.a,{direction:"row",container:!0,wrap:"nowrap",spacing:16,className:Re.a.grid},s.a.createElement(ze.a,{item:!0},s.a.createElement(Me.a.Round,{className:Re.a.chip},s.a.createElement(A.a,{icon:"offline",color:"var(--black)"}))),s.a.createElement(ze.a,{item:!0},t("Notes.OfflineIndicator.message"))),r=n?Le:Te;return s.a.createElement(r,{open:e.open,content:a,bannerRef:e.bannerRef},e.children)}var Fe=n("DzJC"),qe=n.n(Fe),Ae=200;var Be=1e3,Qe=5*Be,Ve=30*Be;var Je=function(e){var t=Object(c.e)().t,n=Object(v.b)().isMobile,a=new Date,r=e.collabProvider,o=a-(r.getLastSaveOrSync()||a),l=r.isDirty(),u=a-r.getDirtySince();!function(e){var t=Object(i.useState)(null),n=j()(t,2)[1],a=Object(i.useCallback)(qe()(function(){return n(new Date)},Ae),[n]);Object(i.useEffect)(function(){return e.on("collab-state-change",a),function(){return e.off("collab-state-change",a)}},[e,a])}(r);var d,p=function(e){var t=e.isOutOfSync,n=new Date,a=Object(Ee.a)()||t,r=Object(i.useMemo)(function(){return new Date},[a]);return{isDisconnected:a,disconnectedAge:a?n-r:0}}({isOutOfSync:function(e){var t=e.isDirty,n=e.dirtyAge;return t&&n&&n>Ve}({isDirty:l,dirtyAge:u})}),h=p.isDisconnected,m=p.disconnectedAge,b=function(e){var t=e.disconnectedAge,n=e.isDisconnected&&t<Qe,a=Qe-t;return Object(ke.a)(n&&a),n}({isDisconnected:h,disconnectedAge:m}),g=h?m:l?u:o,y=Object(O.l)(g),_=y.key,w=y.time,x=y.interval;Object(ke.a)(x),d=l?h?"saving_impossible.".concat(_):u>5*Be?"still_saving":"saving":h?"out_of_sync.".concat(_):"saved.default";var k=t("Notes.SavingIndicator.".concat(d),{time:w}),E=s.a.createElement(f.e,{className:Ce.a["saving-indicator"]},k);return h?s.a.createElement(Ue,{open:b,bannerRef:e.bannerRef},E):n?null:E},He=n("lwsE"),We=n.n(He),Xe=n("W8MJ"),Ze=n.n(Xe),Ke=n("G2JP"),Ge=function(){function e(){We()(this,e)}return Ze()(e,[{key:"preventDefault",value:function(){this.prevented=!0}}]),e}();function Ye(e,t,n){var a=function(){var e=new Ge;n&&n(e),e.prevented||(document.location=t)};return function(t){t.preventDefault(),e(a)}}function $e(e){var t=e.returnUrl,n=e.file,a=e.requestToLeave,r=Object(i.useContext)(Ke.a);if(t){var o=d.models.file.getParentFolderId(n),c=Object(O.f)(o);return s.a.createElement(U.a,{slug:"drive",href:t,nativePath:c},function(e){var t=e.onClick,n=e.href;return s.a.createElement(k.b,{icon:"previous",onClick:Ye(a,n,t),href:n,className:"sto-app-back",subtle:!0})})}if(r)return null;return s.a.createElement(k.a,{icon:"previous",href:"#/",onClick:Ye(a,"#/"),className:"sto-app-back",subtle:!0})}var et=function(e){var t=e.serviceClient,n=e.noteId,a=Object(i.useState)(n),r=j()(a,2),s=r[0],o=r[1],c=Object(i.useState)(!0),l=j()(c,2),u=l[0],d=l[1],f=Object(i.useState)(void 0),p=j()(f,2),h=p[0],m=p[1],v=Object(i.useState)(void 0),b=j()(v,2),g=b[0],_=b[1];return Object(i.useEffect)(function(){function e(){return(e=w()(y.a.mark(function e(){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u||d(!0),e.next=4,t.getDoc(s);case 4:n=e.sent,_(n.title||""),m(n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),_(!1),m(!1),console.warn("Could not load note ".concat(s));case 14:d(!1);case 15:case"end":return e.stop()}},e,this,[[0,9]])}))).apply(this,arguments)}s!==n?(d(!0),_(void 0),m(void 0),o(n)):t&&(h&&h.file.id===s||function(){e.apply(this,arguments)}())},[n,s,o,d,t,m,_]),s===n?{loading:u,title:g,doc:h,setTitle:_}:{loading:!0,title:void 0,doc:void 0,setTitle:_}},tt=n("hmtS"),nt=function(){function e(t){We()(this,e);var n=t.userId,a=t.cozyClient,r=t.schema,i=t.realtime,s=new Date,o=s.getTime()+"."+s.getMilliseconds()+"."+Math.random();this.sessionId=n+":"+o,this.userId=this.getUserId(n),this.cozyClient=a,this.stackClient=a.getStackClient(),this.schema=r,this.onRealtimeEvent=this.onRealtimeEvent.bind(this),this.realtime=i||a.plugins.realtime,this.resetCallbacks()}var t,n,a,r,i,s,o,c,l,u,d;return Ze()(e,[{key:"resetCallbacks",value:function(){this.callbacks={}}},{key:"setCallback",value:function(e,t,n){this.callbacks[e]=this.callbacks[e]||{},this.callbacks[e][t]=n}},{key:"getUserId",value:function(e){return e?e.match(/[^:]+/)[0]:this.userId}},{key:"getSessionId",value:function(){return this.sessionId}},{key:"close",value:function(){this.realtime.unsubscribeAll(),this.resetCallbacks()}},{key:"defaultTitle",value:function(){return(new Date).toISOString()}},{key:"path",value:function(e,t){return e?t?"/notes/".concat(e,"/").concat(t):"/notes/".concat(e):"/notes"}},{key:"client2server",value:function(e){return ne()({sessionID:e.sessionId||this.sessionId},e)}},{key:"server2client",value:function(e){return ne()({sessionId:e.sessionID,userId:this.getUserId(e.sessionID)},e)}},{key:"create",value:(d=w()(y.a.mark(function e(t,n){var a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:{type:"io.cozy.notes.documents",attributes:{title:t||this.defaultTitle(),schema:n||this.schema||tt.a}}},e.abrupt("return",this.stackClient.fetchJSON("POST",this.path(),a));case 2:case"end":return e.stop()}},e,this)})),function(e,t){return d.apply(this,arguments)})},{key:"sync",value:(u=w()(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stackClient.fetchJSON("POST",this.path(t,"sync"));case 2:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"setTitle",value:(l=w()(y.a.mark(function e(t,n){var a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:{type:"io.cozy.notes.documents",id:t,attributes:this.client2server({title:n})}},e.next=3,this.stackClient.fetchJSON("PUT",this.path(t,"title"),a);case 3:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"onRealtimeEvent",value:function(e){var t=e.id||e._id,n=e.doctype;if(this.callbacks[n]&&this.callbacks[n][t])return this.callbacks[n][t](e);console.warn("Event not managed",n,t,this.callbacks)}},{key:"join",value:(c=w()(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.realtime.subscribe(null,"io.cozy.notes.events",t,this.onRealtimeEvent)]);case 2:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"onStepsCreated",value:(o=w()(y.a.mark(function e(t,n){var a=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setCallback("io.cozy.notes.steps",t,function(e){return n(a.server2client(e))});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"onTelepointerUpdated",value:(s=w()(y.a.mark(function e(t,n){var a=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setCallback("io.cozy.notes.telepointers",t,function(e){return n(a.server2client(e))});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return s.apply(this,arguments)})},{key:"onTitleUpdated",value:(i=w()(y.a.mark(function e(t,n){var a=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setCallback("io.cozy.notes.documents",t,function(e){return e.sessionID&&e.sessionID==a.sessionId?null:n(e.title)});case 1:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"getDoc",value:(r=w()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stackClient.fetchJSON("GET",this.path(t));case 2:return n=e.sent,e.abrupt("return",{doc:n.data.attributes.metadata.content,version:n.data.attributes.metadata.version,title:n.data.attributes.metadata.title,updatedAt:new Date(n.data.attributes.updated_at),file:n.data});case 4:case"end":return e.stop()}},e,this)})),function(e){return r.apply(this,arguments)})},{key:"pushSteps",value:(a=w()(y.a.mark(function e(t,n,a){var r,i,s=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{"if-match":n}},i={data:a.map(function(e){return{type:"io.cozy.notes.steps",attributes:s.client2server(e.toJSON())}})},e.next=4,this.stackClient.fetchJSON("PATCH",this.path(t),i,r);case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}},e,this)})),function(e,t,n){return a.apply(this,arguments)})},{key:"getSteps",value:(n=w()(y.a.mark(function e(t,n){var a,r,i,s,o,c,l,u,d,f,p=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.stackClient.fetchJSON("GET","".concat(this.path(t,"steps"),"?Version=").concat(n));case 3:if(0!=(a=e.sent).data.length){e.next=8;break}return e.abrupt("return",{steps:[],version:n});case 8:return r=a.data.map(function(e){return p.server2client(e.attributes)}),i=a.data[a.data.length-1].attributes.version,e.abrupt("return",{version:i,steps:r});case 11:e.next=28;break;case 13:if(e.prev=13,e.t0=e.catch(0),s=e.t0.response,o=e.t0.reason&&e.t0.reason.data,c=o&&o.attributes&&o.attributes.metadata,l=c&&c.content,u=c&&c.version,412!=s.status||!l||!u){e.next=27;break}return f={_id:t,_type:"io.cozy.notes.events",doctype:d="io.cozy.notes.documents",title:c.title},this.callbacks[d]&&this.callbacks[d][t]&&this.callbacks[d][t](f),e.abrupt("return",{doc:l,version:u});case 27:throw e.t0;case 28:case"end":return e.stop()}},e,this,[[0,13]])})),function(e,t){return n.apply(this,arguments)})},{key:"pushTelepointer",value:(t=w()(y.a.mark(function e(t,n){var a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={data:{type:"io.cozy.notes.telepointers",id:t,attributes:this.client2server(n)}},e.abrupt("return",this.stackClient.fetchJSON("PUT",this.path(t,"telepointer"),a));case 2:case"end":return e.stop()}},e,this)})),function(e,n){return t.apply(this,arguments)})}]),e}();var at=function(e){var t=e.userId,n=e.userName,a=e.cozyClient;return Object(i.useMemo)(function(){return new nt({userId:t,userName:n,cozyClient:a})},[a,t,n])},rt=n("RIqP"),it=n.n(rt),st=n("lSNA"),ot=n.n(st),ct=n("cjKa"),lt=n("O1Kf"),ut=n("bfWj"),dt=n("kdbL"),ft=n.n(dt),pt=n("/RjM"),ht=function(){function e(t,n){We()(this,e),this.config=t,this.service=n,this.eventEmitter=new ct.EventEmitter2,this.resetBackoff(),this.initializeStepsQueue(),this.isSending=!1}var t,n,a,r,i,s;return Ze()(e,[{key:"resetBackoff",value:function(){this.backoff=0,this.failures=0}},{key:"increaseBackoff",value:function(){this.failures=this.failures+1,this.failures%4==0&&this.emit("needcatchup",{failures:this.failures}),this.backoff=Math.max(Math.min(2*this.backoff,3e5),128)}},{key:"afterBackoff",value:function(){var e=this;return new Promise(function(t){e.backoff<128?t():window.setTimeout(t,e.backoff)})}},{key:"initializeStepsQueue",value:function(){this.queuedStep=void 0}},{key:"isDirty",value:function(){return this.hasQueuedSteps()||this.isSending}},{key:"ensureEmptyQueue",value:(s=w()(y.a.mark(function e(){var t=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){t.isDirty()?t.on("emptyQueue",function t(){this.off("emptyQueue",t),e()}):e()}));case 1:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"enqueueSteps",value:function(e){var t=e.getState,n=e.state,a=e.localSteps;this.queuedStep={getState:t,state:n,localSteps:a}}},{key:"dequeueSteps",value:function(){var e=this.queuedStep,t=e.getState,n=e.state||t(),a=e.localSteps||Object(lt.sendableSteps)(n)||{steps:[]};return this.queuedStep=void 0,{getState:t,state:n,localSteps:a}}},{key:"hasQueuedSteps",value:function(){return!!this.queuedStep}},{key:"rebaseStepsInQueue",value:function(){this.queuedStep&&(this.queuedStep={getState:this.queuedStep.getState})}},{key:"sendSteps",value:(i=w()(y.a.mark(function e(t,n,a){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.emit("enqueueSteps"),this.enqueueSteps({getState:t,state:n,localSteps:a}),e.next=4,this.processQueue();case 4:case"end":return e.stop()}},e,this)})),function(e,t,n){return i.apply(this,arguments)})},{key:"processQueue",value:(r=w()(y.a.mark(function e(){var t,n,a,r,i,s,o;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isSending){e.next=2;break}return e.abrupt("return");case 2:if(this.hasQueuedSteps()){e.next=5;break}return this.emit("emptyQueue"),e.abrupt("return");case 5:return this.isSending=!0,e.next=8,this.afterBackoff();case 8:if(t=this.dequeueSteps(),n=t.getState,a=t.state,r=t.localSteps.steps,void 0!==(i=Object(lt.getVersion)(a))){e.next=12;break}return e.abrupt("return");case 12:if(0!==r.length){e.next=14;break}return e.abrupt("return");case 14:return e.prev=14,s=this.config.noteId,e.next=18,this.service.pushSteps(s,i,r);case 18:o=e.sent,this.rebaseStepsInQueue(),this.resetBackoff(),this.emit("successfulPatch"),this.isSending=!1,o&&o.steps&&o.steps.length>0&&this.emit("data",o),e.next=32;break;case 26:e.prev=26,e.t0=e.catch(14),ft()("notes.lastPatchError")&&Object(pt.a)("notes.lastPatchError",e.t0),this.hasQueuedSteps()?this.rebaseStepsInQueue():this.enqueueSteps({getState:n}),this.increaseBackoff(),this.isSending=!1;case 32:return e.next=34,this.processQueue();case 34:case"end":return e.stop()}},e,this,[[14,26]])})),function(){return r.apply(this,arguments)})},{key:"connect",value:(a=w()(y.a.mark(function e(t){var n,a,r,i,s=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.version,a=t.doc,r=t.updatedAt,i=this.config.noteId,this.service.join(i),this.service.onStepsCreated(i,function(e){s.emit("data",{version:e.version,steps:[e]})}),this.service.onTelepointerUpdated(i,function(e){s.emit("telepointer",e)}),this.emit("connected",{version:n,doc:a,updatedAt:r});case 6:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"getSteps",value:(n=w()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.config.noteId,e.next=3,this.service.getSteps(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"sendTelepointer",value:(t=w()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.config.noteId,e.next=3,this.service.pushTelepointer(n,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"on",value:function(e,t){return this.eventEmitter.on(e,t),this}},{key:"off",value:function(e,t){return this.eventEmitter.off(e,t),this}},{key:"emit",value:function(e,t){return this.eventEmitter.emit(e,t),this}}]),e}(),mt=n("mwIZ"),vt=n.n(mt),bt=n("sEfC"),gt=n.n(bt),yt=new ut.a,_t=yt.encode.bind(yt);yt.encode=function(e){var t=_t(e);return 0===t.content.length&&0!=e.content.length?{content:[{type:"paragraph",content:[]}],type:"doc"}:t};var wt=function(){function e(t,n){var a=this;We()(this,e),ot()(this,"processRemoteData",function(e){var t=e.version,n=e.steps;if(n&&n.length){var r=n.map(function(e){return e.sessionId||a.serviceClient.getUserId(e.sessionId)});a.emit("data",{json:n,version:t,userIds:r})}else console.warn("Collab.Provider: processRemoteData no steps ? ",n,e)}),ot()(this,"onReceiveData",function(e){a.queueData(e),a.processQueue()}),ot()(this,"onReceiveTelepointer",function(e){var t=e.sessionId,n=a.serviceClient.getUserId(t);if(n!==a.config.userId){var r=a.participants.get(n);r&&r.lastActive>e.timestamp||(a.updateParticipant(t,e.timestamp),a.emit("telepointer",e))}}),this.config=ne()({},t),this.config.sessionId=n.getSessionId(),this.config.userId=n.getUserId(),this.cancelLocalChanges=gt()(this.cancelLocalChanges.bind(this),100),this.setReadOnly(!!this.config.readOnly),this.serviceClient=n,this.channel=t.channel||new ht(this.config,n),this.eventEmitter=new ct.EventEmitter2,this.queue=[],this.getState=function(){},this.participants=new Map,this.pauseQueue=!1,this.initialVersion=t.version,this.initialDate=t.updatedAt||new Date,this.pauseQueue=!1}var t;return Ze()(e,[{key:"initialize",value:function(e){var t=this;this.getState=e,this.channel.on("connected",function(e){var n=e.doc,a=e.version,r=e.updatedAt,i=t.config.sessionId;t.emit("init",{sid:i,doc:n,version:a}),t.emit("connected",{sid:i}),t.listenStateEvents({lastRemoteSync:r})}),this.channel.on("data",this.onReceiveData),this.channel.on("telepointer",this.onReceiveTelepointer),this.channel.on("needcatchup",function(){return t.catchup()});var n=e(),a=yt.encode(n.doc),r=void 0!==this.initialVersion?this.initialVersion:a.version,i=ne()({},a,{version:r});return this.channel.connect({version:r,doc:i,updatedAt:this.initialDate}),this}},{key:"send",value:function(e,t,n){e.steps&&e.steps.length&&(this.isReadOnly()?this.cancelLocalChanges():this.channel.sendSteps(this.getState,n))}},{key:"sendMessage",value:function(e){if(e&&!this.isReadOnly())switch(e.type){case"telepointer":this.channel.sendTelepointer(ne()({},e,{timestamp:(new Date).getTime()}))}}},{key:"queueData",value:function(e){var t=[].concat(it()(this.queue),[e]).sort(function(e,t){var n=e.version-e.steps.length,a=t.version-t.steps.length;return n>a?1:n<a?-1:e.version>t.version?-1:e.version<t.version?1:0});this.queue=t}},{key:"catchup",value:(t=w()(y.a.mark(function e(){var t,n,a,r,i,s,o,c,l;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.pauseQueue=!0,t=Object(lt.getVersion)(this.getState()),e.prev=2,e.next=5,this.channel.getSteps(t);case 5:n=e.sent,a=n.doc,r=n.version,i=n.steps,a?(s=this.config.sessionId,o=Object(lt.sendableSteps)(this.getState())||{},c=o.steps,l=void 0===c?[]:c,this.emit("init",{sid:s,doc:a,version:r}),l.length&&!this.isReadOnly()&&this.emit("local-steps",{steps:l})):i.length>0&&this.onReceiveData({steps:i,version:r},!0),this.queueTimeout=void 0,this.pauseQueue=!1,this.processQueue(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),this.pauseQueue=!1,this.programCatchup();case 19:case"end":return e.stop()}},e,this,[[2,15]])})),function(){return t.apply(this,arguments)})},{key:"programCatchup",value:function(){var e=this;this.queueTimeout||(this.queueTimeout=window.setTimeout(function(){e.catchup()},1e3))}},{key:"cancelCatchup",value:function(){this.queueTimeout&&(window.clearTimeout(this.queueTimeout),this.queueTimeout=void 0)}},{key:"processQueue",value:function(){if(this.queue.length>0&&!this.pauseQueue)for(var e=Object(lt.getVersion)(this.getState());this.queue.length>0;){var t=this.queue[0],n=t.version,a=t.steps.length+e;if(n==a)this.cancelCatchup(),this.queue.shift(),this.processRemoteData(t),e=n;else if(n<=a&&this.queue.shift(),n>a){this.programCatchup();break}}}},{key:"updateParticipant",value:function(e,t){var n=this,a=this.serviceClient.getUserId(e),r=function(e){var t=e.userId,n=e.sessionId;return{userId:n,sessionId:n||t,name:t,avatar:null,email:null}}({userId:a,sessionId:e});this.participants.set(a,ne()({name:"",email:"",avatar:"",sessionId:e,userId:a},r,{lastActive:t}));var i=[this.participants.get(a)],s=(new Date).getTime(),o=Array.from(this.participants.values()).filter(function(e){return(s-e.lastActive)/1e3>300});o.forEach(function(e){return n.participants.delete(e.userId)}),this.emit("presence",{joined:i,left:o})}},{key:"emit",value:function(e,t){return this.eventEmitter.emit(e,t),this}},{key:"on",value:function(e,t){return this.eventEmitter.on(e,t),this}},{key:"off",value:function(e,t){return this.eventEmitter.off(e,t),this}},{key:"unsubscribeAll",value:function(e){this.eventEmitter.removeAllListeners(e)}},{key:"isDirty",value:function(){return!!this.dirtySince}},{key:"getDirtySince",value:function(){return this.dirtySince}},{key:"getLastLocalSave",value:function(){return this.lastLocalSave}},{key:"getLastRemoteSync",value:function(){return this.lastRemoteSync}},{key:"getLastSaveOrSync",value:function(){return this.lastLocalSave>this.lastRemoteSync?this.lastLocalSave:this.lastRemoteSync}},{key:"onLocalSave",value:function(){this.lastLocalSave=new Date,this.emit("collab-state-change")}},{key:"onRemoteSync",value:function(){this.lastRemoteSync=new Date,this.emit("collab-state-change")}},{key:"onChannelEmptyQueue",value:function(){this.dirtySince=void 0,this.emit("collab-state-change")}},{key:"onChannelEnqueue",value:function(){this.dirtySince||(this.dirtySince=new Date,this.emit("collab-state-change"))}},{key:"listenStateEvents",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).lastRemoteSync;this.channel.on("emptyQueue",this.onChannelEmptyQueue.bind(this)),this.channel.on("enqueueSteps",this.onChannelEnqueue.bind(this)),this.channel.on("successfulPatch",this.onLocalSave.bind(this)),this.on("data",this.onRemoteSync.bind(this)),this.on("init",this.onRemoteSync.bind(this)),e&&(this.lastRemoteSync=e)}},{key:"isReadOnly",value:function(){return this.readOnly}},{key:"setReadOnly",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.readOnly=!!e,this.readOnly&&this.cancelLocalChanges()}},{key:"cancelLocalChanges",value:function(){var e=this.getState&&this.getState();if(e){var t=vt()(e,"collab$.unconfirmed[0].origin.docs[0]"),n=vt()(e,"collab$.version"),a=this.config.sessionId;if(t&&n&&a){var r=t.toJSON();this.emit("init",{doc:r,version:n,sid:a})}}}}]),e}();var xt=function(e){var t=e.doc,n=e.noteId,a=e.serviceClient;return Object(i.useMemo)(function(){var e=t&&t.version,r=t&&t.updatedAt;if(a&&void 0!==t)return new wt({version:e,noteId:n,updatedAt:r},a)},[n,t,a])};var jt=function(e){var t=e.noteId,n=e.title,a=e.setTitle,r=e.serviceClient,s=Object(i.useCallback)(r?function(e){var i=e.target.value.replace(/[\r\t\n\xa0]+/g," ");n!=i&&(a(i),r.setTitle(t,i))}:function(){},[t,n,a,r]);Object(i.useEffect)(function(){r&&r.onTitleUpdated(t,function(e){n!=e&&a(e)})},[n,a,r,t]);var o=Object(i.useMemo)(O.d,[]);return Object(i.useEffect)(function(){document.title=n&&""!=n?"".concat(n," - ").concat(o):o},[o,n]),{onLocalTitleChange:s}};var kt=function(e){var t=e.doc,n=e.collabProvider,a=t&&t.file.id,r=n&&n.serviceClient,s=n&&n.channel;return{forceSync:Object(i.useCallback)((o=w()(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&s&&r)){e.next=5;break}return e.next=3,s.ensureEmptyQueue();case 3:return e.next=5,r.sync(a);case 5:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),[t,s,r,a]),emergencySync:Object(i.useCallback)(function(){a&&r&&r.sync(a)},[a,r])};var o};var Et=function(e){var t=e.returnUrl,n=e.cozyClient,a=e.doc,r=Object(i.useContext)(Ke.a);return Object(i.useMemo)(function(){return void 0!==t?t:a?Object(O.g)(n,a.file):r?void 0:"/"},[t,a,r,n])};var Ot=function(e){var t=e.userName,n=e.cozyClient,a=Object(i.useContext)(Ke.a),r=Object(i.useMemo)(function(){return t||Object(O.k)()||(a?"?":Object(O.j)(n))},[n,t]);return{userId:r,userName:r}},Ct=n("5ViJ");function St(e){var t=Object(d.useClient)(),n=e.noteId,a=e.readOnly,r=Object(c.e)().t,o=Object(i.useRef)(),l=Object(i.useContext)(Ke.a),u=Ot({userName:e.userName,cozyClient:t}),f=u.userName,p=u.userId,h=at({userId:p,userName:f,cozyClient:t}),m=et({serviceClient:h,noteId:n}),v=m.loading,b=m.title,g=m.doc,y=m.setTitle,_=Et({returnUrl:e.returnUrl,cozyClient:t,doc:g}),w=xt({noteId:n,serviceClient:h,doc:g}),x=jt({noteId:n,title:b,setTitle:y,serviceClient:h}).onLocalTitleChange,j=kt({doc:g,collabProvider:w}),k=j.forceSync,E=j.emergencySync;Object(i.useEffect)(function(){return k},[n,g,k]);var O=Object(i.useCallback)(function(){return w.isDirty()},[w]),C=Object(Ct.a)({activate:O,onLeave:E,title:r("Notes.Editor.exit_confirmation_title"),message:r("Notes.Editor.exit_confirmation_message"),leaveLabel:r("Notes.Editor.exit_confirmation_leave"),cancelLabel:r("Notes.Editor.exit_confirmation_cancel")}),S=C.exitConfirmationModal,N=C.requestToLeave;return Object(pt.b)("client",t),Object(pt.b)("notes.service",h),Object(pt.b)("notes.collabProvider",w),Object(pt.b)("notes.channel",w&&w.channel),Object(pt.b)("notes.noteId",n),Object(pt.b)("notes.doc",g&&ne()({},g.doc,{version:g.version})),Object(pt.b)("notes.file",g&&g.file),Object(pt.b)("notes.returnUrl",_),v?s.a.createElement(xe,null):g?s.a.createElement(s.a.Fragment,null,s.a.createElement(he,{bannerRef:o,readOnly:a,onTitleChange:x,onTitleBlur:E,collabProvider:w,defaultTitle:r("Notes.Editor.title_placeholder"),defaultValue:ne()({},g.doc,{version:g.version}),title:b&&b.length>0?b:void 0,leftComponent:s.a.createElement($e,{returnUrl:_,file:g.file,requestToLeave:N}),rightComponent:s.a.createElement(we,{doc:g,isPublic:l,isReadOnly:a})}),s.a.createElement(Je,{collabProvider:w,bannerRef:o}),S):s.a.createElement(je,{returnUrl:_})}St.propTypes={noteId:re.a.string.isRequired,readOnly:re.a.bool.isRequired,userName:re.a.string,returnUrl:re.a.string};var Nt=Object(c.d)()(function(e){var t=e.t;return s.a.createElement(b.a,{icon:"unlink",title:t("Error.unshared_title"),text:t("Error.unshared_text")})});n.d(t,"b",function(){return ee}),n.d(t,"a",function(){return St}),n.d(t,"c",function(){return Nt})},hmtS:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n("byeC"),r=[["doc",{content:"(block)+",marks:"link"}],["paragraph",{content:"inline*",group:"block",marks:"strong code em link strike subsup textColor typeAheadQuery underline",parseDOM:[{tag:"p"}]}],["text",{group:"inline"}],["bulletList",{group:"block",content:"listItem+",parseDOM:[{tag:"ul"}]}],["orderedList",{group:"block",content:"listItem+",parseDOM:[{tag:"ol"}]}],["listItem",{content:"(paragraph ) (paragraph | bulletList | orderedList )*",defining:!0,parseDOM:[{tag:"li"}]}],["heading",{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}]}],["blockquote",{content:"paragraph+",group:"block",defining:!0,selectable:!1,parseDOM:[{tag:"blockquote"}]}],["rule",{group:"block",parseDOM:[{tag:"hr"}]}],["panel",{group:"block",content:"(paragraph | heading | bulletList | orderedList)+",attrs:{panelType:{default:"info"}},parseDOM:[{tag:"div[data-panel-type]"}]}],["confluenceUnsupportedBlock",{group:"block",attrs:{cxhtml:{default:null}},parseDOM:[{tag:'div[data-node-type="confluenceUnsupportedBlock"]'}]}],["confluenceUnsupportedInline",{group:"inline",inline:!0,atom:!0,attrs:{cxhtml:{default:null}},parseDOM:[{tag:'div[data-node-type="confluenceUnsupportedInline"]'}]}],["unsupportedBlock",{inline:!1,group:"block",atom:!0,selectable:!0,attrs:{originalValue:{default:{}}},parseDOM:[{tag:'[data-node-type="unsupportedBlock"]'}]}],["unsupportedInline",{inline:!0,group:"inline",selectable:!0,attrs:{originalValue:{default:{}}},parseDOM:[{tag:'[data-node-type="unsupportedInline"]'}]}],["hardBreak",{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}]}],["table",{content:"tableRow+",attrs:{isNumberColumnEnabled:{default:!1},layout:{default:"default"},__autoSize:{default:!1}},tableRole:"table",isolating:!0,selectable:!1,group:"block",parseDOM:[{tag:"table"}]}],["tableHeader",{content:"(paragraph | panel | blockquote | orderedList | bulletList | rule | heading )+",attrs:{colspan:{default:1},rowspan:{default:1},colwidth:{default:null},background:{default:null}},tableRole:"header_cell",isolating:!0,marks:"",parseDOM:[{tag:"th"}]}],["tableRow",{content:"(tableCell | tableHeader)+",tableRole:"row",parseDOM:[{tag:"tr"}]}],["tableCell",{content:"(paragraph | panel | blockquote | orderedList | bulletList | rule | heading | unsupportedBlock)+",attrs:{colspan:{default:1},rowspan:{default:1},colwidth:{default:null},background:{default:null}},tableRole:"cell",marks:"",isolating:!0,parseDOM:[{tag:".ak-renderer-table-number-column",ignore:!0},{tag:"td"}]}]],i=[["link",{excludes:"color",group:"link",attrs:{href:{},__confluenceMetadata:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]"}]}],["em",{inclusive:!0,group:"fontStyle",parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}]}],["strong",{inclusive:!0,group:"fontStyle",parseDOM:[{tag:"strong"},{tag:"b"},{style:"font-weight"}]}],["textColor",{attrs:{color:{}},inclusive:!0,group:"color",parseDOM:[{style:"color"}]}],["strike",{inclusive:!0,group:"fontStyle",parseDOM:[{tag:"strike"},{tag:"s"},{tag:"del"},{style:"text-decoration"}]}],["subsup",{inclusive:!0,group:"fontStyle",attrs:{type:{default:"sub"}},parseDOM:[{tag:"sub",attrs:{type:"sub"}},{tag:"sup",attrs:{type:"sup"}}]}],["underline",{inclusive:!0,group:"fontStyle",parseDOM:[{tag:"u"},{style:"text-decoration"}]}],["code",{excludes:"fontStyle link searchQuery color",inclusive:!0,parseDOM:[{tag:"span.code",preserveWhitespace:!0},{tag:"code",preserveWhitespace:!0},{tag:"tt",preserveWhitespace:!0},{tag:"span",preserveWhitespace:!0}]}],["typeAheadQuery",{excludes:"searchQuery",inclusive:!0,group:"searchQuery",parseDOM:[{tag:"span[data-type-ahead-query]"}],attrs:{trigger:{default:""}}}]];function s(e){return e.reduce(function(e,t){return e[t[0]]=t[1],e},{})}var o={nodes:r,marks:i},c={nodes:s(r),marks:s(i)};new a.Schema(c)},nw0P:function(e,t,n){var a={"./_lib/build_formatting_tokens_reg_exp/index.js":"kOWh","./ar/build_distance_in_words_locale/index.js":"XxX6","./ar/build_format_locale/index.js":"alis","./ar/index.js":"EDRf","./be/build_distance_in_words_locale/index.js":"LQ09","./be/build_format_locale/index.js":"kj7F","./be/index.js":"YEhR","./bg/build_distance_in_words_locale/index.js":"7K3h","./bg/build_format_locale/index.js":"RrdL","./bg/index.js":"isx8","./ca/build_distance_in_words_locale/index.js":"wqqj","./ca/build_format_locale/index.js":"qcV0","./ca/index.js":"Vwa+","./cs/build_distance_in_words_locale/index.js":"ZKDM","./cs/build_format_locale/index.js":"ipyF","./cs/index.js":"dvhP","./da/build_distance_in_words_locale/index.js":"2Mgc","./da/build_format_locale/index.js":"Gned","./da/index.js":"7ur/","./de/build_distance_in_words_locale/index.js":"5IWf","./de/build_format_locale/index.js":"THCn","./de/index.js":"bgw5","./el/build_distance_in_words_locale/index.js":"o/GB","./el/build_format_locale/index.js":"8T9h","./el/index.js":"dH0v","./en/build_distance_in_words_locale/index.js":"LZbM","./en/build_format_locale/index.js":"6DAA","./en/index.js":"Us+F","./eo/build_distance_in_words_locale/index.js":"qrnn","./eo/build_format_locale/index.js":"Bl15","./eo/index.js":"UB7v","./es/build_distance_in_words_locale/index.js":"GEfZ","./es/build_format_locale/index.js":"O+zC","./es/index.js":"/S0t","./fi/build_distance_in_words_locale/index.js":"VHtQ","./fi/build_format_locale/index.js":"Oydx","./fi/index.js":"ndVD","./fil/build_distance_in_words_locale/index.js":"uq4p","./fil/build_format_locale/index.js":"d7hw","./fil/index.js":"pNfm","./fr/build_distance_in_words_locale/index.js":"IzMR","./fr/build_format_locale/index.js":"I3Zg","./fr/index.js":"LKA2","./hr/build_distance_in_words_locale/index.js":"DPvn","./hr/build_format_locale/index.js":"puw3","./hr/index.js":"L9Jq","./hu/build_distance_in_words_locale/index.js":"w2RQ","./hu/build_format_locale/index.js":"/0iD","./hu/index.js":"Nm+E","./id/build_distance_in_words_locale/index.js":"JbvB","./id/build_format_locale/index.js":"0wlw","./id/index.js":"A6C3","./is/build_distance_in_words_locale/index.js":"qzMC","./is/build_format_locale/index.js":"S3yD","./is/index.js":"N4bE","./it/build_distance_in_words_locale/index.js":"MDEp","./it/build_format_locale/index.js":"aUJd","./it/index.js":"hmb4","./ja/build_distance_in_words_locale/index.js":"nNvt","./ja/build_format_locale/index.js":"buui","./ja/index.js":"uAXs","./ko/build_distance_in_words_locale/index.js":"oEw+","./ko/build_format_locale/index.js":"9SQf","./ko/index.js":"iW8+","./mk/build_distance_in_words_locale/index.js":"nmwZ","./mk/build_format_locale/index.js":"htxJ","./mk/index.js":"GzBU","./nb/build_distance_in_words_locale/index.js":"SL1f","./nb/build_format_locale/index.js":"CJ5F","./nb/index.js":"73vv","./nl/build_distance_in_words_locale/index.js":"Uyu0","./nl/build_format_locale/index.js":"doCD","./nl/index.js":"hCQt","./pl/build_distance_in_words_locale/index.js":"FUBD","./pl/build_format_locale/index.js":"nOYf","./pl/index.js":"B6yL","./pt/build_distance_in_words_locale/index.js":"aTPA","./pt/build_format_locale/index.js":"TTT0","./pt/index.js":"gdks","./ro/build_distance_in_words_locale/index.js":"gI+A","./ro/build_format_locale/index.js":"njjO","./ro/index.js":"r2yp","./ru/build_distance_in_words_locale/index.js":"KmPx","./ru/build_format_locale/index.js":"UUBw","./ru/index.js":"nz/o","./sk/build_distance_in_words_locale/index.js":"q2Bs","./sk/build_format_locale/index.js":"9sxn","./sk/index.js":"Wqan","./sl/build_distance_in_words_locale/index.js":"mlv2","./sl/build_format_locale/index.js":"vHkZ","./sl/index.js":"KYSo","./sr/build_distance_in_words_locale/index.js":"LlkS","./sr/build_format_locale/index.js":"RhjJ","./sr/index.js":"7mU3","./sv/build_distance_in_words_locale/index.js":"UNBN","./sv/build_format_locale/index.js":"zTNB","./sv/index.js":"hxgj","./th/build_distance_in_words_locale/index.js":"XAGa","./th/build_format_locale/index.js":"We2s","./th/index.js":"Pk+z","./tr/build_distance_in_words_locale/index.js":"aFZF","./tr/build_format_locale/index.js":"jh7A","./tr/index.js":"3ZWG","./zh_cn/build_distance_in_words_locale/index.js":"KdB7","./zh_cn/build_format_locale/index.js":"l4EP","./zh_cn/index.js":"8tMq","./zh_tw/build_distance_in_words_locale/index.js":"vyyr","./zh_tw/build_format_locale/index.js":"uYH7","./zh_tw/index.js":"QPlQ"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="nw0P"},pL5B:function(e,t,n){"use strict";n.r(t),function(e){var a=n("o0o1"),r=n.n(a),i=n("yXPU"),s=n.n(i),o=n("J4zp"),c=n.n(o),l=n("q1tI"),u=n.n(l),d=n("0cfB"),f=n("Ty5D"),p=n("55Ip"),h=n("SH7X"),m=n("67rm"),v=n("jDpt"),b=n("le8I"),g=n("V2U0"),y=n("vYzF"),_=n("1I/2"),w=n("Zlyp"),x=n("snnE"),j=n("/RjM"),k=n("X3v2"),E=n("pZg0"),O=Object(f.f)(function(e){var t=Object(x.h)();return u.a.createElement(w.a,{noteId:e.match.params.id,returnUrl:t})}),C=function(){return u.a.createElement(f.c,null,u.a.createElement(f.a,{path:"/n/:id",component:O}),u.a.createElement(f.a,{path:"/",component:w.b}))},S=function(){var e=Object(h.useClient)(),t=Object(l.useState)(null),n=c()(t,2),a=n[0],i=n[1],o=Object(l.useState)(!1),d=c()(o,2),f=d[0],p=d[1],m=Object(l.useMemo)(function(){return Object(x.h)()},[]);return Object(l.useEffect)(function(){(function(){var t=s()(r.a.mark(function t(){var n,a,s,o,c,l;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(n=new URLSearchParams(window.location.search)).has("id")){t.next=11;break}return a=n.get("id"),t.next=6,Object(x.b)(e,a);case 6:s=t.sent,p(s),i(a),t.next=18;break;case 11:return t.next=13,Object(x.i)(e);case 13:o=t.sent,c=o.id,l=o.readOnly,p(l),i(c);case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),i(!1);case 23:case"end":return t.stop()}},t,this,[[0,20]])}));return function(){return t.apply(this,arguments)}})()()},[e]),a?u.a.createElement(w.a,{readOnly:f,noteId:a,returnUrl:m||!1}):null!==a?u.a.createElement(w.c,null):u.a.createElement(g.a,{size:"xxlarge",middle:!0})};t.default=Object(d.hot)(e)(function(e){var t=e.isPublic,n=Object(h.useClient)(),a=_.b.isMobile,r=Object(h.useClientErrors)().ClientErrors,i="";if(a){var s=n.getInstanceOptions();i=Object(k.a)(s.cozyAppName,E.name)}var o=cozy.bar.BarCenter,c=Object(j.c)();return u.a.createElement(_.a,null,u.a.createElement(p.a,null,u.a.createElement(v.b,{monoColumn:!0},!t&&a&&u.a.createElement(o,null,u.a.createElement(y.a,null,i)),u.a.createElement(v.c,null,u.a.createElement(v.a,null,t?u.a.createElement(S,null):u.a.createElement(C,null))),u.a.createElement(b.a,null),u.a.createElement(m.a,null),u.a.createElement(c,null))),u.a.createElement(r,null))})}.call(this,n("3UD+")(e))},pZg0:function(e,t){e.exports={name:"Notes",name_prefix:"Cozy",slug:"notes",icon:"icon.svg",categories:["cozy"],version:"1.12.0",licence:"AGPL-3.0",editor:"Cozy",source:"https://github.com/cozy/cozy-notes.git@build",developer:{name:"Cozy Cloud",url:"https://cozy.io"},screenshots:["screenshots/fr/screenshot01.png","screenshots/fr/screenshot02.png"],langs:["en","fr"],routes:{"/":{folder:"/",index:"index.html",public:!1},"/public":{folder:"/",index:"index.html",public:!0}},permissions:{apps:{description:"Required by the cozy-bar to display the icons of the apps",type:"io.cozy.apps",verbs:["GET"]},files:{description:"Notes as files",type:"io.cozy.files"},settings:{description:"Required by the cozy-bar to display Claudy and know which applications are coming soon",type:"io.cozy.settings",verbs:["GET"]}}}},snnE:function(e,t,n){"use strict";n.d(t,"j",function(){return b}),n.d(t,"h",function(){return y}),n.d(t,"c",function(){return _}),n.d(t,"b",function(){return O}),n.d(t,"i",function(){return S}),n.d(t,"f",function(){return z}),n.d(t,"e",function(){return M}),n.d(t,"g",function(){return D}),n.d(t,"d",function(){return I}),n.d(t,"a",function(){return R}),n.d(t,"l",function(){return L}),n.d(t,"k",function(){return U});var a=n("o0o1"),r=n.n(a),i=n("yXPU"),s=n.n(i),o=n("J4zp"),c=n.n(o),l=n("mwIZ"),u=n.n(l),d=n("AHTZ"),f=n("X3v2"),p=n("hmtS"),h=n("SH7X"),m=n("pZg0"),v=n.n(m);function b(e){return new URL(e.getStackClient().uri).hostname+Math.floor(100*Math.random())}var g="returnUrl";function y(){var e=new URLSearchParams(window.location.search),t=!0,n=!1,a=void 0;try{for(var r,i=e[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var s=c()(r.value,2),o=s[0],l=s[1];if(o===g)return l}}catch(u){n=!0,a=u}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}function _(e,t){return w.apply(this,arguments)}function w(){return(w=s()(r.a.mark(function e(t,n){var a,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.models.note.fetchURL(t,n),i=window.location.toString(),e.t0=URL,e.next=5,a;case 5:return e.t1=e.sent,(s=new e.t0(e.t1)).searchParams.set(g,i),e.abrupt("return",s.toString());case 9:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function x(e){return j.apply(this,arguments)}function j(){return(j=s()(r.a.mark(function e(t){var n,a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.collection("io.cozy.permissions").getOwnPermissions();case 2:if(n=e.sent,a=u()(n,"data.attributes.permissions")){e.next=6;break}throw"can't get self permissions";case 6:return i=Object.values(a),e.abrupt("return",i.filter(function(e){return h.models.permission.isForType(e,"io.cozy.files")}));case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function k(e,t){return E.apply(this,arguments)}function E(){return(E=s()(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.query(t.find("io.cozy.files").getById(n)).then(function(e){return e&&e.data}));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function O(e,t){return C.apply(this,arguments)}function C(){return(C=s()(r.a.mark(function e(t,n){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t,n);case 2:return a=e.sent,e.abrupt("return",h.models.permission.isDocumentReadOnly({document:a,client:t,writability:["PATCH"]}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function S(e){return N.apply(this,arguments)}function N(){return(N=s()(r.a.mark(function e(t){var n,a,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:if(e.t0=function(e){return h.models.permission.isForType(e,"io.cozy.files")&&e.values&&e.values.length>0},!((n=e.sent.filter(e.t0)).length<1)){e.next=8;break}throw new Error("No individual io.cozy.files permissions in current context");case 8:(n.length>1||n[0].values.length>1)&&console.warn("There are more than one permission for a file in current context. Let's take the first one, but it may not be the one you expect");case 9:return a=n[0],i=a.values[0],s=h.models.permission.isReadOnly(a,{writability:["PATCH"]}),e.abrupt("return",{id:i,readOnly:s});case 13:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function z(e){return"/folder/".concat(e)}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=new URL(e.getStackClient().uri),a=e.getInstanceOptions().cozySubdomainType,r=null!==t?z(t):"";return Object(d.b)({cozyUrl:n.origin,slug:"drive",subDomainType:a,nativePath:r})}function D(e,t){return M(e,h.models.file.getParentFolderId(t))}function I(){var e=Object(f.b)(),t=Object(f.a)(e.cozyAppNamePrefix||v.a.name_prefix,""),n=Object(f.a)(e.cozyAppName,v.a.name);return""!=t?"".concat(t," ").concat(n):n}function R(e){return e.getStackClient().fetchJSON("POST","/notes",{data:{type:"io.cozy.notes.documents",attributes:{title:"",schema:p.a}}})}var P=864e5,T=[[1e4,"just_now",1e3,1],[6e4,"secs_ago",1e3,10],[12e4,"min_ago",6e4,1],[3e5,"mins_ago",6e4,1],[12e5,"mins_ago",6e4,5],[36e5,"mins_ago",6e4,10],[72e5,"hour_ago",36e5,1],[864e5,"hours_ago",36e5,1],[2*P,"day_ago",P,1],[26784e5,"days_ago",P,1],[53568e5,"month_ago",26784e5,1],[31536e6,"monthes_ago",26784e5,1],[63072e6,"year_ago",31536e6,1],[1/0,"years_ago",31536e6,1]];function L(e,t){var n=(t||T).find(function(t){return e<t[0]}),a=c()(n,4),r=a[1],i=a[2],s=a[3];return{key:r,unit:i,coef:s,time:Math.floor(e/i/s)*s,interval:i*s}}function U(){var e=new URLSearchParams(window.location.search);return e.has("username")?e.get("username"):null}},yWSb:function(e,t,n){e.exports={grid:"grid--1HNmF",banner:"banner--MWCHK",chip:"chip--3hU4-"}}});