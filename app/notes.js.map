{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/header_menu.jsx","webpack:///./src/locales sync ^\\.\\/.*$","webpack:///./src/lib/debug.jsx","webpack:///../locale-data/index.js (ignored)","webpack:///./lib/locales (ignored)","webpack:///./src/components/notes/List/NoteRow.jsx","webpack:///./lib/locales (ignored)?2b4e","webpack:///zlib (ignored)","webpack:///fs (ignored)","webpack:///http (ignored)","webpack:///https (ignored)","webpack:///./src/components/notes/saving-indicator.styl","webpack:///./src/components/notes/sharing.jsx","webpack:///./src/components/notes/editor-view.jsx","webpack:///./src/hooks/useServiceClient.js","webpack:///./src/lib/collab/participant.js","webpack:///./src/lib/collab/channel.js","webpack:///./src/lib/collab/provider.js","webpack:///./src/hooks/useNote.js","webpack:///./src/components/IsPublicContext.jsx","webpack:///./src/components/notes/List/index.jsx","webpack:///./src/assets/icons/icon-note-32.svg","webpack:///./src/targets/browser/index.jsx","webpack:///./src/components/notes/editor.jsx","webpack:///./src/components/notes/add.jsx","webpack:///./src/components/notes/List/AppTitle.jsx","webpack:///./src/components/notes/editor-view.styl","webpack:///./src/components/notes/sharing.styl","webpack:///./src/components/notes/List/list.styl","webpack:///./src/components/notes/editor-loading.jsx","webpack:///./src/styles/index.css","webpack:///./src/lib/initFromDom.js","webpack:///./src/components/notes/editor-loading-error.jsx","webpack:///./src/targets/vendor/assets/icon.svg","webpack:///./src/components/notes/index.jsx","webpack:///./src/hooks/useUser.js","webpack:///./src/components/notes/saving-indicator.jsx","webpack:///./src/lib/collab/stack-client.js","webpack:///./src/hooks/useReferencedFolderForNote.jsx","webpack:///./src/hooks/useCollabProvider.js","webpack:///./src/lib/collab/schema.js","webpack:///./src/components/notes/unshared.jsx","webpack:///./src/hooks/useReturnUrl.js","webpack:///./src/components/notes/List/EmptyComponent.jsx","webpack:///./src/hooks/useTitleChanges.js","webpack:///./src/components/notes/editor_config.js","webpack:///./src/components/notes/back_from_editing.jsx","webpack:///./src/hooks/useForceSync.js","webpack:///./node_modules/date-fns/locale sync ^\\.\\/.*\\/index\\.js$","webpack:///./src/components/notes/offline-indicator.jsx","webpack:///./src/hooks/useFileWithPath.js","webpack:///./src/components/app.jsx","webpack:///./manifest.webapp","webpack:///./src/lib/utils.js","webpack:///./src/assets/icons/icon_note_empty.svg","webpack:///./src/components/notes/List/List.jsx","webpack:///./src/components/notes/offline-indicator.styl"],"names":["HeaderMenu","props","className","left","children","right","useDebugValue","name","value","activated","useFlag","useEffect","setDebugValue","useFlagSwitcher","FlagSwitcher","set","window","flag","Promise","resolve","setTimeout","collabProvider","get","channel","data","date","Date","toISOString","noteId","initialVersion","returnUrl","state","getState","version","getVersion","sendableSteps","steps","length","backoff","failures","isDirty","isSending","hasQueue","hasQueuedSteps","queued","queuedStep","queuedState","queuedVersion","queuedSteps","localSteps","queue","dirtySince","lastRemoteSync","getLastRemoteSync","lastLocalSave","getLastLocalSave","collabState","serviceClient","realtime","websocket","retryManager","hasRealtime","started","isStarted","hasWebsocket","hasWebSocket","isOpen","isWebSocketOpen","readyState","bufferedAmount","url","retries","wait","client","token","stackClient","credentials","getCredentials","authorization","getAuthorizationHeader","uri","error","resetBackoff","processQueue","race","fn","err","msg","message","JSON","parse","e","lastPatchError","status","debugCollab","NoteRow","note","f","t","CozyFile","splitFilename","filename","extension","useBreakpoints","isMobile","useState","isMenuOpen","setMenuOpen","openMenu","useCallback","stopPropagation","closeMenu","deleteNote","destroy","Alerter","info","menuTriggerRef","React","createRef","styles","tableRow","location","href","generateReturnUrlToNotesIndex","tableCellName","NoteIcon","tableCell","updated_at","time","_id","translate","withClient","withLocales","SharingWidget","file","useFileWithPath","cozyClient","id","showModal","setShowModal","onClick","onClose","updateTextareaHeight","target","style","height","scrollHeight","nullCallback","EditorView","defaultValue","onTitleChange","onTitleBlur","defaultTitle","title","leftComponent","rightComponent","onContentChange","readOnly","bannerRef","useI18n","titleEl","useRef","onTitleEvent","useMemo","setReadOnly","collabEdit","useNativePlugin","provider","inviteToEditHandler","undefined","isInviteToEditButtonSelected","userId","getSessionId","current","useEventListener","editorConfig","banner","titleInput","useServiceClient","userName","ServiceClient","getParticipant","sessionId","avatar","email","minimumBackoff","maximumBackoff","failuresBeforeCatchup","Channel","config","service","eventEmitter","EventEmitter2","initializeStepsQueue","emit","Math","max","min","onEmptyQueue","off","on","enqueueSteps","afterBackoff","dequeueSteps","pushSteps","response","rebaseStepsInQueue","increaseBackoff","doc","updatedAt","join","onStepsCreated","onTelepointerUpdated","payload","getSteps","pushTelepointer","evt","handler","jsonTransformer","JSONTransformer","oldEncode","encode","bind","transformed","content","type","CollabProvider","userIds","map","step","getUserId","json","console","warn","queueData","participant","participants","lastActive","timestamp","updateParticipant","cancelLocalChanges","debounce","Map","pauseQueue","initialDate","sid","listenStateEvents","onReceiveData","onReceiveTelepointer","catchup","usableVersion","collabDoc","connect","tr","oldState","newState","isReadOnly","sendSteps","sendTelepointer","getTime","orderedQueue","sort","a","b","aStart","bStart","currentVersion","queueTimeout","programCatchup","clearTimeout","first","firstVersion","expectedVersion","cancelCatchup","shift","processRemoteData","joined","now","Array","from","values","filter","p","forEach","delete","removeAllListeners","onChannelEmptyQueue","onChannelEnqueue","onLocalSave","onRemoteSync","currentState","rawDoc","toJSON","useNote","docId","setDocId","loading","setLoading","setDoc","setTitle","loadNote","getDoc","IsPublicContext","createContext","shouldDisplayAddButton","fetchStatus","notes","ListView","breakpoints","BarRight","cozy","bar","Q","appHeader","withBreakpoints","manifest","require","appLocale","locales","en","react","atlaskit","default","fr","addLocaleData","renderApp","isPublic","App","render","document","querySelector","addEventListener","getDataset","appIcon","getDataOrDefault","cozyIconPath","appNamePrefix","cozyAppNamePrefix","name_prefix","appName","cozyAppName","appSlug","cozyAppSlug","slug","appVersion","cozyAppVersion","cozyLocale","protocol","shareCode","getPublicSharecode","cozyToken","CozyClient","cozyDomain","appMetadata","Document","registerClient","ReactDOM","init","iconPath","lang","replaceTitleOnMobile","Editor","useContext","useUser","useReturnUrl","useCollabProvider","useTitleChanges","onLocalTitleChange","useForceSync","forceSync","emergencySync","activate","useConfirmExit","onLeave","leaveLabel","cancelLabel","exitConfirmationModal","requestToLeave","Add","isWorking","setIsWorking","handleClick","createNoteDocument","AddMobile","AppTitle","ConnectedAppTitle","EditorLoading","root","dataset","toTest","defaultData","templateRegex","test","search","URLSearchParams","EditorLoadingError","__html","providedUserName","getUserNameFromUrl","getShortNameFromClient","sec","keepOfflineOpenFor","outOfSyncAfter","SavingIndicator","setLastChange","offlineSince","setOfflineSince","navigator","onLine","isNavigatorOffline","setIsNavigatorOffline","setNavigatorOffline","setNavigatorOnline","getDirtySince","lastSave","getLastSaveOrSync","savedAge","dirtyAge","outOfSync","relativeAge","key","interval","isOffline","offlineAge","isOfflineIndicatorOpen","offlineInterval","usePeriodicRender","onCollabStateChange","throttle","text","schema","sessionSuffix","getMilliseconds","random","getStackClient","onRealtimeEvent","CozyRealtime","resetCallbacks","callbacks","callback","match","unsubscribeAll","sub","sessionID","attributes","defaultSchema","fetchJSON","path","titleDoc","client2server","doctype","all","subscribe","setCallback","server2client","res","metadata","options","headers","stepsDoc","reason","meta","ver","ev","realtimeDoc","_type","telepointerDoc","notesFolderDocument","useReferencedFolderForNote","getDriveLink","notesFolder","setNotesFolder","fetchData","CozyFolder","getReferencedFolders","referencedFolder","folderUrl","nodes","marks","group","parseDOM","tag","defining","attrs","level","selectable","panelType","cxhtml","inline","atom","originalValue","isNumberColumnEnabled","layout","__autoSize","tableRole","isolating","colspan","rowspan","colwidth","background","ignore","excludes","__confluenceMetadata","inclusive","color","preserveWhitespace","trigger","orderedToObject","ordered","reduce","acc","cur","schemaOrdered","schemaObject","Schema","Unshared","getParentFolderLink","EmptyComponent","icon","modifiedTitle","onTitleUpdated","appFullName","getAppFullName","allowTables","allowRule","allowLists","allowTextColor","allowPanel","allowCodeBlocks","allowHelpDialog","allowBlockTypes","exclude","FakeEvent","prevented","createOnClick","go","preventDefault","BackFromEditing","folderId","models","getParentFolderId","nativePath","getFolderLink","ensureEmptyQueue","sync","tooltipStyles","tooltipPlacementBottom","margin","tooltipPlacementTop","StyledTooltip","withStyles","Tooltip","Balloon","open","Banner","ref","createPortal","OfflineIndicator","grid","chip","Component","fileWithPath","setFileWithPath","getParent","rawFile","normalize","query","dir_id","parent","ensureFilePath","RoutedEditor","withRouter","getReturnUrl","params","PrivateContext","List","PublicContext","sharedDocumentId","setSharedDocumentId","searchParams","has","fetchIfIsNoteReadOnly","getSharedDocument","getInstanceOptions","BarCenter","hot","module","URL","hostname","floor","returnUrlKey","hash","getFilesOwnPermissions","collection","getOwnPermissions","permissionsData","permissionObject","permissions","Object","perm","permission","isForType","getFile","find","getById","then","fileId","isDocumentReadOnly","writability","Error","cozyURL","cozySubdomainType","driveSlug","pathForDrive","webUrl","generateWebLink","cozyUrl","origin","subDomainType","hour","day","month","year","defaultSteps","Infinity","age","el","unit","coef","EmptyTableRow","tableSpecialRow","tableCellEmpty","LoadingTableRow"],"mappings":";AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yBAAiB,4BAA4B;AAC7C;AACA;AACA,0BAAkB,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,iDAAyC,0FAA0F;AACnI;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA,yCAAiC;;AAEjC;AACA;AACA;AACA,aAAK;AACL;AACA;AACA;AACA,cAAM;AACN;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAwB,kCAAkC;AAC1D,cAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA,kDAA0C,oBAAoB,WAAW;;AAEzE;AACA;AACA;AACA;AACA,wBAAgB,uBAAuB;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","file":"app/notes.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"\" + ({\"@atlaskit-internal_media-viewer-pdf-viewer\":\"@atlaskit-internal_media-viewer-pdf-viewer\"}[chunkId]||chunkId) + \"/notes.js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar promises = [];\n\n\n \t\t// JSONP chunk loading for javascript\n\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n \t\t\t// a Promise means \"currently loading\".\n \t\t\tif(installedChunkData) {\n \t\t\t\tpromises.push(installedChunkData[2]);\n \t\t\t} else {\n \t\t\t\t// setup Promise in chunk cache\n \t\t\t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t\t\t});\n \t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n \t\t\t\t// start chunk loading\n \t\t\t\tvar script = document.createElement('script');\n \t\t\t\tvar onScriptComplete;\n\n \t\t\t\tscript.charset = 'utf-8';\n \t\t\t\tscript.timeout = 120;\n \t\t\t\tif (__webpack_require__.nc) {\n \t\t\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t\t\t}\n \t\t\t\tscript.src = jsonpScriptSrc(chunkId);\n\n \t\t\t\t// create error before stack unwound to get useful stacktrace later\n \t\t\t\tvar error = new Error();\n \t\t\t\tonScriptComplete = function (event) {\n \t\t\t\t\t// avoid mem leaks in IE.\n \t\t\t\t\tscript.onerror = script.onload = null;\n \t\t\t\t\tclearTimeout(timeout);\n \t\t\t\t\tvar chunk = installedChunks[chunkId];\n \t\t\t\t\tif(chunk !== 0) {\n \t\t\t\t\t\tif(chunk) {\n \t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n \t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n \t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n \t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n \t\t\t\t\t\t\terror.type = errorType;\n \t\t\t\t\t\t\terror.request = realSrc;\n \t\t\t\t\t\t\tchunk[1](error);\n \t\t\t\t\t\t}\n \t\t\t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t\t\t}\n \t\t\t\t};\n \t\t\t\tvar timeout = setTimeout(function(){\n \t\t\t\t\tonScriptComplete({ type: 'timeout', target: script });\n \t\t\t\t}, 120000);\n \t\t\t\tscript.onerror = script.onload = onScriptComplete;\n \t\t\t\tdocument.head.appendChild(script);\n \t\t\t}\n \t\t}\n \t\treturn Promise.all(promises);\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import React from 'react'\n\nconst HeaderMenu = props => (\n  <header className={'page-header-menu ' + (props.className || '')}>\n    <div className=\"page-header-menu--left\">{props.left}</div>\n    {props.children}\n    <div className=\"page-header-menu--right\">{props.right}</div>\n  </header>\n)\n\nexport default HeaderMenu\n","var map = {\n\t\"./en\": \"7dT6\",\n\t\"./en.json\": \"7dT6\",\n\t\"./fr\": \"9pOX\",\n\t\"./fr.json\": \"9pOX\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"/KVF\";","import { useEffect } from 'react'\nimport { useFlag } from 'cozy-flags'\nimport set from 'lodash/set'\nimport get from 'lodash/get'\nimport flag, { FlagSwitcher } from 'cozy-flags'\n\nimport { getVersion, sendableSteps } from 'prosemirror-collab'\n\n/**\n * Sets a value in a global debug object\n *\n * If the corresponding 'debug.{name}' flag is activated\n * then you'll find the value in 'window.cozy.debug.{name}'\n *\n * @param {string} name\n * @param {object} value\n */\nexport function useDebugValue(name, value) {\n  const activated = useFlag(`debug.${name}`)\n  useEffect(() => {\n    if (activated) setDebugValue(name, value)\n  }, [activated, name, value])\n}\n\n/**\n * Returns a React component that will show\n * the flag switcher from cozy-flags\n * when the flag 'swicher' is activated\n */\nexport function useFlagSwitcher() {\n  useFlag('switcher')\n  return FlagSwitcher\n}\n\nexport function setDebugValue(name, value) {\n  set(window, `cozy.debug.${name}`, value)\n}\n\n// Sets a global 'window.cozy.debug.showSwitcher()'\n// that will activate the cozy-flag switcher\nset(window, `cozy.debug.showSwitcher`, () => flag('switcher', true))\n\nset(window, 'cozy.debug.notes.debugCollab', async function debugCollab() {\n  // activate all needed flags\n  flag('debug.client', true)\n  flag('debug.notes.service', true)\n  flag('debug.notes.collabProvider', true)\n  flag('debug.notes.channel', true)\n  flag('debug.notes.noteId', true)\n  flag('debug.notes.doc', true)\n  flag('debug.notes.file', true)\n  flag('debug.notes.returnUrl', true)\n  flag('debug.notes.dirtyRef', true)\n  flag('debug.notes.lastPatchError', true)\n\n  // then wait and trigger the collab  debug\n  return await new Promise(resolve => {\n    window.setTimeout(async () => {\n      const collabProvider = get(window, 'cozy.debug.notes.collabProvider')\n      const channel = get(window, 'cozy.debug.notes.channel')\n      const data = { date: new Date().toISOString() }\n\n      data.noteId = get(window, 'cozy.debug.notes.noteId')\n      data.initialVersion = get(window, 'cozy.debug.notes.initialVersion')\n      data.returnUrl = get(window, 'cozy.debug.notes.returnUrl')\n\n      const state = collabProvider && collabProvider.getState()\n      const version = collabProvider && state && getVersion(state)\n      const { steps } = (state && sendableSteps(state)) || { steps: [] }\n      data.state = { version, steps, length: steps && steps.length }\n\n      const backoff = channel && channel.backoff\n      const failures = channel && channel.failures\n      const isDirty = channel && channel.isDirty()\n      const isSending = channel && channel.isSending\n      const hasQueue = channel && channel.hasQueuedSteps()\n      const queued = channel && channel.queuedStep\n      const queuedState = queued && queued.state\n      const queuedVersion = queuedState && getVersion(queuedState)\n      const queuedSteps = queued && queued.localSteps && queued.localSteps.steps\n      data.queue = {\n        backoff,\n        failures,\n        isDirty,\n        isSending,\n        hasQueue,\n        version: queuedVersion,\n        steps: queuedSteps,\n        length: queuedSteps && queuedSteps.length\n      }\n\n      const dirtySince = collabProvider.isDirty()\n      const lastRemoteSync = collabProvider.getLastRemoteSync()\n      const lastLocalSave = collabProvider.getLastLocalSave()\n      data.collabState = {\n        dirtySince,\n        lastRemoteSync,\n        lastLocalSave\n      }\n\n      const serviceClient = collabProvider && collabProvider.serviceClient\n      const realtime = serviceClient && serviceClient.realtime\n      const websocket = realtime && realtime.websocket\n      const retryManager = realtime && realtime.retryManager\n      data.realtime = {\n        hasRealtime: !!realtime,\n        started: realtime && realtime.isStarted,\n        hasWebsocket: realtime && realtime.hasWebSocket(),\n        isOpen: realtime && realtime.isWebSocketOpen(),\n        readyState: websocket && websocket.readyState,\n        bufferedAmount: websocket && websocket.bufferedAmount,\n        url: websocket && websocket.url,\n        retries: retryManager && retryManager.retries,\n        wait: retryManager && retryManager.wait\n      }\n\n      const client = get(window, 'cozy.debug.client')\n      data.client = {\n        token: client.stackClient.token,\n        credentials: client.stackClient.getCredentials(),\n        authorization: client.stackClient.getAuthorizationHeader(),\n        uri: client.uri\n      }\n\n      let error = get(window, 'cozy.debug.notes.lastPatchError')\n      if (!error && isDirty) {\n        while (channel.isSending) {\n          await new Promise(resolve => window.setTimeout(resolve, 50))\n        }\n        channel.resetBackoff()\n        channel.processQueue()\n        await Promise.race([\n          new Promise(resolve => window.setTimeout(resolve, 2000)),\n          new Promise(resolve => {\n            const fn = async () => {\n              let err = get(window, 'cozy.debug.notes.lastPatchError')\n              while (!err) {\n                await new Promise(resolve => window.setTimeout(resolve, 50))\n                err = get(window, 'cozy.debug.notes.lastPatchError')\n              }\n              error = err\n              resolve()\n            }\n            fn()\n          })\n        ])\n        if (channel.isDirty()) {\n          channel.backoff = backoff\n          channel.failures = failures\n        }\n      }\n      let msg = error && error.message\n      try {\n        msg = JSON.parse(error.message)\n      } catch (e) {\n        // nothing\n      }\n      data.lastPatchError = {\n        name: error && error.name,\n        status: error && error.status,\n        message: msg\n      }\n\n      resolve(data)\n    }, 250)\n  })\n})\n","/* (ignored) */","/* (ignored) */","import React, { useState, useCallback } from 'react'\nimport { CozyFile } from 'cozy-doctypes'\nimport { withClient } from 'cozy-client'\nimport { SharedRecipients } from 'cozy-sharing'\n\nimport { translate } from 'cozy-ui/react/I18n'\nimport Icon from 'cozy-ui/react/Icon'\nimport IconButton from 'cozy-ui/react/IconButton'\nimport Alerter from 'cozy-ui/react/Alerter'\nimport ActionMenu, { ActionMenuItem } from 'cozy-ui/react/ActionMenu'\nimport { TableRow, TableCell } from 'cozy-ui/react/Table'\nimport useBreakpoints from 'cozy-ui/react/hooks/useBreakpoints'\n\nimport styles from 'components/notes/List/list.styl'\nimport { generateReturnUrlToNotesIndex } from 'lib/utils'\nimport NoteIcon from 'assets/icons/icon-note-32.svg'\n\nconst NoteRow = ({ note, f, t, client }) => {\n  const { filename, extension } = CozyFile.splitFilename(note)\n  const { isMobile } = useBreakpoints()\n\n  const [isMenuOpen, setMenuOpen] = useState(false)\n  const openMenu = useCallback(\n    e => {\n      setMenuOpen(true)\n      e.stopPropagation()\n    },\n    [setMenuOpen]\n  )\n  const closeMenu = useCallback(() => setMenuOpen(false), [setMenuOpen])\n\n  const deleteNote = useCallback(async () => {\n    try {\n      await client.destroy(note)\n      setMenuOpen(false)\n      Alerter.info(t('Notes.Delete.deleted'))\n    } catch (error) {\n      Alerter.error(t('Notes.Delete.failed'))\n    }\n  }, [client, note, t, setMenuOpen])\n\n  const menuTriggerRef = React.createRef()\n\n  return (\n    <>\n      <TableRow\n        className={`u-c-pointer ${styles.tableRow}`}\n        onClick={() =>\n          (window.location.href = generateReturnUrlToNotesIndex(note))\n        }\n      >\n        <TableCell\n          className={`${styles.tableCellName} u-flex u-flex-items-center u-fz-medium`}\n        >\n          <Icon icon={NoteIcon} size={32} className=\"u-mr-1 u-flex-shrink-0\" />\n          <span className=\"u-charcoalGrey u-ellipsis\">{filename}</span>\n          {!isMobile && <span className=\"u-ellipsis\">{extension}</span>}\n        </TableCell>\n        {!isMobile && (\n          <>\n            <TableCell className={styles.tableCell}>\n              {t('Notes.List.at', {\n                date: f(note.updated_at, 'DD MMMM'),\n                time: f(note.updated_at, 'HH:mm')\n              })}\n            </TableCell>\n            <TableCell className={styles.tableCell}>—</TableCell>\n            <TableCell className={styles.tableCell}>\n              <SharedRecipients docId={note._id} size=\"small\" />\n            </TableCell>\n          </>\n        )}\n        <TableCell className={styles.tableCell}>\n          <span ref={menuTriggerRef}>\n            <IconButton onClick={openMenu}>\n              <Icon icon=\"dots\" />\n            </IconButton>\n          </span>\n        </TableCell>\n      </TableRow>\n      {isMenuOpen && (\n        <ActionMenu\n          onClose={closeMenu}\n          anchorElRef={menuTriggerRef}\n          placement=\"bottom-end\"\n        >\n          <ActionMenuItem onClick={deleteNote} left={<Icon icon=\"trash\" />}>\n            {t('Notes.Delete.delete_note')}\n          </ActionMenuItem>\n        </ActionMenu>\n      )}\n    </>\n  )\n}\n\nexport default translate()(withClient(NoteRow))\n","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */","// extracted by mini-css-extract-plugin\nmodule.exports = {\"saving-indicator\":\"saving-indicator--rzoXB\"};","import React, { useCallback, useState } from 'react'\nimport { ShareButton, ShareModal, withLocales } from 'cozy-sharing'\nimport { withClient } from 'cozy-client'\n\nimport useFileWithPath from 'hooks/useFileWithPath'\nimport styles from 'components/notes/sharing.styl'\n\nexport default withLocales(\n  withClient(function SharingWidget(props) {\n    const { client } = props\n\n    const file = useFileWithPath({ cozyClient: client, file: props.file })\n    const noteId = file && file.id\n\n    const [showModal, setShowModal] = useState(false)\n    const onClick = useCallback(() => setShowModal(!showModal), [showModal])\n    const onClose = useCallback(() => setShowModal(false), [])\n\n    return (\n      (file && (\n        <>\n          <ShareButton\n            theme=\"primary\"\n            docId={noteId}\n            onClick={onClick}\n            extension=\"narrow\"\n            className={styles['sharing-button']}\n          />\n          {showModal && <ShareModal document={file} onClose={onClose} />}\n        </>\n      )) ||\n      null\n    )\n  })\n)\n","import React, { useCallback, useRef, useEffect, useMemo } from 'react'\n\nimport { Editor, WithEditorActions } from '@atlaskit/editor-core'\n\nimport { MainTitle } from 'cozy-ui/react/Text'\nimport Textarea from 'cozy-ui/react/Textarea'\nimport { useI18n } from 'cozy-ui/react/I18n'\nimport useEventListener from 'cozy-ui/react/hooks/useEventListener'\n\nimport editorConfig from 'components/notes/editor_config'\nimport HeaderMenu from 'components/header_menu'\nimport styles from 'components/notes/editor-view.styl'\n\nfunction updateTextareaHeight(target) {\n  if (target) target.style.height = `${target.scrollHeight}px`\n}\n\nconst nullCallback = () => {}\n\nfunction EditorView(props) {\n  const {\n    defaultValue,\n    onTitleChange,\n    onTitleBlur,\n    defaultTitle,\n    title,\n    collabProvider,\n    leftComponent,\n    rightComponent,\n    onContentChange,\n    readOnly,\n    bannerRef\n  } = props\n  const { t } = useI18n()\n\n  const titleEl = useRef(null)\n\n  const onTitleEvent = useCallback(\n    e => {\n      const target = e.target\n      updateTextareaHeight(target)\n      if (onTitleChange) onTitleChange(e)\n    },\n    [onTitleChange]\n  )\n\n  // put the provider in readonly mode if requested and react to changes of values\n  useMemo(() => collabProvider && collabProvider.setReadOnly(!!readOnly), [\n    readOnly,\n    collabProvider\n  ])\n\n  const collabEdit = useMemo(\n    () =>\n      collabProvider && {\n        useNativePlugin: true,\n        provider: Promise.resolve(collabProvider),\n        inviteToEditHandler: () => undefined,\n        isInviteToEditButtonSelected: false,\n        userId: collabProvider.serviceClient.getSessionId()\n      },\n    [collabProvider]\n  )\n\n  useEffect(() => updateTextareaHeight(titleEl.current), [])\n\n  useEventListener(titleEl.current, 'blur', onTitleBlur)\n\n  return (\n    <article className={styles['note-article']}>\n      <style>#coz-bar {'{ display: none }'}</style>\n      <HeaderMenu\n        left={leftComponent}\n        className=\"note-header-menu--editing\"\n        right={rightComponent}\n      />\n      <section className=\"note-editor-container\">\n        <Editor\n          disabled={collabProvider ? false : readOnly}\n          collabEdit={collabEdit}\n          onChange={onContentChange || nullCallback}\n          defaultValue={defaultValue}\n          {...editorConfig}\n          appearance=\"full-page\"\n          placeholder={t('Notes.EditorView.main_placeholder')}\n          shouldFocus={!readOnly}\n          contentComponents={\n            <WithEditorActions\n              render={() => (\n                <>\n                  <aside ref={bannerRef} className={styles.banner}></aside>\n                  <MainTitle tag=\"h1\" className={styles.title}>\n                    <Textarea\n                      ref={titleEl}\n                      rows=\"1\"\n                      readOnly={!!readOnly}\n                      fullwidth={true}\n                      value={title}\n                      onChange={readOnly ? nullCallback : onTitleEvent}\n                      placeholder={defaultTitle}\n                      className={styles.titleInput}\n                    />\n                  </MainTitle>\n                </>\n              )}\n            />\n          }\n        />\n      </section>\n    </article>\n  )\n}\n\nexport default EditorView\n","import { useMemo } from 'react'\nimport ServiceClient from 'lib/collab/stack-client'\n\nfunction useServiceClient({ userId, userName, cozyClient }) {\n  return useMemo(() => {\n    return new ServiceClient({ userId, userName, cozyClient })\n  }, [cozyClient, userId, userName])\n}\n\nexport default useServiceClient\n","export const getParticipant = ({ userId, sessionId }) => ({\n  userId: sessionId,\n  sessionId: sessionId || userId,\n  name: userId,\n  avatar: null,\n  email: null\n})\n","import { EventEmitter2 } from 'eventemitter2'\nimport { getVersion, sendableSteps } from 'prosemirror-collab'\n\nimport flag from 'cozy-flags'\nimport { setDebugValue } from '../debug'\n\nconst minimumBackoff = 128 // 128ms\nconst maximumBackoff = 1000 * 60 * 5 // Max 5 minutes\nconst failuresBeforeCatchup = 4\n\nexport class Channel {\n  constructor(config, serviceClient) {\n    this.config = config\n    this.service = serviceClient\n    this.eventEmitter = new EventEmitter2()\n    this.resetBackoff()\n    this.initializeStepsQueue()\n    this.isSending = false\n  }\n\n  /**\n   * Reset the backoff\n   */\n  resetBackoff() {\n    this.backoff = 0\n    this.failures = 0\n  }\n\n  /**\n   * Increase the backoff\n   */\n  increaseBackoff() {\n    this.failures = this.failures + 1\n    if (this.failures % failuresBeforeCatchup == 0) {\n      this.emit('needcatchup', { failures: this.failures })\n    }\n\n    this.backoff = Math.max(\n      Math.min(this.backoff * 2, maximumBackoff),\n      minimumBackoff\n    )\n  }\n\n  /**\n   * Program something after backoff\n   * @returns {Promise}\n   */\n  afterBackoff() {\n    const fn = resolve => {\n      if (this.backoff < minimumBackoff) {\n        resolve()\n      } else {\n        window.setTimeout(resolve, this.backoff)\n      }\n    }\n    return new Promise(fn)\n  }\n\n  /**\n   * Initialize the steps queue\n   */\n  initializeStepsQueue() {\n    this.queuedStep = undefined\n  }\n\n  /**\n   * Checks if something is not fully sent to the server\n   *\n   * @returns {bool}\n   */\n  isDirty() {\n    return this.hasQueuedSteps() || this.isSending\n  }\n\n  /**\n   * Ensures all local steps are sent to the server\n   */\n  async ensureEmptyQueue() {\n    return new Promise(resolve => {\n      function onEmptyQueue() {\n        this.off('emptyQueue', onEmptyQueue)\n        resolve()\n      }\n      if (this.isDirty()) {\n        this.on('emptyQueue', onEmptyQueue)\n      } else {\n        resolve()\n      }\n    })\n  }\n\n  /**\n   * Enqueue steps\n   * @param {Function} getState - function to get a current proseMirror state\n   * @param {Object} state - proseMirror state\n   * @param {Object[]} localSteps - local steps to send\n   */\n  enqueueSteps({ getState, state, localSteps }) {\n    this.queuedStep = { getState, state, localSteps }\n  }\n\n  /**\n   * Dequeue steps\n   * @returns {getState, state, localSteps}\n   */\n  dequeueSteps() {\n    const queued = this.queuedStep\n    const getState = queued.getState\n    const state = queued.state || getState()\n    const localSteps = queued.localSteps ||\n      sendableSteps(state) || { steps: [] }\n    this.queuedStep = undefined\n\n    return { getState, state, localSteps }\n  }\n\n  /**\n   * Test if there is a queued step\n   * @returns {boolean}\n   */\n  hasQueuedSteps() {\n    return !!this.queuedStep\n  }\n\n  /**\n   * Rebase steps in queue\n   */\n  rebaseStepsInQueue() {\n    if (this.queuedStep) {\n      this.queuedStep = { getState: this.queuedStep.getState }\n    }\n  }\n\n  /**\n   * Program a push for new steps to the service\n   * @param {Object} state - state from proseMirror internals\n   * @param {Function} getState - returns current proseMirror state\n   * @param {Object} localSteps - localSteps object from proseMirror internals\n   * Today the provider calling `sendSteps` do not fill the localSteps\n   * parameter. This parameter is however provisionned in the demo code from\n   * Atlaskit. I prefer not to remove it, in case we need it later.\n   */\n  async sendSteps(getState, state, localSteps) {\n    this.emit('enqueueSteps')\n    this.enqueueSteps({ getState, state, localSteps })\n    await this.processQueue()\n  }\n\n  /**\n   * Send steps in queue\n   */\n  async processQueue() {\n    if (this.isSending) {\n      return\n    }\n    if (!this.hasQueuedSteps()) {\n      this.emit('emptyQueue')\n      return\n    }\n\n    this.isSending = true\n    await this.afterBackoff()\n\n    const {\n      getState,\n      state,\n      localSteps: { steps }\n    } = this.dequeueSteps()\n    const version = getVersion(state)\n\n    // Don't send any steps before we're ready.\n    if (typeof version === 'undefined') return\n    // Nothing to do if no steps\n    if (steps.length === 0) return\n\n    try {\n      const { noteId } = this.config\n      const response = await this.service.pushSteps(noteId, version, steps)\n      this.rebaseStepsInQueue()\n      this.resetBackoff()\n      this.emit('successfulPatch')\n      this.isSending = false\n      if (response && response.steps && response.steps.length > 0) {\n        this.emit('data', response)\n      }\n    } catch (err) {\n      if (flag('notes.lastPatchError')) {\n        setDebugValue('notes.lastPatchError', err)\n      }\n      if (this.hasQueuedSteps()) {\n        // will retry later with more steps\n        this.rebaseStepsInQueue()\n      } else {\n        // send again the current steps\n        this.enqueueSteps({ getState })\n      }\n      this.increaseBackoff()\n      this.isSending = false\n    }\n    // if ever there was something waiting\n    await this.processQueue()\n  }\n\n  /**\n   * Connect to pubsub to start receiving events\n   */\n  async connect({ version, doc, updatedAt }) {\n    const { noteId } = this.config\n    this.service.join(noteId)\n    this.service.onStepsCreated(noteId, data => {\n      this.emit('data', { version: data.version, steps: [data] })\n    })\n    this.service.onTelepointerUpdated(noteId, payload => {\n      this.emit('telepointer', payload)\n    })\n    this.emit('connected', { version, doc, updatedAt })\n  }\n\n  /**\n   * Get steps from version x to latest\n   */\n  async getSteps(version) {\n    const { noteId } = this.config\n    return await this.service.getSteps(noteId, version)\n  }\n\n  /**\n   * Send telepointer\n   */\n  async sendTelepointer(data) {\n    const { noteId } = this.config\n    return await this.service.pushTelepointer(noteId, data)\n  }\n\n  /**\n   * Subscribe to events emitted by this channel\n   */\n  on(evt, handler) {\n    this.eventEmitter.on(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe from events emitted by this channel\n   */\n  off(evt, handler) {\n    this.eventEmitter.off(evt, handler)\n    return this\n  }\n\n  /**\n   * Emit events to subscribers\n   */\n  emit(evt, data) {\n    this.eventEmitter.emit(evt, data)\n    return this\n  }\n}\n","import { EventEmitter2 } from 'eventemitter2'\nimport { getVersion, sendableSteps } from 'prosemirror-collab'\nimport { JSONTransformer } from '@atlaskit/editor-json-transformer'\nimport { Channel } from './channel'\nimport { getParticipant } from './participant'\nimport get from 'lodash/get'\nimport debounce from 'lodash/debounce'\n\nconst jsonTransformer = new JSONTransformer()\n// Using the jsonTransformer directly introduce a bug for empty documents\n// with only one paragraph. The transformed document has no content\n// (not even the paragraph) and makes the Editor to always when think\n// it is as version=0. This would break the catchup logic.\n// This patch fixes this unique case, creating a correct empty document with\n// an empty paragraph\nconst oldEncode = jsonTransformer.encode.bind(jsonTransformer)\njsonTransformer.encode = function(doc) {\n  const transformed = oldEncode(doc)\n  if (transformed.content.length === 0 && doc.content.length != 0) {\n    return {\n      content: [{ type: 'paragraph', content: [] }],\n      type: 'doc'\n    }\n  } else {\n    return transformed\n  }\n}\n\n/**\n * The CollabProvider is called directly by the\n * collaboration plugin of proseMirror.\n * It will then use `Channel` as communication\n * layer with the `ServiceClient`, which itself\n * talk to the server.\n */\n\nexport class CollabProvider {\n  constructor(config, serviceClient) {\n    this.config = { ...config }\n    this.config['sessionId'] = serviceClient.getSessionId()\n    this.config['userId'] = serviceClient.getUserId()\n    // this debounce is primary here to introduce a short delay so that\n    // the local step is definitively applied in the editor. The debounce\n    // is the optional additional value to avoid reseting the state too much\n    this.cancelLocalChanges = debounce(this.cancelLocalChanges.bind(this), 100)\n    this.setReadOnly(!!this.config['readOnly'])\n    this.serviceClient = serviceClient\n    this.channel = config.channel || new Channel(this.config, serviceClient)\n    this.eventEmitter = new EventEmitter2()\n    this.queue = []\n    this.getState = () => {}\n    this.participants = new Map()\n    this.pauseQueue = false\n    this.initialVersion = config.version\n    this.initialDate = config.updatedAt || new Date()\n    this.pauseQueue = false\n  }\n\n  /**\n   * Initialze the collaboration provider\n   * @param {Function} getState - How to get the proseMirror state\n   */\n  initialize(getState) {\n    this.getState = getState\n    this.channel.on('connected', ({ doc, version, updatedAt }) => {\n      const { sessionId } = this.config\n      this.emit('init', { sid: sessionId, doc, version }) // Set initial document\n      this.emit('connected', { sid: sessionId }) // Let the plugin know that we're connected an ready to go\n      this.listenStateEvents({ lastRemoteSync: updatedAt })\n    })\n    this.channel.on('data', this.onReceiveData)\n    this.channel.on('telepointer', this.onReceiveTelepointer)\n    this.channel.on('needcatchup', () => this.catchup())\n    const state = getState()\n    const doc = jsonTransformer.encode(state.doc)\n    const usableVersion =\n      this.initialVersion !== undefined ? this.initialVersion : doc.version\n    const collabDoc = { ...doc, version: usableVersion }\n    this.channel.connect({\n      version: usableVersion,\n      doc: collabDoc,\n      updatedAt: this.initialDate\n    })\n    return this\n  }\n\n  /**\n   * Send steps from transaction to other participants\n   */\n  send(tr, oldState, newState) {\n    // Ignore transactions without steps\n    if (!tr.steps || !tr.steps.length) return\n\n    // cancel changes on a readonly document\n    if (this.isReadOnly()) {\n      this.cancelLocalChanges()\n      return\n    }\n\n    this.channel.sendSteps(this.getState, newState)\n  }\n\n  /**\n   * Send messages, such as telepointers, to other participants.\n   */\n  sendMessage(data) {\n    if (!data || this.isReadOnly()) {\n      return\n    }\n\n    const { type } = data\n    switch (type) {\n      case 'telepointer':\n        this.channel.sendTelepointer({\n          ...data,\n          timestamp: new Date().getTime()\n        })\n    }\n  }\n\n  /**\n   * Queue new steps from the server which should\n   * be applied to the local editor\n   * @param {Object} data - new steps\n   */\n  queueData(data) {\n    // If a change couldn't be applied or discarded, it will\n    // block the queue, waiting for missing steps\n    // Let order changes, putting first the one that could be\n    // applied (or discarded) first, and avoir dead-locks\n    const orderedQueue = [...this.queue, data].sort((a, b) => {\n      // order by document version before applying the change\n      const aStart = a.version - a.steps.length\n      const bStart = b.version - b.steps.length\n      if (aStart > bStart) return 1\n      if (aStart < bStart) return -1\n      // for same starting version, keep first the one going further\n      // we could apply the shorter, but then we'd have to discard\n      // the longer, and may miss some step contained in it\n      if (a.version > b.version) return -1\n      if (a.version < b.version) return 1\n      return 0\n    })\n    this.queue = orderedQueue\n  }\n\n  /**\n   * Catchup after multiple errors\n   * @param {Function} getState - filled when requested from channel\n   */\n  async catchup() {\n    // forbids other changes to be accepted during the catchup\n    // we will process them later\n    this.pauseQueue = true\n    const currentVersion = getVersion(this.getState())\n    try {\n      const { doc, version, steps } = await this.channel.getSteps(\n        currentVersion\n      )\n      if (doc) {\n        // we lag too much, server did send us the whole document\n        const { sessionId } = this.config\n        // get local steps and re-emit them after reinit the whole document\n        const { steps: localSteps = [] } = sendableSteps(this.getState()) || {}\n        this.emit('init', { sid: sessionId, doc, version })\n        if (localSteps.length && !this.isReadOnly()) {\n          this.emit('local-steps', { steps: localSteps })\n        }\n      } else if (steps.length > 0) {\n        // we got steps to apply\n        this.onReceiveData({ steps, version }, true)\n      }\n      // processQueue again\n      this.queueTimeout = undefined\n      this.pauseQueue = false\n      this.processQueue()\n    } catch (err) {\n      // something got wrong, try to catchup again\n      // TODO : maybe try to reinit the full doc ?\n      this.pauseQueue = false\n      this.programCatchup()\n    }\n  }\n\n  /**\n   * Something got wrong, we program a catchup,\n   * waiting 1s in case we receive new message\n   * that may resolve our problems\n   */\n  programCatchup() {\n    if (!this.queueTimeout) {\n      this.queueTimeout = window.setTimeout(() => {\n        this.catchup()\n      }, 1000)\n    }\n  }\n\n  /**\n   * When received new messages that resolve a previous\n   * problem: Cancelling the programed catchup\n   */\n  cancelCatchup() {\n    if (this.queueTimeout) {\n      window.clearTimeout(this.queueTimeout)\n      this.queueTimeout = undefined\n    }\n  }\n\n  /**\n   * Process the message queue (new steps from the servers)\n   */\n  processQueue() {\n    if (this.queue.length > 0 && !this.pauseQueue) {\n      let currentVersion = getVersion(this.getState())\n      while (this.queue.length > 0) {\n        const first = this.queue[0]\n        const firstVersion = first.version\n        const expectedVersion = first.steps.length + currentVersion\n        if (firstVersion == expectedVersion) {\n          // process item\n          this.cancelCatchup()\n          this.queue.shift()\n          this.processRemoteData(first)\n          currentVersion = firstVersion\n        } else {\n          if (firstVersion <= expectedVersion) {\n            // item is obsolete, we won't be able to process it\n            this.queue.shift()\n          }\n          if (firstVersion > expectedVersion) {\n            // we miss some steps\n            this.programCatchup()\n            break\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Send new steps from the server to the local proseMirror editor\n   * These steps should be previously checked and ordered\n   */\n  processRemoteData = data => {\n    const { version, steps } = data\n\n    if (steps && steps.length) {\n      const userIds = steps.map(\n        step => step.sessionId || this.serviceClient.getUserId(step.sessionId)\n      )\n      this.emit('data', { json: steps, version, userIds })\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn(\n        'Collab.Provider: processRemoteData no steps ? ',\n        steps,\n        data\n      )\n    }\n  }\n\n  /**\n   * We receive new steps  from the server\n   */\n  onReceiveData = data => {\n    this.queueData(data)\n    this.processQueue()\n  }\n\n  /**\n   * We receive new user cursor positions from the server\n   */\n  onReceiveTelepointer = data => {\n    const { sessionId } = data\n    const userId = this.serviceClient.getUserId(sessionId)\n    if (userId === this.config.userId) {\n      return\n    }\n\n    const participant = this.participants.get(userId)\n    if (participant && participant.lastActive > data.timestamp) {\n      return\n    }\n\n    this.updateParticipant(sessionId, data.timestamp)\n    this.emit('telepointer', data)\n  }\n\n  updateParticipant(sessionId, timestamp) {\n    const userId = this.serviceClient.getUserId(sessionId)\n    const participant = getParticipant({ userId, sessionId })\n\n    this.participants.set(userId, {\n      name: '',\n      email: '',\n      avatar: '',\n      sessionId: sessionId,\n      userId: userId,\n      ...participant,\n      lastActive: timestamp\n    })\n\n    const joined = [this.participants.get(userId)]\n\n    // Filter out participants that's been inactive for\n    // more than 5 minutes.\n\n    const now = new Date().getTime()\n    const left = Array.from(this.participants.values()).filter(\n      p => (now - p.lastActive) / 1000 > 300\n    )\n\n    left.forEach(p => this.participants.delete(p.userId))\n    this.emit('presence', { joined, left })\n  }\n\n  /**\n   * Emit events to subscribers\n   */\n  emit(evt, data) {\n    this.eventEmitter.emit(evt, data)\n    return this\n  }\n\n  /**\n   * Subscribe to events emitted by this provider\n   */\n  on(evt, handler) {\n    this.eventEmitter.on(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe from events emitted by this provider\n   */\n  off(evt, handler) {\n    this.eventEmitter.off(evt, handler)\n    return this\n  }\n\n  /**\n   * Unsubscribe all listeners for this event\n   */\n  unsubscribeAll(evt) {\n    this.eventEmitter.removeAllListeners(evt)\n  }\n\n  /**\n   * Checks if something is not fully sent to the server\n   *\n   * @returns {bool}\n   */\n  isDirty() {\n    return !!this.dirtySince\n  }\n\n  /**\n   * Date since which something is waiting to be sent to the server\n   *\n   * @returns {Date|undefined} undefined if the state is not dirty\n   */\n  getDirtySince() {\n    return this.dirtySince\n  }\n\n  /**\n   * Date of the last save of local state to the server\n   *\n   * @returns {Date|undefined}\n   */\n  getLastLocalSave() {\n    return this.lastLocalSave\n  }\n\n  /**\n   * Date of the last sync with data from the server\n   *\n   * @returns {Date|undefined}\n   */\n  getLastRemoteSync() {\n    return this.lastRemoteSync\n  }\n\n  /**\n   * Date of last update with the server (both in or out)\n   *\n   * @returns {Date|undefined}\n   */\n  getLastSaveOrSync() {\n    return this.lastLocalSave > this.lastRemoteSync\n      ? this.lastLocalSave\n      : this.lastRemoteSync\n  }\n\n  /**\n   * When we successfuly save local changes to the server\n   *\n   * @private\n   */\n  onLocalSave() {\n    this.lastLocalSave = new Date()\n    this.emit('collab-state-change')\n  }\n\n  /**\n   * When we successfuly get remote changes from the server\n   *\n   * @private\n   */\n  onRemoteSync() {\n    this.lastRemoteSync = new Date()\n    this.emit('collab-state-change')\n  }\n\n  /**\n   * When we empty the queue of data to be sent to the server\n   * and none is being sent at the moment\n   *\n   * @private\n   */\n  onChannelEmptyQueue() {\n    this.dirtySince = undefined\n    this.emit('collab-state-change')\n  }\n\n  /**\n   * When we add  something to the queue of data to be sent to the server\n   *\n   * @private\n   */\n  onChannelEnqueue() {\n    if (!this.dirtySince) {\n      this.dirtySince = new Date()\n      this.emit('collab-state-change')\n    }\n  }\n\n  /**\n   * Listen to events from and to the server\n   * to update the current dirty state and last save dates\n   *\n   * @private\n   */\n  listenStateEvents({ lastRemoteSync } = {}) {\n    this.channel.on('emptyQueue', this.onChannelEmptyQueue.bind(this))\n    this.channel.on('enqueueSteps', this.onChannelEnqueue.bind(this))\n    this.channel.on('successfulPatch', this.onLocalSave.bind(this))\n    this.on('data', this.onRemoteSync.bind(this))\n    this.on('init', this.onRemoteSync.bind(this))\n    if (lastRemoteSync) this.lastRemoteSync = lastRemoteSync\n  }\n\n  /**\n   * Checks if the editor should be readonly\n   *\n   * @returns {bool}\n   */\n  isReadOnly() {\n    return this.readOnly\n  }\n\n  /**\n   * Set the editor readonly or readwrite\n   *\n   * @param {bool} readOnly - true by default\n   */\n  setReadOnly(readOnly = true) {\n    this.readOnly = !!readOnly\n    if (this.readOnly) this.cancelLocalChanges()\n  }\n\n  /**\n   * Remove all local changes  and go back to the server state\n   */\n  cancelLocalChanges() {\n    const currentState = this.getState && this.getState()\n    if (currentState) {\n      const rawDoc = get(currentState, 'collab$.unconfirmed[0].origin.docs[0]')\n      const version = get(currentState, 'collab$.version')\n      const sid = this.config['sessionId']\n      if (rawDoc && version && sid) {\n        const doc = rawDoc.toJSON()\n        this.emit('init', { doc, version, sid })\n      }\n    }\n  }\n}\n\nexport default CollabProvider\n","import { useState, useEffect } from 'react'\n\nfunction useNote({ serviceClient, noteId }) {\n  // `docId` is the id of the note for which we have a state.\n  // `noteId` is the id of the requested note.\n  const [docId, setDocId] = useState(noteId)\n  const [loading, setLoading] = useState(true)\n  const [doc, setDoc] = useState(undefined)\n  const [title, setTitle] = useState(undefined)\n\n  useEffect(\n    () => {\n      async function loadNote() {\n        try {\n          if (!loading) setLoading(true)\n          const doc = await serviceClient.getDoc(docId)\n          setTitle(doc.title || '')\n          setDoc(doc)\n        } catch (e) {\n          setTitle(false)\n          setDoc(false)\n          // eslint-disable-next-line no-console\n          console.warn(`Could not load note ${docId}`)\n        }\n        setLoading(false)\n      }\n\n      if (docId !== noteId) {\n        // reload if ever noteId changes\n        setLoading(true)\n        setTitle(undefined)\n        setDoc(undefined)\n        setDocId(noteId)\n      } else if (serviceClient) {\n        // load the note if needed\n        if (!doc || doc.file.id !== docId) loadNote()\n      }\n    },\n    // `loading` and `doc` are willingly not included in the dependencies\n    // eslint-disable-next-line\n    [noteId, docId, setDocId, setLoading, serviceClient, setDoc, setTitle]\n  )\n\n  if (docId === noteId) return { loading, title, doc, setTitle }\n  else return { loading: true, title: undefined, doc: undefined, setTitle }\n}\n\nexport default useNote\n","import React from 'react'\n\nconst IsPublicContext = React.createContext(false)\nexport default IsPublicContext\n","/* global cozy */\nimport React from 'react'\nimport Stack from 'cozy-ui/react/Stack'\nimport { withBreakpoints } from 'cozy-ui/react'\nimport { Query, Q } from 'cozy-client'\nimport AppTitle from 'components/notes/List/AppTitle'\nimport List from 'components/notes/List/List'\nimport Add, { AddMobile } from 'components/notes/add'\nimport styles from 'components/notes/List/list.styl'\nconst shouldDisplayAddButton = (fetchStatus, notes) =>\n  fetchStatus === 'loaded' && notes.length > 0\n\nconst ListView = ({ breakpoints: { isMobile } }) => {\n  const { BarRight } = cozy.bar\n\n  return (\n    <Query query={() => Q('io.cozy.notes')}>\n      {({ data: notes, fetchStatus }) => {\n        return (\n          <>\n            <Stack className=\"u-mt-1 u-mt-0-m\">\n              <div\n                className={`${styles.appHeader} u-flex u-flex-justify-between u-flex-items-center`}\n              >\n                <AppTitle />\n                {!isMobile && shouldDisplayAddButton(fetchStatus, notes) && (\n                  <Add />\n                )}\n              </div>\n              <List notes={notes} fetchStatus={fetchStatus} />\n            </Stack>\n            {isMobile && shouldDisplayAddButton(fetchStatus, notes) && (\n              <BarRight>\n                <AddMobile />\n              </BarRight>\n            )}\n          </>\n        )\n      }}\n    </Query>\n  )\n}\n\nexport default withBreakpoints()(ListView)\n","import SpriteSymbol from \"../../../node_modules/svg-baker-runtime/browser-symbol.js\";\nimport sprite from \"../../../node_modules/svg-sprite-loader/runtime/browser-sprite.build.js\";\nvar symbol = new SpriteSymbol({\n  \"id\": \"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d\",\n  \"use\": \"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d-usage\",\n  \"viewBox\": \"0 0 32 32\",\n  \"content\": \"<symbol xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 32 32\\\" id=\\\"icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d\\\">\\n<style type=\\\"text/css\\\">\\n\\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st0{fill-rule:evenodd;clip-rule:evenodd;fill:#ACF5F7;}\\n\\t#icon-note-32_0b87f187ce7a65cb93dbf28b37a73b8d .st1{fill-rule:evenodd;clip-rule:evenodd;fill:#0DCBCF;}\\n</style>\\n<g transform=\\\"translate(2)\\\">\\n\\t<path class=\\\"st0\\\" d=\\\"M0,2c0-1.1,0.9-2,2-2h22c1.1,0,2,0.9,2,2v28c0,1.1-0.9,2-2,2H2c-1.1,0-2-0.9-2-2V2z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M6,8h14v2H6V8z M6,12h8v2H6V12z M6,16h14v2H6V16z M6,20h10v2H6V20z\\\" />\\n</g>\\n<g transform=\\\"translate(0 4)\\\">\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,0h2C4.3,0,5,0.7,5,1.5l0,0C5,2.3,4.3,3,3.5,3h-2C0.7,3,0,2.3,0,1.5l0,0C0,0.7,0.7,0,1.5,0z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,7h2C4.3,7,5,7.7,5,8.5l0,0C5,9.3,4.3,10,3.5,10h-2C0.7,10,0,9.3,0,8.5l0,0C0,7.7,0.7,7,1.5,7z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,14h2C4.3,14,5,14.7,5,15.5l0,0C5,16.3,4.3,17,3.5,17h-2C0.7,17,0,16.3,0,15.5l0,0C0,14.7,0.7,14,1.5,14z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M1.5,21h2C4.3,21,5,21.7,5,22.5l0,0C5,23.3,4.3,24,3.5,24h-2C0.7,24,0,23.3,0,22.5l0,0C0,21.7,0.7,21,1.5,21z\\\" />\\n</g>\\n<g>\\n\\t<path class=\\\"st1\\\" d=\\\"M31.4,18.4l-2.8-2.8c0.8-0.8,2-0.8,2.8,0S32.2,17.6,31.4,18.4z\\\" />\\n\\t<path class=\\\"st1\\\" d=\\\"M30.7,19.1L20.8,29l-2.5,0.9c-0.5,0.2-1.1-0.1-1.3-0.6c-0.1-0.2-0.1-0.5,0-0.7l0.9-2.5l9.9-9.9L30.7,19.1z\\\" />\\n</g>\\n</symbol>\"\n});\nvar result = sprite.add(symbol);\nexport default symbol","/* global cozy */\nimport MuiCozyTheme from 'cozy-ui/transpiled/react/MuiCozyTheme'\nimport 'cozy-ui/dist/cozy-ui.utils.min.css'\nimport 'cozy-ui/transpiled/react/stylesheet.css'\nimport 'cozy-sharing/dist/stylesheet.css'\nimport 'styles'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport CozyClient, { CozyProvider } from 'cozy-client'\nimport { render } from 'react-dom'\nimport { I18n } from 'cozy-ui/react/I18n'\nimport { Document } from 'cozy-doctypes'\nimport SharingProvider from 'cozy-sharing'\n\nimport IsPublicContext from 'components/IsPublicContext'\nimport {\n  getDataset,\n  getDataOrDefault,\n  getPublicSharecode\n} from 'lib/initFromDom'\n\nconst manifest = require('../../../manifest.webapp')\n\nlet appLocale\nconst locales = {\n  en: {\n    react: require('react-intl/locale-data/en'),\n    atlaskit: require('@atlaskit/editor-core/dist/cjs/i18n/en').default\n  },\n  fr: {\n    react: require('react-intl/locale-data/fr'),\n    atlaskit: require('@atlaskit/editor-core/dist/cjs/i18n/fr').default\n  }\n}\naddLocaleData(locales.en.react)\naddLocaleData(locales.fr.react)\n\nconst renderApp = function(client, isPublic) {\n  const App = require('components/app').default\n\n  render(\n    <I18n\n      lang={appLocale}\n      dictRequire={appLocale => require(`locales/${appLocale}`)}\n    >\n      <IntlProvider locale={appLocale} messages={locales[appLocale].atlaskit}>\n        <CozyProvider client={client}>\n          <MuiCozyTheme>\n            <IsPublicContext.Provider value={isPublic}>\n              <SharingProvider doctype=\"io.cozy.files\" documentType=\"Notes\">\n                <App isPublic={isPublic} />\n              </SharingProvider>\n            </IsPublicContext.Provider>\n          </MuiCozyTheme>\n        </CozyProvider>\n      </IntlProvider>\n    </I18n>,\n    document.querySelector('[role=application]')\n  )\n}\n\n// initial rendering of the application\ndocument.addEventListener('DOMContentLoaded', () => {\n  const data = getDataset()\n\n  const appIcon = getDataOrDefault(\n    data.cozyIconPath,\n    require('../vendor/assets/icon.svg')\n  )\n  const appNamePrefix = getDataOrDefault(\n    data.cozyAppNamePrefix || manifest.name_prefix,\n    ''\n  )\n  const appName = getDataOrDefault(data.cozyAppName, manifest.name)\n  const appSlug = getDataOrDefault(data.cozyAppSlug, manifest.slug)\n  const appVersion = getDataOrDefault(data.cozyAppVersion, manifest.version)\n\n  appLocale = getDataOrDefault(data.cozyLocale, 'en')\n\n  const protocol = window.location ? window.location.protocol : 'https:'\n\n  const shareCode = getPublicSharecode()\n  const token = shareCode || data.cozyToken\n  const isPublic = shareCode || !token || token == ''\n\n  // initialize the client to interact with the cozy stack\n  const client = new CozyClient({\n    uri: `${protocol}//${data.cozyDomain}`,\n    token: token,\n    appMetadata: {\n      slug: appSlug,\n      version: appVersion\n    }\n  })\n  if (!Document.cozyClient) {\n    Document.registerClient(client)\n  }\n\n  if (!isPublic) {\n    // initialize the bar, common of all applications, it allows\n    // platform features like apps navigation without doing anything\n\n    // necessary to initialize the bar with the correct React instance\n    window.React = React\n    window.ReactDOM = ReactDOM\n    cozy.bar.init({\n      appName: appName,\n      appNamePrefix: appNamePrefix,\n      iconPath: appIcon,\n      lang: appLocale,\n      replaceTitleOnMobile: true,\n      cozyClient: client,\n      isPublic: isPublic\n    })\n  }\n\n  renderApp(client, isPublic)\n})\n","import React, { useEffect, useContext, useCallback, useRef } from 'react'\n\nimport { withClient } from 'cozy-client'\n\nimport EditorView from 'components/notes/editor-view'\nimport EditorLoading from 'components/notes/editor-loading'\nimport EditorLoadingError from 'components/notes/editor-loading-error'\nimport SharingWidget from 'components/notes/sharing'\nimport SavingIndicator from 'components/notes/saving-indicator'\nimport BackFromEditing from 'components/notes/back_from_editing'\nimport IsPublicContext from 'components/IsPublicContext'\nimport useNote from 'hooks/useNote'\nimport useServiceClient from 'hooks/useServiceClient'\nimport useCollabProvider from 'hooks/useCollabProvider'\nimport useTitleChanges from 'hooks/useTitleChanges'\nimport useForceSync from 'hooks/useForceSync'\nimport useReturnUrl from 'hooks/useReturnUrl'\nimport useUser from 'hooks/useUser'\nimport { useDebugValue } from 'lib/debug'\n\nimport useConfirmExit from 'cozy-ui/react/hooks/useConfirmExit'\nimport { useI18n } from 'cozy-ui/react/I18n'\n\nconst Editor = withClient(function(props) {\n  // base parameters\n  const { client: cozyClient, noteId, readOnly } = props\n  const { t } = useI18n()\n  const bannerRef = useRef() // where to display banners\n\n  // plugins and config\n  const isPublic = useContext(IsPublicContext)\n  const { userName, userId } = useUser({\n    userName: props.userName,\n    cozyClient\n  })\n  const serviceClient = useServiceClient({ userId, userName, cozyClient })\n  const { loading, title, doc, setTitle } = useNote({ serviceClient, noteId })\n  const returnUrl = useReturnUrl({\n    returnUrl: props.returnUrl,\n    cozyClient,\n    doc\n  })\n  const collabProvider = useCollabProvider({\n    noteId,\n    serviceClient,\n    doc\n  })\n\n  // callbacks\n  const { onLocalTitleChange } = useTitleChanges({\n    noteId,\n    title,\n    setTitle,\n    serviceClient\n  })\n  const { forceSync, emergencySync } = useForceSync({\n    doc,\n    collabProvider\n  })\n  // when leaving the component or changing doc\n  useEffect(() => forceSync, [noteId, doc, forceSync])\n  // when quitting the webpage\n  const activate = useCallback(() => collabProvider.isDirty(), [collabProvider])\n  const { exitConfirmationModal, requestToLeave } = useConfirmExit({\n    activate,\n    onLeave: emergencySync,\n    title: t('Notes.Editor.exit_confirmation_title'),\n    message: t('Notes.Editor.exit_confirmation_message'),\n    leaveLabel: t('Notes.Editor.exit_confirmation_leave'),\n    cancelLabel: t('Notes.Editor.exit_confirmation_cancel')\n  })\n\n  useDebugValue('client', cozyClient)\n  useDebugValue('notes.service', serviceClient)\n  useDebugValue('notes.collabProvider', collabProvider)\n  useDebugValue('notes.channel', collabProvider && collabProvider.channel)\n  useDebugValue('notes.noteId', noteId)\n  useDebugValue('notes.doc', doc && { ...doc.doc, version: doc.version })\n  useDebugValue('notes.file', doc && doc.file)\n  useDebugValue('notes.returnUrl', returnUrl)\n\n  // rendering\n  if (loading) {\n    return <EditorLoading />\n  } else if (doc) {\n    return (\n      <>\n        <EditorView\n          bannerRef={bannerRef}\n          readOnly={readOnly}\n          onTitleChange={onLocalTitleChange}\n          onTitleBlur={emergencySync}\n          collabProvider={collabProvider}\n          defaultTitle={t('Notes.Editor.title_placeholder')}\n          defaultValue={{ ...doc.doc, version: doc.version }}\n          title={title && title.length > 0 ? title : undefined}\n          leftComponent={\n            <BackFromEditing\n              returnUrl={returnUrl}\n              file={doc.file}\n              requestToLeave={requestToLeave}\n            />\n          }\n          rightComponent={!isPublic && <SharingWidget file={doc.file} />}\n        />\n        <SavingIndicator\n          collabProvider={collabProvider}\n          bannerRef={bannerRef}\n        />\n        {exitConfirmationModal}\n      </>\n    )\n  } else {\n    return <EditorLoadingError returnUrl={returnUrl} />\n  }\n})\n\nexport default Editor\n","import React, { useState, useCallback } from 'react'\n\nimport { withClient } from 'cozy-client'\n\nimport Button from 'cozy-ui/react/Button'\nimport { translate } from 'cozy-ui/react/I18n'\nimport BarButton from 'cozy-ui/react/BarButton'\n\nimport { createNoteDocument, generateReturnUrlToNotesIndex } from 'lib/utils'\n\nconst Add = ({ t, className, client }) => {\n  const [isWorking, setIsWorking] = useState(false)\n  const handleClick = useCallback(async () => {\n    setIsWorking(true)\n    const { data: doc } = await createNoteDocument(client)\n    window.location.href = generateReturnUrlToNotesIndex(doc)\n  }, [client])\n\n  return (\n    <Button\n      onClick={handleClick}\n      type=\"submit\"\n      busy={isWorking}\n      icon=\"plus\"\n      label={t('Notes.Add.add_note')}\n      extension=\"narrow\"\n      className={className}\n    />\n  )\n}\n\nexport const AddMobile = withClient(({ client }) => (\n  <BarButton\n    onClick={async () => {\n      const { data: doc } = await createNoteDocument(client)\n      window.location.href = generateReturnUrlToNotesIndex(doc)\n    }}\n    icon=\"plus\"\n    className=\"u-c-pointer\"\n  />\n))\nexport default translate()(withClient(Add))\n","import React from 'react'\nimport { MainTitle } from 'cozy-ui/react/Text'\nimport { translate } from 'cozy-ui/react/I18n'\nimport { withBreakpoints } from 'cozy-ui/react'\n\n//We don't not display the Title this way in Mobile.\n//We use Bar.centrer\nconst AppTitle = ({ t, breakpoints: { isMobile } }) => {\n  return !isMobile && <MainTitle>{t('Notes.List.latest_notes')}</MainTitle>\n}\n\nconst ConnectedAppTitle = withBreakpoints()(translate()(AppTitle))\n\nexport default ConnectedAppTitle\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"note-article\":\"note-article--2yQdC\",\"banner\":\"banner--1nSEd\",\"title\":\"title--2DQ8I\",\"titleInput\":\"titleInput--2ERlh\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sharing-button\":\"sharing-button--nzFli\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"empty\":\"empty--FqnXy\",\"appHeader\":\"appHeader--2ilS0\",\"tableSpecialRow\":\"tableSpecialRow--4oekp\",\"tableCellEmpty\":\"tableCellEmpty--21fZ1\",\"tableCellName\":\"tableCellName--2Jak9\",\"tableCell\":\"tableCell--3-jDP\",\"tableRow\":\"tableRow--3SicR\"};","import React from 'react'\n\nimport Spinner from 'cozy-ui/react/Spinner'\n\nfunction EditorLoading() {\n  return (\n    <div className=\"u-mv-3\">\n      <Spinner size=\"xxlarge\" middle />\n    </div>\n  )\n}\n\nexport default EditorLoading\n","// extracted by mini-css-extract-plugin","import 'url-search-params-polyfill'\n\nexport const getDataset = function() {\n  const root = document.querySelector('[role=application]')\n  return root.dataset\n}\n\n// return a defaultData if the template hasn't been replaced by cozy-stack\nexport const getDataOrDefault = function(toTest, defaultData) {\n  const templateRegex = /^\\{\\{\\.[a-zA-Z]*\\}\\}$/ // {{.Example}}\n  return templateRegex.test(toTest) ? defaultData : toTest\n}\n\nexport const getPublicSharecode = function() {\n  const search = new URLSearchParams(window.location.search)\n  return search.get('sharecode')\n}\n","import React from 'react'\nimport { Empty } from 'cozy-ui/react'\nimport { translate } from 'cozy-ui/react/I18n'\n\nfunction EditorLoadingError(props) {\n  const { t, returnUrl } = props\n\n  return (\n    <Empty\n      icon={'cross-small'}\n      title={t(`Error.loading_error_title`)}\n      text={\n        <p\n          className=\"u-mb-half\"\n          dangerouslySetInnerHTML={{\n            __html: returnUrl\n              ? t(`Error.loading_error_text_returnUrl`, { url: returnUrl })\n              : t(`Error.loading_error_text_noReturnUrl`)\n          }}\n        />\n      }\n    />\n  )\n}\n\nexport default translate()(EditorLoadingError)\n","module.exports = \"/img/icon.svg\";","import List from 'components/notes/List'\nimport Editor from 'components/notes/editor'\nimport Add from 'components/notes/add'\nimport Sharing from 'components/notes/sharing'\nimport Unshared from 'components/notes/unshared'\n\n//\nexport { List, Editor, Add, Sharing, Unshared }\n","import { useMemo, useContext } from 'react'\nimport IsPublicContext from 'components/IsPublicContext'\nimport { getShortNameFromClient, getUserNameFromUrl } from 'lib/utils.js'\n\nfunction useUser({ userName: providedUserName, cozyClient }) {\n  const isPublic = useContext(IsPublicContext)\n  const userName = useMemo(\n    () =>\n      providedUserName ||\n      getUserNameFromUrl() ||\n      (isPublic ? '?' : getShortNameFromClient(cozyClient)),\n    [cozyClient, providedUserName]\n  )\n  const userId = userName\n  return { userId, userName }\n}\n\nexport default useUser\n","import React, { useEffect, useCallback, useState } from 'react'\nimport { useI18n } from 'cozy-ui/react/I18n'\nimport { Text } from 'cozy-ui/react/Text'\nimport usePeriodicRender from 'cozy-ui/react/hooks/usePeriodicRender'\nimport useEventListener from 'cozy-ui/react/hooks/useEventListener'\nimport useBreakpoints from 'cozy-ui/react/hooks/useBreakpoints'\nimport styles from 'components/notes/saving-indicator.styl'\nimport throttle from 'lodash/throttle'\nimport { relativeAge } from 'lib/utils'\nimport OfflineIndicator from 'components/notes/offline-indicator'\n// constants\nconst sec = 1000\nconst keepOfflineOpenFor = 5 * sec\nconst outOfSyncAfter = 30 * sec\n\n/**\n * @typedef {object} SavingIndicatorProps\n * @property {CollabProviderDate} collabProvider\n * @property {Ref} bannerRef - Where to display banners\n */\n\n/**\n * Displays a saving indicator in the bottom right\n * and an offline indicator if needed\n *\n * @param {SavingIndicatorProps} props\n */\nfunction SavingIndicator(props) {\n  const { t } = useI18n()\n  const now = new Date()\n  const { isMobile } = useBreakpoints()\n\n  const [, setLastChange] = useState(undefined)\n  const [offlineSince, setOfflineSince] = useState(undefined)\n  const [isNavigatorOffline, setIsNavigatorOffline] = useState(\n    window && window.navigator && window.navigator.onLine === false\n  )\n  const setNavigatorOffline = useCallback(() => setIsNavigatorOffline(true), [\n    setIsNavigatorOffline\n  ])\n  const setNavigatorOnline = useCallback(() => setIsNavigatorOffline(false), [\n    setIsNavigatorOffline\n  ])\n  useEventListener(window, 'online', setNavigatorOnline)\n  useEventListener(window, 'offline', setNavigatorOffline)\n\n  const { collabProvider } = props\n  const isDirty = collabProvider.isDirty()\n  const dirtySince = collabProvider.getDirtySince()\n  const lastSave = collabProvider.getLastSaveOrSync()\n\n  let message\n\n  const savedAge = now - (lastSave || now)\n  const dirtyAge = now - dirtySince\n  const outOfSync = isDirty && dirtyAge && dirtyAge > outOfSyncAfter\n\n  const { key, time, interval } = relativeAge(savedAge)\n\n  if (isDirty) {\n    if (outOfSync) {\n      message = t(`Notes.SavingIndicator.out_of_sync.${key}`, { time })\n    } else if (dirtyAge > 5 * sec) {\n      message = t('Notes.SavingIndicator.still_saving')\n    } else {\n      message = t('Notes.SavingIndicator.saving')\n    }\n  } else {\n    message = t(`Notes.SavingIndicator.saved.${key}`, { time })\n  }\n\n  const isOffline = isNavigatorOffline || outOfSync\n  useEffect(() => {\n    setOfflineSince(isOffline && now)\n  }, [isOffline])\n\n  const offlineAge = isOffline && offlineSince && now - offlineSince\n  const isOfflineIndicatorOpen =\n    !offlineSince || (offlineAge && offlineAge < keepOfflineOpenFor)\n  const offlineInterval =\n    isOfflineIndicatorOpen &&\n    offlineSince &&\n    offlineSince + keepOfflineOpenFor - now\n\n  usePeriodicRender(\n    (offlineInterval && Math.min(offlineInterval, interval)) || interval\n  )\n\n  const onCollabStateChange = useCallback(\n    throttle(() => setLastChange(new Date()), 200),\n    [setLastChange]\n  )\n  useEffect(() => {\n    collabProvider.on('collab-state-change', onCollabStateChange)\n  }, [collabProvider, onCollabStateChange])\n\n  const text = <Text className={styles['saving-indicator']}>{message}</Text>\n  if (isOffline) {\n    return (\n      <OfflineIndicator\n        open={isOfflineIndicatorOpen}\n        bannerRef={props.bannerRef}\n      >\n        {text}\n      </OfflineIndicator>\n    )\n  } else {\n    if (isMobile) {\n      return null\n    } else {\n      return text\n    }\n  }\n}\n\nexport default SavingIndicator\n","import CozyRealtime from 'cozy-realtime'\n\nimport { schemaOrdered as defaultSchema } from './schema'\n\n// Warning: sessionID on the server, sessionId on the client\n\n/**\n * This is the communication layer with the server\n */\nexport class ServiceClient {\n  constructor(config) {\n    const { userId, cozyClient, schema, realtime } = config\n    const now = new Date()\n    const sessionSuffix =\n      now.getTime() + '.' + now.getMilliseconds() + '.' + Math.random()\n    this.sessionId = userId + ':' + sessionSuffix\n    this.userId = this.getUserId(userId)\n    this.cozyClient = cozyClient\n    this.stackClient = cozyClient.getStackClient()\n    this.schema = schema\n    this.onRealtimeEvent = this.onRealtimeEvent.bind(this)\n    this.realtime = realtime || new CozyRealtime({ client: cozyClient })\n    this.resetCallbacks()\n  }\n\n  /**\n   * Remove event listeners\n   */\n  resetCallbacks() {\n    this.callbacks = {}\n  }\n\n  /**\n   * Adds event listeners\n   */\n  setCallback(type, id, callback) {\n    this.callbacks[type] = this.callbacks[type] || {}\n    this.callbacks[type][id] = callback\n  }\n\n  /**\n   * @returns {string} Unique id for the user\n   */\n  getUserId(sessionId) {\n    return sessionId ? sessionId.match(/[^:]+/)[0] : this.userId\n  }\n\n  /**\n   * @returns {string} Unique id for the session\n   * It contains the user id + some unique part\n   */\n  getSessionId() {\n    return this.sessionId\n  }\n\n  /**\n   * Close communication with the server\n   * Remove all events listeners\n   */\n  close() {\n    this.realtime.unsubscribeAll()\n    this.resetCallbacks()\n  }\n\n  /**\n   * Get a default title for the note\n   */\n  defaultTitle() {\n    return new Date().toISOString()\n  }\n\n  /**\n   * @param {uuid} id - id of the note\n   * @param {string} sub - sub-path for the server route\n   * @returns {string} path for an API route on the cozy-stack\n   */\n  path(id, sub) {\n    return id ? (sub ? `/notes/${id}/${sub}` : `/notes/${id}`) : '/notes'\n  }\n\n  /**\n   * Convert data from the client format to the server format\n   */\n  client2server(data) {\n    return { sessionID: data.sessionId || this.sessionId, ...data }\n  }\n\n  /**\n   * Convert data from the server format to the client format\n   */\n  server2client(data) {\n    return {\n      sessionId: data.sessionID,\n      userId: this.getUserId(data.sessionID),\n      ...data\n    }\n  }\n\n  /**\n   * Create a new note on the server\n   * @param {string} title\n   * @param {Object} schema\n   */\n  async create(title, schema) {\n    const doc = {\n      data: {\n        type: 'io.cozy.notes.documents',\n        attributes: {\n          title: title || this.defaultTitle(),\n          schema: schema || this.schema || defaultSchema\n        }\n      }\n    }\n    return this.stackClient.fetchJSON('POST', this.path(), doc)\n  }\n\n  /**\n   * Force the note to be written to the io.cozy.files now\n   * @param {uuid} noteId - note id\n   */\n  async sync(noteId) {\n    await this.stackClient.fetchJSON('POST', this.path(noteId, 'sync'))\n  }\n\n  /**\n   * Change the title of a note\n   * @param {uuid} noteId\n   * @param {string} title\n   */\n  async setTitle(noteId, title) {\n    const titleDoc = {\n      data: {\n        type: 'io.cozy.notes.documents',\n        id: noteId,\n        attributes: this.client2server({ title: title })\n      }\n    }\n    await this.stackClient.fetchJSON(\n      'PUT',\n      this.path(noteId, 'title'),\n      titleDoc\n    )\n  }\n\n  /**\n   * Dispatch events from the server\n   * @param {Object} doc - received from the realtime of cozy-stack\n   */\n  onRealtimeEvent(doc) {\n    const id = doc.id || doc._id\n    const type = doc.doctype\n    if (this.callbacks[type] && this.callbacks[type][id]) {\n      return this.callbacks[type][id](doc)\n    } else {\n      // eslint-disable-next-line no-console\n      console.warn('Event not managed', type, id, this.callbacks)\n    }\n  }\n\n  /**\n   * Join a doc - listen to realtime events for this doc\n   * @param {uui} noteId\n   */\n  async join(noteId) {\n    await Promise.all([\n      this.realtime.subscribe(\n        null, // all events\n        'io.cozy.notes.events',\n        noteId,\n        this.onRealtimeEvent\n      )\n    ])\n  }\n\n  /**\n   * Listen for new steps from the server\n   * @param {uuid} noteId\n   * @param {Function} callback\n   */\n  async onStepsCreated(noteId, callback) {\n    this.setCallback('io.cozy.notes.steps', noteId, data =>\n      callback(this.server2client(data))\n    )\n  }\n\n  /**\n   * Listen for new cursors positions from the server\n   * @param {uuid} noteId\n   * @param {Function} callback\n   */\n  async onTelepointerUpdated(noteId, callback) {\n    this.setCallback('io.cozy.notes.telepointers', noteId, data =>\n      callback(this.server2client(data))\n    )\n  }\n\n  /**\n   * Listen for title changes in the document\n   * @param {uuid} noteId\n   * @param {Function} callback - function that get a title as paramerer\n   */\n  async onTitleUpdated(noteId, callback) {\n    this.setCallback('io.cozy.notes.documents', noteId, doc => {\n      return !doc.sessionID || doc.sessionID != this.sessionId\n        ? callback(doc.title)\n        : null\n    })\n  }\n\n  /**\n   * Get the full document for a note\n   * @param {uuid} noteId\n   */\n  async getDoc(noteId) {\n    const res = await this.stackClient.fetchJSON('GET', this.path(noteId))\n    return {\n      doc: res.data.attributes.metadata.content,\n      version: res.data.attributes.metadata.version,\n      title: res.data.attributes.metadata.title,\n      updatedAt: new Date(res.data.attributes.updated_at),\n      file: res.data\n    }\n  }\n\n  /**\n   * Push new local steps to the server\n   * @param {uuid} noteId\n   * @param {integer} version\n   * @param {Object[]} steps\n   */\n  async pushSteps(noteId, version, steps) {\n    const options = { headers: { 'if-match': version } }\n    const stepsDoc = {\n      data: steps.map(step => ({\n        type: 'io.cozy.notes.steps',\n        attributes: this.client2server(step.toJSON())\n      }))\n    }\n    // will throw in case of 409\n    // which will occurs if the server has more versions than us\n    await this.stackClient.fetchJSON(\n      'PATCH',\n      this.path(noteId),\n      stepsDoc,\n      options\n    )\n    return null\n  }\n\n  /**\n   * Fetch steps from the server since the provided versions\n   * @param {uuid} noteId\n   * @param {integer} version\n   * @returns {{version, steps}|{doc, version}}\n   * If the server doesn't have all requested steps in memory,\n   * it could returns the whole document in its current version\n   */\n  async getSteps(noteId, version) {\n    try {\n      const res = await this.stackClient.fetchJSON(\n        'GET',\n        `${this.path(noteId, 'steps')}?Version=${version}`\n      )\n      if (res.data.length == 0) {\n        return { steps: [], version }\n      } else {\n        const steps = res.data.map(step => this.server2client(step.attributes))\n        const version = res.data[res.data.length - 1].attributes.version\n        return { version, steps }\n      }\n    } catch (err) {\n      const response = err.response\n      const data = err.reason && err.reason.data\n      const meta = data && data.attributes && data.attributes.metadata\n      const doc = meta && meta.content\n      const ver = meta && meta.version\n      if (response.status == 412 && doc && ver) {\n        // server does not have all steps we try to fetch\n        // it responds with a full document and a title\n        const ev = 'io.cozy.notes.documents'\n        const realtimeDoc = {\n          _id: noteId,\n          _type: 'io.cozy.notes.events',\n          doctype: ev,\n          title: meta.title\n        }\n        if (this.callbacks[ev] && this.callbacks[ev][noteId]) {\n          this.callbacks[ev][noteId](realtimeDoc)\n        }\n        return {\n          doc: doc,\n          version: ver\n        }\n      } else {\n        throw err\n      }\n    }\n  }\n\n  /**\n   * Push new local cursor position to the server\n   * @param {uuid} noteId\n   * @param {Object} data\n   */\n  async pushTelepointer(noteId, data) {\n    const telepointerDoc = {\n      data: {\n        type: 'io.cozy.notes.telepointers',\n        id: noteId,\n        attributes: this.client2server(data)\n      }\n    }\n    return this.stackClient.fetchJSON(\n      'PUT',\n      this.path(noteId, 'telepointer'),\n      telepointerDoc\n    )\n  }\n}\nexport default ServiceClient\n","import { useState, useEffect } from 'react'\nimport { CozyFolder } from 'cozy-doctypes'\nimport { getDriveLink } from 'lib/utils'\n\nconst notesFolderDocument = {\n  _type: 'io.cozy.apps',\n  _id: 'io.cozy.apps/notes'\n}\n\nconst useReferencedFolderForNote = client => {\n  const [notesFolder, setNotesFolder] = useState(getDriveLink(client))\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const referencedFolder = await CozyFolder.getReferencedFolders(\n          notesFolderDocument\n        )\n        const folderUrl = getDriveLink(client, referencedFolder[0]._id)\n        setNotesFolder(folderUrl)\n      } catch (error) {\n        setNotesFolder(getDriveLink(client))\n      }\n    }\n    fetchData()\n  }, [client])\n\n  return {\n    notesFolder\n  }\n}\n\nexport default useReferencedFolderForNote\n","import { useMemo } from 'react'\nimport CollabProvider from 'lib/collab/provider'\n\n/**\n * @typedef {object} useCollabProviderParams\n * @property {integer|undefined} docVersion - current version of the doc\n * @property {string} noteId - uuid of the io.cozy.files for the note\n * @property {ServiceClient|undefined} serviceClient - ServiceClient instance\n */\n\n/**\n * Initialize a CollabProvider\n *\n * @param {useCollabProviderParams} params\n * @returns {CollabProvider|undefined}\n */\nfunction useCollabProvider({ doc, noteId, serviceClient }) {\n  return useMemo(() => {\n    const version = doc && doc.version\n    const updatedAt = doc && doc.updatedAt\n    if (serviceClient && doc !== undefined) {\n      const provider = new CollabProvider(\n        { version, noteId, updatedAt },\n        serviceClient\n      )\n      return provider\n    }\n  }, [noteId, doc, serviceClient])\n}\n\nexport default useCollabProvider\n","import { Schema } from 'prosemirror-model'\n\n// taken from a debug of @atlakit/editor/editor-core/create-editor/create-editor\n// L139 (new Schema({nodes ,marks}))\n// static because the @atlaskit code base requires a real navigator\n// TODO: either find and exclude plugins requiring interaction\n//       or running a JSDOM faking a navigator\n\nconst nodes = [\n  [\n    'doc',\n    {\n      content: '(block)+',\n      marks: 'link'\n    }\n  ],\n  [\n    'paragraph',\n    {\n      content: 'inline*',\n      group: 'block',\n      marks:\n        'strong code em link strike subsup textColor typeAheadQuery underline',\n      parseDOM: [\n        {\n          tag: 'p'\n        }\n      ]\n    }\n  ],\n  [\n    'text',\n    {\n      group: 'inline'\n    }\n  ],\n  [\n    'bulletList',\n    {\n      group: 'block',\n      content: 'listItem+',\n      parseDOM: [\n        {\n          tag: 'ul'\n        }\n      ]\n    }\n  ],\n  [\n    'orderedList',\n    {\n      group: 'block',\n      content: 'listItem+',\n      parseDOM: [\n        {\n          tag: 'ol'\n        }\n      ]\n    }\n  ],\n  [\n    'listItem',\n    {\n      content: '(paragraph ) (paragraph | bulletList | orderedList )*',\n      defining: true,\n      parseDOM: [\n        {\n          tag: 'li'\n        }\n      ]\n    }\n  ],\n  [\n    'heading',\n    {\n      attrs: {\n        level: {\n          default: 1\n        }\n      },\n      content: 'inline*',\n      group: 'block',\n      defining: true,\n      parseDOM: [\n        {\n          tag: 'h1',\n          attrs: {\n            level: 1\n          }\n        },\n        {\n          tag: 'h2',\n          attrs: {\n            level: 2\n          }\n        },\n        {\n          tag: 'h3',\n          attrs: {\n            level: 3\n          }\n        },\n        {\n          tag: 'h4',\n          attrs: {\n            level: 4\n          }\n        },\n        {\n          tag: 'h5',\n          attrs: {\n            level: 5\n          }\n        },\n        {\n          tag: 'h6',\n          attrs: {\n            level: 6\n          }\n        }\n      ]\n    }\n  ],\n  [\n    'blockquote',\n    {\n      content: 'paragraph+',\n      group: 'block',\n      defining: true,\n      selectable: false,\n      parseDOM: [\n        {\n          tag: 'blockquote'\n        }\n      ]\n    }\n  ],\n  [\n    'rule',\n    {\n      group: 'block',\n      parseDOM: [\n        {\n          tag: 'hr'\n        }\n      ]\n    }\n  ],\n  [\n    'panel',\n    {\n      group: 'block',\n      content: '(paragraph | heading | bulletList | orderedList)+',\n      attrs: {\n        panelType: {\n          default: 'info'\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-panel-type]'\n        }\n      ]\n    }\n  ],\n  [\n    'confluenceUnsupportedBlock',\n    {\n      group: 'block',\n      attrs: {\n        cxhtml: {\n          default: null\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-node-type=\"confluenceUnsupportedBlock\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'confluenceUnsupportedInline',\n    {\n      group: 'inline',\n      inline: true,\n      atom: true,\n      attrs: {\n        cxhtml: {\n          default: null\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'div[data-node-type=\"confluenceUnsupportedInline\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'unsupportedBlock',\n    {\n      inline: false,\n      group: 'block',\n      atom: true,\n      selectable: true,\n      attrs: {\n        originalValue: {\n          default: {}\n        }\n      },\n      parseDOM: [\n        {\n          tag: '[data-node-type=\"unsupportedBlock\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'unsupportedInline',\n    {\n      inline: true,\n      group: 'inline',\n      selectable: true,\n      attrs: {\n        originalValue: {\n          default: {}\n        }\n      },\n      parseDOM: [\n        {\n          tag: '[data-node-type=\"unsupportedInline\"]'\n        }\n      ]\n    }\n  ],\n  [\n    'hardBreak',\n    {\n      inline: true,\n      group: 'inline',\n      selectable: false,\n      parseDOM: [\n        {\n          tag: 'br'\n        }\n      ]\n    }\n  ],\n  [\n    'table',\n    {\n      content: 'tableRow+',\n      attrs: {\n        isNumberColumnEnabled: {\n          default: false\n        },\n        layout: {\n          default: 'default'\n        },\n        __autoSize: {\n          default: false\n        }\n      },\n      tableRole: 'table',\n      isolating: true,\n      selectable: false,\n      group: 'block',\n      parseDOM: [\n        {\n          tag: 'table'\n        }\n      ]\n    }\n  ],\n  [\n    'tableHeader',\n    {\n      content:\n        '(paragraph | panel | blockquote | orderedList | bulletList | rule | heading )+',\n      attrs: {\n        colspan: {\n          default: 1\n        },\n        rowspan: {\n          default: 1\n        },\n        colwidth: {\n          default: null\n        },\n        background: {\n          default: null\n        }\n      },\n      tableRole: 'header_cell',\n      isolating: true,\n      marks: '',\n      parseDOM: [\n        {\n          tag: 'th'\n        }\n      ]\n    }\n  ],\n  [\n    'tableRow',\n    {\n      content: '(tableCell | tableHeader)+',\n      tableRole: 'row',\n      parseDOM: [\n        {\n          tag: 'tr'\n        }\n      ]\n    }\n  ],\n  [\n    'tableCell',\n    {\n      content:\n        '(paragraph | panel | blockquote | orderedList | bulletList | rule | heading | unsupportedBlock)+',\n      attrs: {\n        colspan: {\n          default: 1\n        },\n        rowspan: {\n          default: 1\n        },\n        colwidth: {\n          default: null\n        },\n        background: {\n          default: null\n        }\n      },\n      tableRole: 'cell',\n      marks: '',\n      isolating: true,\n      parseDOM: [\n        {\n          tag: '.ak-renderer-table-number-column',\n          ignore: true\n        },\n        {\n          tag: 'td'\n        }\n      ]\n    }\n  ]\n]\n\nconst marks = [\n  [\n    'link',\n    {\n      excludes: 'color',\n      group: 'link',\n      attrs: {\n        href: {},\n        __confluenceMetadata: {\n          default: null\n        }\n      },\n      inclusive: false,\n      parseDOM: [\n        {\n          tag: 'a[href]'\n        }\n      ]\n    }\n  ],\n  [\n    'em',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'i'\n        },\n        {\n          tag: 'em'\n        },\n        {\n          style: 'font-style=italic'\n        }\n      ]\n    }\n  ],\n  [\n    'strong',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'strong'\n        },\n        {\n          tag: 'b'\n        },\n        {\n          style: 'font-weight'\n        }\n      ]\n    }\n  ],\n  [\n    'textColor',\n    {\n      attrs: {\n        color: {}\n      },\n      inclusive: true,\n      group: 'color',\n      parseDOM: [\n        {\n          style: 'color'\n        }\n      ]\n    }\n  ],\n  [\n    'strike',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'strike'\n        },\n        {\n          tag: 's'\n        },\n        {\n          tag: 'del'\n        },\n        {\n          style: 'text-decoration'\n        }\n      ]\n    }\n  ],\n  [\n    'subsup',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      attrs: {\n        type: {\n          default: 'sub'\n        }\n      },\n      parseDOM: [\n        {\n          tag: 'sub',\n          attrs: {\n            type: 'sub'\n          }\n        },\n        {\n          tag: 'sup',\n          attrs: {\n            type: 'sup'\n          }\n        }\n      ]\n    }\n  ],\n  [\n    'underline',\n    {\n      inclusive: true,\n      group: 'fontStyle',\n      parseDOM: [\n        {\n          tag: 'u'\n        },\n        {\n          style: 'text-decoration'\n        }\n      ]\n    }\n  ],\n  [\n    'code',\n    {\n      excludes: 'fontStyle link searchQuery color',\n      inclusive: true,\n      parseDOM: [\n        {\n          tag: 'span.code',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'code',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'tt',\n          preserveWhitespace: true\n        },\n        {\n          tag: 'span',\n          preserveWhitespace: true\n        }\n      ]\n    }\n  ],\n  [\n    'typeAheadQuery',\n    {\n      excludes: 'searchQuery',\n      inclusive: true,\n      group: 'searchQuery',\n      parseDOM: [\n        {\n          tag: 'span[data-type-ahead-query]'\n        }\n      ],\n      attrs: {\n        trigger: {\n          default: ''\n        }\n      }\n    }\n  ]\n]\n\nfunction orderedToObject(ordered) {\n  return ordered.reduce(function(acc, cur) {\n    acc[cur[0]] = cur[1]\n    return acc\n  }, {})\n}\n\nexport const schemaOrdered = {\n  nodes,\n  marks\n}\n\nexport const schemaObject = {\n  nodes: orderedToObject(nodes),\n  marks: orderedToObject(marks)\n}\n\nconst schema = new Schema(schemaObject)\n\nexport default schema\n","import React from 'react'\nimport { Empty } from 'cozy-ui/react'\nimport { translate } from 'cozy-ui/react/I18n'\n\nconst Unshared = translate()(({ t }) => (\n  <Empty\n    icon={'unlink'}\n    title={t(`Error.unshared_title`)}\n    text={t(`Error.unshared_text`)}\n  />\n))\n\nexport default Unshared\n","import { useMemo, useContext } from 'react'\nimport IsPublicContext from 'components/IsPublicContext'\nimport { getParentFolderLink } from 'lib/utils.js'\n\nfunction useReturnUrl({ returnUrl, cozyClient, doc }) {\n  const isPublic = useContext(IsPublicContext)\n\n  return useMemo(() => {\n    if (returnUrl !== undefined) {\n      return returnUrl\n    } else if (doc) {\n      return getParentFolderLink(cozyClient, doc.file)\n    } else if (!isPublic) {\n      return '/'\n    } else {\n      return undefined\n    }\n  }, [returnUrl, doc, isPublic, cozyClient])\n}\n\nexport default useReturnUrl\n","import React from 'react'\nimport { translate } from 'cozy-ui/react/I18n'\nimport Empty from 'cozy-ui/react/Empty'\nimport { withClient } from 'cozy-client'\n\nimport Add from 'components/notes/add'\nimport icon from 'assets/icons/icon_note_empty.svg'\nimport useReferencedFolderForNote from 'hooks/useReferencedFolderForNote'\n\nimport AppLinker from 'cozy-ui/react/AppLinker'\nconst EmptyComponent = ({ t, client }) => {\n  const { notesFolder } = useReferencedFolderForNote(client)\n  return (\n    <div className=\"empty\">\n      <Empty\n        id=\"empty\"\n        icon={icon}\n        title={t('Notes.Empty.welcome')}\n        text={\n          <AppLinker href={notesFolder} slug=\"drive\">\n            {({ href, onClick }) => {\n              return (\n                <span className=\"u-mb-half\">\n                  {t('Notes.Empty.after_created')}{' '}\n                  <a href={href} onClick={onClick}>\n                    Cozy Drive\n                  </a>\n                  .\n                </span>\n              )\n            }}\n          </AppLinker>\n        }\n      >\n        <Add className=\"u-mt-1\" />\n      </Empty>\n    </div>\n  )\n}\n\nexport default translate()(withClient(EmptyComponent))\n","import { useMemo, useEffect, useCallback } from 'react'\nimport { getAppFullName } from 'lib/utils.js'\n\nfunction useTitleChanges({ noteId, title, setTitle, serviceClient }) {\n  // Title change because of a local change from the editor\n  const onLocalTitleChange = useCallback(\n    serviceClient\n      ? e => {\n          const modifiedTitle = e.target.value\n          if (title != modifiedTitle) {\n            setTitle(modifiedTitle)\n            serviceClient.setTitle(noteId, modifiedTitle)\n          }\n        }\n      : () => {},\n    [noteId, title, setTitle, serviceClient]\n  )\n  // Title change because of a remote change from the stack\n  useEffect(() => {\n    serviceClient &&\n      serviceClient.onTitleUpdated(noteId, modifiedTitle => {\n        if (title != modifiedTitle) {\n          setTitle(modifiedTitle)\n        }\n      })\n  }, [title, setTitle, serviceClient, noteId])\n  // whatever the change is, keep the tab title updated\n  const appFullName = useMemo(getAppFullName, [])\n  useEffect(() => {\n    document.title =\n      title && title != '' ? `${title} - ${appFullName}` : appFullName\n  }, [appFullName, title])\n  return { onLocalTitleChange }\n}\n\nexport default useTitleChanges\n","// if you change something here,\n// you should update /lib/collab/schema.js\n// otherwise the server part won't work\nconst editorConfig = {\n  allowTables: true,\n  allowRule: true,\n  allowLists: true,\n  allowTextColor: true,\n  allowPanel: true,\n  allowCodeBlocks: false,\n  allowHelpDialog: false,\n  allowBlockTypes: { exclude: ['codeBlocks'] }\n}\n\nexport default editorConfig\n","import React, { useContext } from 'react'\nimport { Button, ButtonLink } from 'cozy-ui/react/Button'\nimport IsPublicContext from 'components/IsPublicContext'\nimport AppLinker from 'cozy-ui/react/AppLinker'\nimport { getFolderLink } from 'lib/utils'\nimport { models } from 'cozy-client'\n\n/**\n * Simple fake event to detect if the handler\n * tries to prevent the default action\n */\nclass FakeEvent {\n  preventDefault() {\n    this.prevented = true\n  }\n}\n\n/**\n * Create a click handler for a link or button\n *\n * Always call requestToLeave, with a function\n * that should mimic the original behaviour (onClick +  href)\n * @param {function} requestToLeave - as  in useConfirmExit in cozy-ui\n * @param {string} href - URL to go to\n * @param {function} onClick -  regular onClick handler for the button or link\n */\nfunction createOnClick(requestToLeave, href, onClick) {\n  const go = () => {\n    const ev = new FakeEvent()\n    if (onClick) onClick(ev)\n    if (!ev.prevented) document.location = href\n  }\n  return function(ev) {\n    ev.preventDefault()\n    requestToLeave(go)\n  }\n}\n\n/**\n * React component, draws a button to go back, outside of the editor\n *\n * Default is going back to the root of the app if in a private view\n * or do nothing if in a public view\n * @param {string|null} returnUrl - URL to go back to\n * @param {object|null} file - io.cozy.file object to generate a folder link\n * @param {function|null} requestToLeave - function, if present, it should\n * wrap any regular action that should have taken place when clicking the button\n */\nexport default function BackFromEditing({ returnUrl, file, requestToLeave }) {\n  const isPublic = useContext(IsPublicContext)\n\n  if (returnUrl) {\n    const folderId = models.file.getParentFolderId(file)\n    const nativePath = getFolderLink(folderId)\n    return (\n      <AppLinker slug=\"drive\" href={returnUrl} nativePath={nativePath}>\n        {({ onClick, href }) => {\n          return (\n            <ButtonLink\n              icon=\"previous\"\n              onClick={createOnClick(requestToLeave, href, onClick)}\n              href={href}\n              className=\"sto-app-back\"\n              subtle\n            />\n          )\n        }}\n      </AppLinker>\n    )\n  } else if (!isPublic) {\n    const href = '#/'\n    return (\n      <Button\n        icon=\"previous\"\n        href={href}\n        onClick={createOnClick(requestToLeave, href)}\n        className=\"sto-app-back\"\n        subtle\n      />\n    )\n  } else {\n    return null\n  }\n}\n","import { useCallback } from 'react'\n\nfunction useForceSync({ doc, collabProvider }) {\n  const noteId = doc && doc.file.id\n\n  const serviceClient = collabProvider && collabProvider.serviceClient\n  const channel = collabProvider && collabProvider.channel\n\n  // Be sure to save everything before leaving\n  // and force sync with the io.cozy.file\n  const forceSync = useCallback(\n    async function forceSync() {\n      if (doc && channel && serviceClient) {\n        // wait for every event to finish\n        await channel.ensureEmptyQueue()\n        // then force a server sync\n        await serviceClient.sync(noteId)\n      }\n    },\n    [doc, channel, serviceClient, noteId]\n  )\n\n  // Sync on unload will probably be stopped by the browser,\n  // as most async code on unload, but let's try anyway\n  const emergencySync = useCallback(\n    function() {\n      if (noteId && serviceClient) {\n        serviceClient.sync(noteId) // force a server sync\n      }\n    },\n    [noteId, serviceClient]\n  )\n\n  return { forceSync, emergencySync }\n}\n\nexport default useForceSync\n","var map = {\n\t\"./_lib/build_formatting_tokens_reg_exp/index.js\": \"kOWh\",\n\t\"./ar/build_distance_in_words_locale/index.js\": \"XxX6\",\n\t\"./ar/build_format_locale/index.js\": \"alis\",\n\t\"./ar/index.js\": \"EDRf\",\n\t\"./be/build_distance_in_words_locale/index.js\": \"LQ09\",\n\t\"./be/build_format_locale/index.js\": \"kj7F\",\n\t\"./be/index.js\": \"YEhR\",\n\t\"./bg/build_distance_in_words_locale/index.js\": \"7K3h\",\n\t\"./bg/build_format_locale/index.js\": \"RrdL\",\n\t\"./bg/index.js\": \"isx8\",\n\t\"./ca/build_distance_in_words_locale/index.js\": \"wqqj\",\n\t\"./ca/build_format_locale/index.js\": \"qcV0\",\n\t\"./ca/index.js\": \"Vwa+\",\n\t\"./cs/build_distance_in_words_locale/index.js\": \"ZKDM\",\n\t\"./cs/build_format_locale/index.js\": \"ipyF\",\n\t\"./cs/index.js\": \"dvhP\",\n\t\"./da/build_distance_in_words_locale/index.js\": \"2Mgc\",\n\t\"./da/build_format_locale/index.js\": \"Gned\",\n\t\"./da/index.js\": \"7ur/\",\n\t\"./de/build_distance_in_words_locale/index.js\": \"5IWf\",\n\t\"./de/build_format_locale/index.js\": \"THCn\",\n\t\"./de/index.js\": \"bgw5\",\n\t\"./el/build_distance_in_words_locale/index.js\": \"o/GB\",\n\t\"./el/build_format_locale/index.js\": \"8T9h\",\n\t\"./el/index.js\": \"dH0v\",\n\t\"./en/build_distance_in_words_locale/index.js\": \"LZbM\",\n\t\"./en/build_format_locale/index.js\": \"6DAA\",\n\t\"./en/index.js\": \"Us+F\",\n\t\"./eo/build_distance_in_words_locale/index.js\": \"qrnn\",\n\t\"./eo/build_format_locale/index.js\": \"Bl15\",\n\t\"./eo/index.js\": \"UB7v\",\n\t\"./es/build_distance_in_words_locale/index.js\": \"GEfZ\",\n\t\"./es/build_format_locale/index.js\": \"O+zC\",\n\t\"./es/index.js\": \"/S0t\",\n\t\"./fi/build_distance_in_words_locale/index.js\": \"VHtQ\",\n\t\"./fi/build_format_locale/index.js\": \"Oydx\",\n\t\"./fi/index.js\": \"ndVD\",\n\t\"./fil/build_distance_in_words_locale/index.js\": \"uq4p\",\n\t\"./fil/build_format_locale/index.js\": \"d7hw\",\n\t\"./fil/index.js\": \"pNfm\",\n\t\"./fr/build_distance_in_words_locale/index.js\": \"IzMR\",\n\t\"./fr/build_format_locale/index.js\": \"I3Zg\",\n\t\"./fr/index.js\": \"LKA2\",\n\t\"./hr/build_distance_in_words_locale/index.js\": \"DPvn\",\n\t\"./hr/build_format_locale/index.js\": \"puw3\",\n\t\"./hr/index.js\": \"L9Jq\",\n\t\"./hu/build_distance_in_words_locale/index.js\": \"w2RQ\",\n\t\"./hu/build_format_locale/index.js\": \"/0iD\",\n\t\"./hu/index.js\": \"Nm+E\",\n\t\"./id/build_distance_in_words_locale/index.js\": \"JbvB\",\n\t\"./id/build_format_locale/index.js\": \"0wlw\",\n\t\"./id/index.js\": \"A6C3\",\n\t\"./is/build_distance_in_words_locale/index.js\": \"qzMC\",\n\t\"./is/build_format_locale/index.js\": \"S3yD\",\n\t\"./is/index.js\": \"N4bE\",\n\t\"./it/build_distance_in_words_locale/index.js\": \"MDEp\",\n\t\"./it/build_format_locale/index.js\": \"aUJd\",\n\t\"./it/index.js\": \"hmb4\",\n\t\"./ja/build_distance_in_words_locale/index.js\": \"nNvt\",\n\t\"./ja/build_format_locale/index.js\": \"buui\",\n\t\"./ja/index.js\": \"uAXs\",\n\t\"./ko/build_distance_in_words_locale/index.js\": \"oEw+\",\n\t\"./ko/build_format_locale/index.js\": \"9SQf\",\n\t\"./ko/index.js\": \"iW8+\",\n\t\"./mk/build_distance_in_words_locale/index.js\": \"nmwZ\",\n\t\"./mk/build_format_locale/index.js\": \"htxJ\",\n\t\"./mk/index.js\": \"GzBU\",\n\t\"./nb/build_distance_in_words_locale/index.js\": \"SL1f\",\n\t\"./nb/build_format_locale/index.js\": \"CJ5F\",\n\t\"./nb/index.js\": \"73vv\",\n\t\"./nl/build_distance_in_words_locale/index.js\": \"Uyu0\",\n\t\"./nl/build_format_locale/index.js\": \"doCD\",\n\t\"./nl/index.js\": \"hCQt\",\n\t\"./pl/build_distance_in_words_locale/index.js\": \"FUBD\",\n\t\"./pl/build_format_locale/index.js\": \"nOYf\",\n\t\"./pl/index.js\": \"B6yL\",\n\t\"./pt/build_distance_in_words_locale/index.js\": \"aTPA\",\n\t\"./pt/build_format_locale/index.js\": \"TTT0\",\n\t\"./pt/index.js\": \"gdks\",\n\t\"./ro/build_distance_in_words_locale/index.js\": \"gI+A\",\n\t\"./ro/build_format_locale/index.js\": \"njjO\",\n\t\"./ro/index.js\": \"r2yp\",\n\t\"./ru/build_distance_in_words_locale/index.js\": \"KmPx\",\n\t\"./ru/build_format_locale/index.js\": \"UUBw\",\n\t\"./ru/index.js\": \"nz/o\",\n\t\"./sk/build_distance_in_words_locale/index.js\": \"q2Bs\",\n\t\"./sk/build_format_locale/index.js\": \"9sxn\",\n\t\"./sk/index.js\": \"Wqan\",\n\t\"./sl/build_distance_in_words_locale/index.js\": \"mlv2\",\n\t\"./sl/build_format_locale/index.js\": \"vHkZ\",\n\t\"./sl/index.js\": \"KYSo\",\n\t\"./sr/build_distance_in_words_locale/index.js\": \"LlkS\",\n\t\"./sr/build_format_locale/index.js\": \"RhjJ\",\n\t\"./sr/index.js\": \"7mU3\",\n\t\"./sv/build_distance_in_words_locale/index.js\": \"UNBN\",\n\t\"./sv/build_format_locale/index.js\": \"zTNB\",\n\t\"./sv/index.js\": \"hxgj\",\n\t\"./th/build_distance_in_words_locale/index.js\": \"XAGa\",\n\t\"./th/build_format_locale/index.js\": \"We2s\",\n\t\"./th/index.js\": \"Pk+z\",\n\t\"./tr/build_distance_in_words_locale/index.js\": \"aFZF\",\n\t\"./tr/build_format_locale/index.js\": \"jh7A\",\n\t\"./tr/index.js\": \"3ZWG\",\n\t\"./zh_cn/build_distance_in_words_locale/index.js\": \"KdB7\",\n\t\"./zh_cn/build_format_locale/index.js\": \"l4EP\",\n\t\"./zh_cn/index.js\": \"8tMq\",\n\t\"./zh_tw/build_distance_in_words_locale/index.js\": \"vyyr\",\n\t\"./zh_tw/build_format_locale/index.js\": \"uYH7\",\n\t\"./zh_tw/index.js\": \"QPlQ\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"nw0P\";","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Grid } from '@material-ui/core'\nimport Icon from 'cozy-ui/react/Icon'\nimport Chip from 'cozy-ui/react/Chip'\nimport Tooltip from 'cozy-ui/react/Tooltip'\nimport { useI18n } from 'cozy-ui/react/I18n'\nimport useBreakpoints from 'cozy-ui/react/hooks/useBreakpoints'\nimport { withStyles } from '@material-ui/core/styles'\n\nimport styles from 'components/notes/offline-indicator.styl'\n\nconst tooltipStyles = {\n  tooltipPlacementBottom: {\n    margin: '12px 24px'\n  },\n  tooltipPlacementTop: {\n    margin: '12px 24px'\n  }\n}\nconst StyledTooltip = withStyles(tooltipStyles, { name: 'MuiTooltip' })(Tooltip)\n\n/**\n * Large tooltip, for browser view\n *\n * @param {object} props\n * @param {boolean} props.open - true if we should force the tooltip to be opened\n * @param {*} props.content - what to display inside the banner\n * @param {*} props.children - the saving indicator\n */\nfunction Balloon(props) {\n  // We add a dynamic `key`property to throw the old\n  // instance and get a new one if the `open` property changes.\n  // This is because we want to force the tooltip to be open\n  // for a few seconds (and MUI initializes the component to\n  // a controlled one) but we want the automatic (no-controlled)\n  // mode afterwards\n  return (\n    <StyledTooltip\n      title={props.content}\n      open={props.open || undefined}\n      key={props.open ? 'open' : 'auto'}\n    >\n      {props.children}\n    </StyledTooltip>\n  )\n}\n\n/**\n * Banner on top of the editor, for mobile view\n *\n * @param {object} props\n * @param {Ref} props.bannerRef - where to display the banner\n * @param {*} props.content - what to display inside the banner\n * @param {*} props.children - the saving indicator\n */\nfunction Banner(props) {\n  const ref = props.bannerRef && props.bannerRef.current\n  if (ref) {\n    return ReactDOM.createPortal(\n      <div className={styles.banner}>{props.content}</div>,\n      ref\n    )\n  }\n  return null\n}\n\n/**\n * Adds an indicator when offline\n *\n * It's mapped to a tooltip for browser views\n * and to a banner for mobile views\n * @param {object} props\n * @param {boolean} props.open - true if we should force the tooltip to be opened\n * @param {Ref} props.bannerRef - where to display the banner\n * @param {*} props.children - the saving indicator\n */\nexport default function OfflineIndicator(props) {\n  const { t } = useI18n()\n  const { isMobile } = useBreakpoints()\n  const content = (\n    <Grid\n      direction=\"row\"\n      container\n      wrap=\"nowrap\"\n      spacing={16}\n      className={styles.grid}\n    >\n      <Grid item>\n        <Chip.Round className={styles.chip}>\n          <Icon icon=\"offline\" color=\"var(--black)\" />\n        </Chip.Round>\n      </Grid>\n      <Grid item>{t('Notes.OfflineIndicator.message')}</Grid>\n    </Grid>\n  )\n  const Component = isMobile ? Banner : Balloon\n  return (\n    <Component open={props.open} content={content} bannerRef={props.bannerRef}>\n      {props.children}\n    </Component>\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { models } from 'cozy-client'\n\nfunction useFileWithPath({ cozyClient, file }) {\n  const [fileWithPath, setFileWithPath] = useState(undefined)\n\n  useEffect(() => {\n    async function getParent(rawFile) {\n      const file = models.file.normalize(rawFile)\n      try {\n        const parent = await cozyClient.query(\n          cozyClient.get('io.cozy.files', file.attributes.dir_id)\n        )\n        setFileWithPath(models.file.ensureFilePath(file, parent.data))\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Request failed when try to fetch the parent ${file.attributes.dir_id} of io.cozy.files ${file.id}`\n        )\n        setFileWithPath(null)\n        // nothing to do here\n        // @TODO send a sentry event\n      }\n    }\n\n    getParent(file)\n  }, [cozyClient, file, file.attributes.dir_id])\n\n  if (fileWithPath && fileWithPath.id == file.id) {\n    return fileWithPath\n  } else {\n    return undefined\n  }\n}\n\nexport default useFileWithPath\n","/* global cozy */\nimport React, { useState, useEffect, useMemo } from 'react'\nimport { hot } from 'react-hot-loader'\nimport { Route, Switch, HashRouter, withRouter } from 'react-router-dom'\nimport { withClient } from 'cozy-client'\n\nimport { Alerter, withBreakpoints } from 'cozy-ui/react'\nimport { Layout, Main, Content } from 'cozy-ui/react/Layout'\nimport { Sprite as IconSprite } from 'cozy-ui/react/Icon'\nimport Spinner from 'cozy-ui/react/Spinner'\nimport AppTitle from 'cozy-ui/react/AppTitle'\nimport { BreakpointsProvider } from 'cozy-ui/react/hooks/useBreakpoints'\n\nconst manifest = require('../../manifest.webapp')\nimport { List, Editor, Unshared } from 'components/notes'\nimport { getReturnUrl, getSharedDocument } from 'lib/utils'\nimport { useFlagSwitcher } from 'lib/debug'\n\nimport { getDataOrDefault } from 'lib/initFromDom'\nimport { fetchIfIsNoteReadOnly } from '../lib/utils'\n\nconst RoutedEditor = withRouter(props => {\n  const returnUrl = getReturnUrl()\n\n  return <Editor noteId={props.match.params.id} returnUrl={returnUrl} />\n})\n\nconst PrivateContext = () => (\n  <Switch>\n    <Route path=\"/n/:id\" component={RoutedEditor} />\n    <Route path=\"/\" component={List} />\n  </Switch>\n)\n\nconst PublicContext = withClient(({ client }) => {\n  const [sharedDocumentId, setSharedDocumentId] = useState(null)\n  const [readOnly, setReadOnly] = useState(false)\n  const returnUrl = useMemo(() => getReturnUrl(), [])\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const searchParams = new URLSearchParams(window.location.search)\n        if (searchParams.has('id')) {\n          // public route = /public/?sharecode=xxxx&id=xxxxx\n          // The id of the note is necessary because the sharecode\n          // may be about a folder and not a specific note.\n          const id = searchParams.get('id')\n          const readOnly = await fetchIfIsNoteReadOnly(client, id)\n          setReadOnly(readOnly)\n          setSharedDocumentId(id)\n        } else {\n          // public route = /public/?sharecode=xxxxx\n          // There is no id. It should be a sharecode\n          // dedicated to a unique note. We look into\n          // permissions and try to open the first file.\n          const { id, readOnly } = await getSharedDocument(client)\n          setReadOnly(readOnly)\n          setSharedDocumentId(id)\n        }\n      } catch {\n        setSharedDocumentId(false)\n      }\n    }\n    fetchData()\n  }, [client])\n  if (sharedDocumentId) {\n    return (\n      <Editor\n        readOnly={readOnly}\n        noteId={sharedDocumentId}\n        returnUrl={returnUrl || false}\n      />\n    )\n  } else if (sharedDocumentId !== null) {\n    return <Unshared />\n  } else {\n    return <Spinner size=\"xxlarge\" middle />\n  }\n})\n\nconst App = ({ isPublic, breakpoints: { isMobile }, client }) => {\n  let appName = ''\n  if (isMobile) {\n    const data = client.getInstanceOptions()\n    appName = getDataOrDefault(data.cozyAppName, manifest.name)\n  }\n  const { BarCenter } = cozy.bar\n  const FlagSwitcher = useFlagSwitcher()\n  return (\n    <BreakpointsProvider>\n      <HashRouter>\n        <Layout monoColumn={true}>\n          {!isPublic && isMobile && (\n            <BarCenter>\n              <AppTitle>{appName}</AppTitle>\n            </BarCenter>\n          )}\n          <Main>\n            <Content>\n              {isPublic ? <PublicContext /> : <PrivateContext />}\n            </Content>\n          </Main>\n          <IconSprite />\n          <Alerter />\n          <FlagSwitcher />\n        </Layout>\n      </HashRouter>\n    </BreakpointsProvider>\n  )\n}\n\n/*\n  Enable Hot Module Reload using `react-hot-loader` here\n  We enable it here since App is the main root component\n  No need to use it anywhere else, it sould work for all\n  child components\n*/\nexport default hot(module)(withBreakpoints()(withClient(App)))\n","module.exports = {\"name\":\"Notes\",\"name_prefix\":\"Cozy\",\"slug\":\"notes\",\"icon\":\"icon.svg\",\"categories\":[\"cozy\"],\"version\":\"1.11.0\",\"licence\":\"AGPL-3.0\",\"editor\":\"Cozy\",\"source\":\"https://github.com/cozy/cozy-notes.git@build\",\"developer\":{\"name\":\"Cozy Cloud\",\"url\":\"https://cozy.io\"},\"screenshots\":[\"screenshots/fr/screenshot01.png\",\"screenshots/fr/screenshot02.png\"],\"langs\":[\"en\",\"fr\"],\"routes\":{\"/\":{\"folder\":\"/\",\"index\":\"index.html\",\"public\":false},\"/public\":{\"folder\":\"/\",\"index\":\"index.html\",\"public\":true}},\"permissions\":{\"apps\":{\"description\":\"Required by the cozy-bar to display the icons of the apps\",\"type\":\"io.cozy.apps\",\"verbs\":[\"GET\"]},\"files\":{\"description\":\"Notes as files\",\"type\":\"io.cozy.files\"},\"contacts\":{\"type\":\"io.cozy.contacts\",\"verbs\":[\"GET\",\"POST\"]},\"groups\":{\"type\":\"io.cozy.contacts.groups\",\"verbs\":[\"GET\"]},\"settings\":{\"description\":\"Required by the cozy-bar to display Claudy and know which applications are coming soon\",\"type\":\"io.cozy.settings\",\"verbs\":[\"GET\"]}}}","import get from 'lodash/get'\nimport { generateWebLink } from 'cozy-ui/transpiled/react/AppLinker'\nimport { getDataset, getDataOrDefault } from './initFromDom'\nimport { schemaOrdered } from 'lib/collab/schema'\nimport { models } from 'cozy-client'\n\nimport manifest from '../../manifest.webapp'\n\nexport function getShortNameFromClient(client) {\n  const url = new URL(client.getStackClient().uri)\n  return url.hostname + Math.floor(Math.random() * 100)\n}\n\nconst returnUrlKey = 'returnUrl'\n\nexport function getReturnUrl() {\n  const searchParams = new URLSearchParams(window.location.search)\n  for (const [key, value] of searchParams) {\n    if (key === returnUrlKey) {\n      return value\n    }\n  }\n  return undefined\n}\n\nexport const generateReturnUrlToNotesIndex = doc => {\n  const url = new URL(window.location)\n  url.searchParams.set(returnUrlKey, '#/')\n  url.hash = `#/n/${doc.id}`\n  return url\n}\n\n/**\n * Get permissions on io.cozy.files for current context\n * @private\n * @param {CozyClient} client\n * @returns {object}\n */\nasync function getFilesOwnPermissions(client) {\n  const permissionsData = await client\n    .collection('io.cozy.permissions')\n    .getOwnPermissions()\n  const permissionObject = get(permissionsData, 'data.attributes.permissions')\n  if (!permissionObject) throw `can't get self permissions`\n  const permissions = Object.values(permissionObject)\n  return permissions.filter(perm =>\n    models.permission.isForType(perm, 'io.cozy.files')\n  )\n}\n\n/**\n * Get a file by it's id\n * @private\n * @param {CozyClient} client\n * @param {string} id\n */\nasync function getFile(client, id) {\n  return client\n    .query(client.find('io.cozy.files').getById(id))\n    .then(data => data && data.data)\n}\n\n/**\n * Checks if the note is read-only or read-write\n *\n * @param {CozyClient} client\n * @param {string} fileId - io.cozy.files id\n * @returns {bool}\n */\nexport async function fetchIfIsNoteReadOnly(client, fileId) {\n  const document = await getFile(client, fileId)\n  return models.permission.isDocumentReadOnly({\n    document,\n    client,\n    writability: ['PATCH']\n  })\n}\n\n/**\n * Get the first shared document for the current shared token\n *\n * @param {CozyClient} client\n * @returns {{id, readOnly}} id of the document and the readOnly status\n */\nexport async function getSharedDocument(client) {\n  const permissions = (await getFilesOwnPermissions(client)).filter(\n    p =>\n      models.permission.isForType(p, 'io.cozy.files') &&\n      p.values &&\n      p.values.length > 0\n  )\n\n  if (permissions.length < 1) {\n    throw new Error(\n      'No individual io.cozy.files permissions in current context'\n    )\n  } else if (permissions.length > 1 || permissions[0].values.length > 1) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      `There are more than one permission for a file in current context. Let's take the first one, but it may not be the one you expect`\n    )\n  }\n  const perm = permissions[0]\n  const sharedDocumentId = perm.values[0]\n  const readOnly = models.permission.isReadOnly(perm, {\n    writability: ['PATCH']\n  })\n  return { id: sharedDocumentId, readOnly }\n}\n\nexport function getFolderLink(id) {\n  return `/folder/${id}`\n}\n\nexport function getDriveLink(client, id = null) {\n  const cozyURL = new URL(client.getStackClient().uri)\n  const { cozySubdomainType } = client.getInstanceOptions()\n  const driveSlug = 'drive'\n  const pathForDrive = id !== null ? getFolderLink(id) : ''\n\n  const webUrl = generateWebLink({\n    cozyUrl: cozyURL.origin,\n    slug: driveSlug,\n    subDomainType: cozySubdomainType,\n    nativePath: pathForDrive\n  })\n\n  return webUrl\n}\n\nexport function getParentFolderLink(client, file) {\n  return getDriveLink(client, models.file.getParentFolderId(file))\n}\n\nexport function getAppFullName() {\n  const dataset = getDataset()\n  const appNamePrefix = getDataOrDefault(\n    dataset.cozyAppNamePrefix || manifest.name_prefix,\n    ''\n  )\n  const appName = getDataOrDefault(dataset.cozyAppName, manifest.name)\n  return appNamePrefix != '' ? `${appNamePrefix} ${appName}` : appName\n}\n\nexport function createNoteDocument(client) {\n  return client.getStackClient().fetchJSON('POST', '/notes', {\n    data: {\n      type: 'io.cozy.notes.documents',\n      attributes: {\n        title: '',\n        schema: schemaOrdered\n      }\n    }\n  })\n}\n\n// constants\nconst sec = 1000\nconst min = 60 * sec\nconst hour = 60 * min\nconst day = 24 * hour\nconst month = 31 * day\nconst year = 365 * day\n\n// differents steps for message formating\n// [age, key, unit, coef] :\n// - `age`: the line applies only if the last saved\n// was done less than this `age` ago\n// (only the first match will apply)\n// - `key` is the traduction key for the message\n// - `unit` is the unit in which we will send the time\n// to the translated message\n// - `coef` is  the granularity in which we will send\n// the time (`min, 5` is \"by 5 minutes slices\")\nconst defaultSteps = [\n  [10 * sec, 'just_now', sec, 1],\n  [1 * min, 'secs_ago', sec, 10],\n  [2 * min, 'min_ago', min, 1],\n  [5 * min, 'mins_ago', min, 1],\n  [20 * min, 'mins_ago', min, 5],\n  [1 * hour, 'mins_ago', min, 10],\n  [2 * hour, 'hour_ago', hour, 1],\n  [1 * day, 'hours_ago', hour, 1],\n  [2 * day, 'day_ago', day, 1],\n  [1 * month, 'days_ago', day, 1],\n  [2 * month, 'month_ago', month, 1],\n  [1 * year, 'monthes_ago', month, 1],\n  [2 * year, 'year_ago', year, 1],\n  [Infinity, 'years_ago', year, 1]\n]\n\n/**\n * @typedef {object} RelativeAge\n * @property {string} key - translation (sub) key\n * @property {unit} unit - unit (minute, second, hour…) in which the age will be displayed\n * @property {integer} coef - in how much values of this unit do we count (like every 10 minutes)\n * @property {integer} time - age to be inserted in the translation message\n * @property {integer} interval - `unit * coef`: compute again in that timeframe (in milliseconds)\n */\n/**\n * Gets raw data to display a relative age in human words\n * @param {integer} age - age in milliseconds\n * @param {array} steps - array of [max_age, key, unit, coef]\n * @returns {RelativeAge}\n */\nexport function relativeAge(age, steps) {\n  const step = (steps || defaultSteps).find(el => age < el[0])\n  const [, key, unit, coef] = step\n  return {\n    key,\n    unit,\n    coef,\n    time: Math.floor(age / unit / coef) * coef,\n    interval: unit * coef\n  }\n}\n\n/**\n * Gets the username defined by the current URL, if any\n *\n * @returns {string|null} username\n */\nexport function getUserNameFromUrl() {\n  const searchParams = new URLSearchParams(window.location.search)\n  if (searchParams.has('username')) {\n    return searchParams.get('username')\n  } else {\n    return null\n  }\n}\n","import SpriteSymbol from \"../../../node_modules/svg-baker-runtime/browser-symbol.js\";\nimport sprite from \"../../../node_modules/svg-sprite-loader/runtime/browser-sprite.build.js\";\nvar symbol = new SpriteSymbol({\n  \"id\": \"icon_note_empty_77efa79dd615f19897a8ed6ec9097298\",\n  \"use\": \"icon_note_empty_77efa79dd615f19897a8ed6ec9097298-usage\",\n  \"viewBox\": \"0 0 171 168\",\n  \"content\": \"<symbol xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0 0 171 168\\\" id=\\\"icon_note_empty_77efa79dd615f19897a8ed6ec9097298\\\">\\n    <defs>\\n        <path id=\\\"icon_note_empty_77efa79dd615f19897a8ed6ec9097298_a\\\" d=\\\"M.02.12h36.532v20.674H.02z\\\" />\\n    </defs>\\n    <g fill=\\\"none\\\" fill-rule=\\\"evenodd\\\">\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M48.367 47.28c3.795-4.135 9.702 2.27 5.938 6.374-8.105 8.832-11.21 22.848-5.617 33.864 6.83 13.453 25.138 8.377 36.387 4.37 5.26-1.871 7.054 6.655 1.834 8.515-15.343 5.464-37.282 8.714-45.942-8.858-7.276-14.767-3.455-32.433 7.4-44.265\\\" />\\n        <path fill=\\\"#D6FAFB\\\" d=\\\"M59.57 16.922c.739-4.162 1.797-8.167 3.764-11.417C66.807-.21 73.009-.675 79.69.561c3.047.47 76.99 11.012 78.873 11.76 6.957 2.843 7.343 8.129 5.837 14.148-.141.971-20.067 84.443-21.43 88.854-1.852 5.978-4.906 11.375-10.609 11.973-5.714.623-75.27-18.403-78.5-19.534-3.954-1.39-5.72-3.632-6.159-6.323-.603-1.443-.376-3.088-.067-5.144.8-5.412 8.228-69.79 11.935-79.373\\\" />\\n        <path fill=\\\"#FFF\\\" d=\\\"M65.047 19.073S64.561 3.301 79.004 5.122c14.443 1.819 89.593 13.951 89.593 13.951v9.972l-15.17 7.281-88.38-17.253z\\\" />\\n        <path fill=\\\"#ACF5F7\\\" d=\\\"M53.622 31.458c.246-4.25.829-8.372 2.413-11.844 2.795-6.122 8.927-7.314 15.747-6.87 3.103.105 6.245.706 8.959 1.155 13.33 2.21 60.933 9.536 62.437 9.936.853.239 3.242 1.012 3.93 1.337 5.173 2.422 4.26 6.643 3.56 12.102-.023.988-10.066 86.694-10.903 91.263-1.155 6.187-3.561 11.933-9.185 13.21-5.636 1.297-77.342-9.496-80.695-10.235-4.111-.928-6.143-2.958-6.897-5.597-.781-1.368-.738-3.034-.675-5.12.157-5.506 8.735-79.333 11.309-89.337\\\" />\\n        <path fill=\\\"#79ECEE\\\" d=\\\"M134.818 99.416c4.069-24.17 8.504-48.43 11.948-72.677.037-.293.209-1.305.35-1.515-.04-.744 2.317.264 4.506.067.068 0 .925-.114.992-.114.716-.138 1.42-.29 2.149-.552 3.554-1.285 4.98-4.27 4.938-7.584-.046-2.971-2.376-4.28-2.285-5.071.047-.427 2.619.902 2.915 1 .405.133 3.131 1.892 4.372 4.065 1.249 2.19.856 5.296.785 8.049-.244 9.277-8.008 66.518-9.51 78.49.026.153-.358 3.1-.546 4.417-.38 2.901-.772 5.807-1.182 8.707-.319 2.271-1.653 15.153-1.929 15.747-3.391 7.361-12.892 9.872-20.513 9.34-.434.025-.851-.016-1.524-.102-.844-.108-2.024.034-3.35-.235.145-2.458 5.937-30.472 7.884-42.032\\\" />\\n        <path fill=\\\"#FFF\\\" d=\\\"M98.24 56.354c3.65-6.425 11.472-9.96 18.354-7.212a10.488 10.488 0 0 1 4.359 2.129c.117.074.22.173.33.253.099.086.2.171.29.253a10.141 10.141 0 0 1 3.012 3.703c.14.243.285.483.408.733.028.087.095.136.12.22.089.233.126.462.208.7.4 1.024.667 2.088.785 3.213.399 2.397.348 4.8-.468 7.371-1.431 4.512-6.871 6.769-11.066 7.466-3.062.503-6.549-.22-9.546-1.52-4.286-1.86-5.61-4.269-6.733-7.469-1.146-3.274-1.878-6.632-.054-9.84M57.875 49.863c1.7-3.323 4.417-5.416 7.697-6.62.072-.048.117-.104.197-.162 2.037-1.45 4.806-2 7.4-1.642 6.076.399 11.603 5.645 13.426 11.64.926 3.055.816 6.827-.747 9.66-2.345 4.249-6.24 6.338-10.86 7.305-7.715 1.625-16.183-3.686-18.103-11.22-.745-2.904-.38-6.293.99-8.961\\\" />\\n        <path fill=\\\"#FFF\\\" d=\\\"M97.573 60.005c.542 1.111 2.285 1.832 3.325 1.161 1.116-.715 1.315-2.42.479-3.462-.451-.557-1.063-.82-1.666-.79a.296.296 0 0 0-.235-.062c-1.392.108-2.635 1.68-1.903 3.153M82.511 58.042c.543 1.11 2.287 1.83 3.325 1.159 1.12-.72 1.318-2.42.479-3.46-.453-.558-1.059-.82-1.668-.791a.295.295 0 0 0-.227-.065c-1.4.11-2.637 1.679-1.909 3.157\\\" />\\n        <path fill=\\\"#FFF\\\" d=\\\"M83.12 55.648c.916-3.33 5.387-5.305 8.553-5.085 3.765.266 8.59 3.494 9.277 7.454.373 2.132-3.201 2.492-3.554.466-.782-4.47-8.893-6.614-10.702-2.003-.036.357-.226.713-.675 1.002-.022.023-.05.037-.07.05-1.412.921-3.292-.203-2.83-1.884\\\" />\\n        <path fill=\\\"#79ECEE\\\" d=\\\"M130.887 48.194c1.972 3.09 7.333 4.648 10.183 2.337 3.064-2.497 3.1-7.587.281-10.373-1.511-1.495-3.399-2.072-5.16-1.798a1.058 1.058 0 0 0-.718-.108c-4.064.775-7.221 5.81-4.586 9.942M127.85 77.94c1.733 2.724 6.45 4.093 8.956 2.058 2.697-2.199 2.723-6.673.244-9.122-1.327-1.316-2.985-1.825-4.536-1.582a.938.938 0 0 0-.63-.094c-3.578.679-6.353 5.109-4.034 8.74M123.467 106.767c1.607 2.793 6.26 4.374 8.854 2.454 2.796-2.074 3.021-6.54.654-9.102-1.267-1.375-2.901-1.949-4.46-1.781a.948.948 0 0 0-.627-.127c-3.603.52-6.573 4.823-4.42 8.556\\\" />\\n        <path fill=\\\"#D6FAFB\\\" d=\\\"M134.92 71.16l.384-.004c3.34-.056 4.832 2.564 4.435 4.87.819 3.035 6.732 4.083 9.188 4.55 3.327.638 6.204.138 7.935-1.695a5.354 5.354 0 0 0 .518-.67c.964-1.44 1.663-2.972 2.485-4.46.207-1.606.413-3.208.626-4.844 1.045.01 7.44.93 7.404 5.085-.061 7.397-4.113 11.963-9.873 13.901.007-.076.018-.156.03-.233a.106.106 0 0 0-.042.013l.012.22c-2.516.844-5.377 1.193-8.431 1.044-7.434-.364-19.518-4.398-19.253-13.56.07-2.467 2.191-4.176 4.582-4.217M155.979 103.575c.026.15-.358 3.097-.548 4.415-.379 2.903-.77 5.807-1.182 8.708-.04.298-.1.792-.173 1.41-.423.111-.846.232-1.267.325-9.933 2.216-23.748-2.264-26.83-12.978-1.387-4.823 5.737-6.845 8.28-3.535 3.25 3.006 6.375 4.279 10.726 4.987 2.315.378 9.589 1.174 10.133-1.001l.86-2.331z\\\" />\\n        <path fill=\\\"#D6FAFB\\\" d=\\\"M155.43 107.99c.19-1.318.575-4.264.549-4.415.141-1.139.343-2.691.587-4.57 1.43-.943 3.35-1.181 4.91-.156 4.028 2.644 5.269 6.247 3.534 10.833-1.791 4.722-6.312 7.18-10.936 8.425.075-.617.134-1.11.175-1.409.412-2.901.803-5.805 1.182-8.708\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M97.295 86.818c.143-.42-.082-.821-.543-.907l-15.969-2.926c-.445-.086-.826.224-.826.667 0 0-.792 8.124 7.2 9.59 7.994 1.46 10.138-6.424 10.138-6.424M106.717 66.413a2.628 2.628 0 0 0 2.9-2.325c.148-1.137.803-3.051 3.438-2.757 2.873.313 2.836 2.714 2.758 3.44a2.632 2.632 0 0 0 2.32 2.906 2.635 2.635 0 0 0 2.902-2.328c.367-3.341-1.301-8.563-7.404-9.24-6.1-.67-8.868 4.061-9.233 7.399a2.623 2.623 0 0 0 2.319 2.905M65.97 60.55a2.618 2.618 0 0 0 2.898-2.323c.154-1.135.809-3.045 3.444-2.756 2.873.32 2.836 2.715 2.758 3.446a2.628 2.628 0 0 0 2.324 2.898 2.633 2.633 0 0 0 2.896-2.326c.369-3.336-1.295-8.561-7.399-9.232-6.107-.682-8.87 4.055-9.24 7.395a2.62 2.62 0 0 0 2.319 2.898M7.328 107.186s-4.037-2.086 6.805-8.374c10.108-5.864 7.278 10.253 7.278 10.253l-14.083-1.88z\\\" />\\n        <path fill=\\\"#DFFCFC\\\" d=\\\"M77.122 128.065c-3.962-7.31-6.318-14.535-8.397-21.528-3.496-11.78-4.837-23.725-10.418-35.926-.384-.842-1.51-1.893-2.359-2.092a1247.17 1247.17 0 0 1-45.203-11.481C5.086 55.485.713 55.304.083 59.109c-.007.039-.016.076-.022.12-.14.995-.046 2.243.353 3.81.19.754.696 1.372 1.281 1.841C4.793 75.29 6.898 85.406 10.32 95.907c3.831 11.75 8.712 23.72 12.591 35.483.415 1.26 1.806 2.668 3.07 2.721.323.013.648.028.971.04 3.006 1.149 30.837 7.319 41.229 8.583 4.412.538 18.182 5.133 17.55-.856-.335-3.168-7.048-10.931-8.61-13.813\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M24.169 106.068c-4.748.862-9.072.078-13.23-2.376-3.782-2.232-6.633 3.978-2.878 6.194a24.375 24.375 0 0 0 16.752 2.983c4.29-.779 3.694-7.587-.644-6.801\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M26.43 113.925c-4.822.208-9-1.152-12.787-4.147-3.445-2.725-7.11 3.043-3.69 5.747a24.362 24.362 0 0 0 16.193 5.225c4.356-.19 4.689-7.017.284-6.825\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M27.7 121.497c-4.773-.725-8.608-2.867-11.746-6.535-2.856-3.338-7.566 1.615-4.73 4.929a24.372 24.372 0 0 0 14.88 8.249c4.313.653 5.952-5.982 1.595-6.643\\\" />\\n        <path fill=\\\"#D6FAFB\\\" d=\\\"M56.82 163.387c2.634 1.707 9.394 3.19 14.841 3.785 14.866 1.625 35.651.773 44.451-2.186 8.875-2.98 9.27-7.505-13.293-9.77-19.21-1.926-41.628.772-46.423 4.818-1.286 1.083-1.211 2.293.423 3.353\\\" />\\n        <path fill=\\\"#FFF\\\" d=\\\"M85.93 121.501l-8.872-2.495 5.144-7.99 53.966-19.197a4.453 4.453 0 0 1 5.686 2.7l.746 2.099a4.45 4.45 0 0 1-2.702 5.686L85.93 121.5z\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M154.388 66.712c-4.389-3.498-9.232 3.746-4.877 7.216 9.374 7.469 14.612 20.835 10.794 32.583-4.663 14.35-23.538 12.171-35.273 9.956-5.483-1.035-5.935 7.667-.492 8.695 16.003 3.021 38.184 2.835 44.015-15.867 4.9-15.715-1.61-32.577-14.167-42.583\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M117.57 120.966c-.858-.505-1.8-.82-2.724-.954.007-.692-.294-1.44-.896-2.045a5.36 5.36 0 0 0-1.042-.795c.604-.217 1.24-.4 1.767-.57 4.603-1.484-.888-7.006-5.49-5.523-4.248 1.372-8.193 3.504-7.248 7.418.244 1.01 1.247 2.234 2.773 2.788.09.031.177.056.268.09.235 1.784 2.018 3.698 4.6 4.72.32.126.656.225.99.326.556 1.45 2.692 2.89 4.895 2.99 5.026.234 8.746-1.607 9.6-4.766.4-1.491-1.568-3.332-3.883-3.906-1.418-.35-2.69-.218-3.61.227\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M116.74 108.083c-2.338-.522-12.208 2.855-5.111 5.063 1.627.505 1.248.814 2.754 1.558-.564.2-1.05.473-1.4.824-2.277.728-2.681 3.583-1.654 5.93 1.48 3.38 2.415 7.939 7.426 7.805 5.597-.148 12.373-6.007 12.023-9.417-.211-2.065-1.65-5.025-4.013-6.767-1.204-.887-7.684-4.475-10.024-4.996\\\" />\\n        <path fill=\\\"#0DCBCF\\\" d=\\\"M118.038 108.505s-11.852-4.477-13.846-1.858c-1.799 2.363-5.817 10.49-3.131 10.95 2.683.463 10.129-2.62 10.129-2.62l6.848-6.472z\\\" />\\n        <g transform=\\\"translate(134.244 38.595)\\\">\\n            <mask id=\\\"icon_note_empty_77efa79dd615f19897a8ed6ec9097298_b\\\" fill=\\\"#fff\\\">\\n                <use xlink:href=\\\"#icon_note_empty_77efa79dd615f19897a8ed6ec9097298_a\\\" />\\n            </mask>\\n            <path fill=\\\"#D6FAFB\\\" d=\\\"M9.325 7.036c.397 5.93 8.7 6.329 13.777 4.795.42-.158.845-.317 1.23-.505a9.225 9.225 0 0 0 1.389-.872c.082-.06.995-.824 1.133-.954 1.086-1.008 2.065-2.238 2.415-3.433.248-2.072.485-4.087.695-5.947a8.54 8.54 0 0 1 2.63 1.137C34 2.191 34.869 3.2 35.499 4.768c.088.213.125.438.17.665.332.608.553 1.271.557 1.963 1.55 5.622-2.602 9.814-8.58 11.908.032-.244.058-.477.09-.717-.01.004-.02.011-.029.015-.018.233-.03.458-.061.702C17.12 22.994.906 20.164.03 7.036c-.365-5.393 8.932-5.393 9.294 0\\\" mask=\\\"url(#icon_note_empty_77efa79dd615f19897a8ed6ec9097298_b)\\\" />\\n        </g>\\n        <path fill=\\\"#ACF5F7\\\" d=\\\"M67.018 83.907a4.967 4.967 0 1 1-9.935 0 4.966 4.966 0 0 1 4.967-4.967 4.967 4.967 0 0 1 4.968 4.967M73.57 105.824a4.967 4.967 0 1 1-9.935 0 4.966 4.966 0 0 1 4.966-4.966 4.967 4.967 0 0 1 4.969 4.966M80.564 124.544a4.967 4.967 0 0 1-4.968 4.966 4.966 4.966 0 0 1-4.967-4.966 4.967 4.967 0 1 1 9.935 0\\\" />\\n    </g>\\n</symbol>\"\n});\nvar result = sprite.add(symbol);\nexport default symbol","import React from 'react'\nimport {\n  Table,\n  TableHead,\n  TableBody,\n  TableRow,\n  TableHeader,\n  TableCell\n} from 'cozy-ui/react/Table'\nimport Spinner from 'cozy-ui/react/Spinner'\nimport useBreakpoints from 'cozy-ui/react/hooks/useBreakpoints'\n\nimport { translate } from 'cozy-ui/react/I18n'\nimport EmptyComponent from 'components/notes/List/EmptyComponent'\nimport NoteRow from 'components/notes/List/NoteRow'\n\nimport styles from 'components/notes/List/list.styl'\nconst EmptyTableRow = () => (\n  <TableRow className={styles.tableSpecialRow}>\n    <TableCell className={styles.tableCellEmpty}>\n      <EmptyComponent />\n    </TableCell>\n  </TableRow>\n)\n\nconst LoadingTableRow = () => (\n  <TableRow className={styles.tableSpecialRow}>\n    <TableCell className={`${styles.tableCellEmpty} u-ta-center`}>\n      <Spinner size=\"xxlarge\" />\n    </TableCell>\n  </TableRow>\n)\n\nconst List = ({ t, notes, fetchStatus }) => {\n  const { isMobile } = useBreakpoints()\n\n  return (\n    <Table>\n      <TableHead>\n        <TableRow>\n          <TableHeader className={styles.tableCellName}>\n            {t('Notes.List.name')}\n          </TableHeader>\n          {!isMobile && (\n            <>\n              <TableHeader className={styles.tableCell}>\n                {t('Notes.List.updated_at')}\n              </TableHeader>\n              <TableHeader className={styles.tableCell}>\n                {t('Notes.List.location')}\n              </TableHeader>\n              <TableHeader className={styles.tableCell}>\n                {t('Notes.List.sharings')}\n              </TableHeader>\n            </>\n          )}\n          <TableHeader className={styles.tableCell} />\n        </TableRow>\n      </TableHead>\n      <TableBody>\n        {fetchStatus === 'loading' ? (\n          <LoadingTableRow />\n        ) : notes.length === 0 ? (\n          <EmptyTableRow />\n        ) : (\n          notes.map(note => <NoteRow note={note} key={note._id} />)\n        )}\n      </TableBody>\n    </Table>\n  )\n}\n\nexport default translate()(List)\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"grid\":\"grid--1HNmF\",\"banner\":\"banner--MWCHK\",\"chip\":\"chip--3hU4-\"};"],"sourceRoot":""}